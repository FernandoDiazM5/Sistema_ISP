import{a as l,r as o,j as e,h as U,F as y,X as N,l as Y}from"./index-z5gwiLCk.js";import{P as H}from"./plus-DzCobvzz.js";import{C as X}from"./clock-Dh0pZaEI.js";import{C as J}from"./circle-alert-BQ7JPksQ.js";import{C as w}from"./circle-check-jQwUdo6Q.js";import{S as K}from"./search-rYpwXW4v.js";import{A as Q}from"./arrow-right-pZp-IT7F.js";import{P as V}from"./pencil-zMyhM5u9.js";const n={Pendiente:{bg:"bg-accent-yellow/20",text:"text-accent-yellow",dot:"bg-accent-yellow"},"En Revisión":{bg:"bg-accent-blue/20",text:"text-accent-blue",dot:"bg-accent-blue"},Aprobado:{bg:"bg-accent-green/20",text:"text-accent-green",dot:"bg-accent-green"},Rechazado:{bg:"bg-accent-red/20",text:"text-accent-red",dot:"bg-accent-red"},Completado:{bg:"bg-accent-purple/20",text:"text-accent-purple",dot:"bg-accent-purple"}},C={Urgente:"text-accent-red font-bold",Alta:"text-accent-red",Media:"text-accent-yellow",Baja:"text-accent-green"},W=["Operativo","Administrativo","Financiero","Legal","General"];function le(){const a=l(t=>t.requerimientos),R=l(t=>t.addRequerimiento),k=l(t=>t.updateRequerimiento),T=l(t=>t.deleteRequerimiento),h=l(t=>t.tiposRequerimiento),S=l(t=>t.addTipoRequerimiento),A=l(t=>t.updateTipoRequerimiento),E=l(t=>t.deleteTipoRequerimiento),[u,z]=o.useState(""),[p,P]=o.useState("all"),[g,q]=o.useState("all"),[L,c]=o.useState(!1),[r,i]=o.useState(null);o.useEffect(()=>{if(r){const t=a.find(s=>s.id===r.id);t&&t!==r&&i(t)}},[a,r]);const[$,f]=o.useState(!1),[d,x]=o.useState({nombre:"",categoria:"General"}),[m,j]=o.useState(null),b=o.useMemo(()=>({total:a.length,pendientes:a.filter(t=>t.estado==="Pendiente").length,enRevision:a.filter(t=>t.estado==="En Revisión").length,aprobados:a.filter(t=>t.estado==="Aprobado").length,completados:a.filter(t=>t.estado==="Completado").length}),[a]),v=o.useMemo(()=>a.filter(t=>{const s=u.toLowerCase(),O=!u||t.id.toLowerCase().includes(s)||t.titulo.toLowerCase().includes(s)||t.tipo.toLowerCase().includes(s)||t.solicitante&&t.solicitante.toLowerCase().includes(s),B=p==="all"||t.estado===p,_=g==="all"||t.tipo===g;return O&&B&&_}),[a,u,p,g]),F=t=>{t.preventDefault();const s=new FormData(t.target);R({titulo:s.get("titulo"),tipo:s.get("tipo"),prioridad:s.get("prioridad"),solicitante:s.get("solicitante"),descripcion:s.get("descripcion"),montoEstimado:parseFloat(s.get("montoEstimado"))||0,estado:"Pendiente",fechaLimite:s.get("fechaLimite")||null}),c(!1)},D=(t,s)=>{k(t,{estado:s,_historyComment:`Cambio de estado a ${s}`}),r&&r.id===t&&i({...r,estado:s})},G=t=>({Pendiente:["En Revisión","Rechazado"],"En Revisión":["Aprobado","Rechazado"],Aprobado:["Completado"]})[t]||[],M=()=>{d.nombre.trim()&&(m?A(m,d):S(d),x({nombre:"",categoria:"General"}),j(null))},I=t=>{x({nombre:t.nombre,categoria:t.categoria||"General"}),j(t.id)};return e.jsxs("div",{className:"animate-fade p-4 sm:p-6 sm:px-8 h-full overflow-y-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-[26px] font-bold tracking-tight",children:"Requerimientos Administrativos"}),e.jsx("p",{className:"text-text-secondary text-sm mt-1",children:"Gestión de compras, trámites y solicitudes internas"})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs("button",{onClick:()=>f(!0),className:"w-full sm:w-auto justify-center py-2.5 px-4 rounded-xl bg-bg-secondary border border-border text-text-secondary text-sm font-semibold cursor-pointer flex items-center gap-2 hover:border-accent-blue/50 transition-colors",children:[e.jsx(U,{size:16})," Tipos"]}),e.jsxs("button",{onClick:()=>c(!0),className:"w-full sm:w-auto justify-center py-2.5 px-4 rounded-xl bg-accent-blue border-none text-white text-sm font-semibold cursor-pointer flex items-center gap-2 hover:opacity-90 transition-opacity",children:[e.jsx(H,{size:16})," Nuevo Requerimiento"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3 mb-6",children:[{label:"Total",value:b.total,icon:y,color:"accent-blue"},{label:"Pendientes",value:b.pendientes,icon:X,color:"accent-yellow"},{label:"En Revisión",value:b.enRevision,icon:J,color:"accent-blue"},{label:"Aprobados",value:b.aprobados,icon:w,color:"accent-green"},{label:"Completados",value:b.completados,icon:w,color:"accent-purple"}].map(t=>{const s=t.icon;return e.jsxs("div",{className:"bg-bg-card rounded-xl p-4 border border-border flex items-center gap-3",children:[e.jsx("div",{className:`w-9 h-9 rounded-lg flex items-center justify-center bg-${t.color}/15 text-${t.color}`,children:e.jsx(s,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold font-mono",children:t.value}),e.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide",children:t.label})]})]},t.label)})}),e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"flex gap-2 flex-1",children:["all","Pendiente","En Revisión","Aprobado","Rechazado","Completado"].map(t=>e.jsx("button",{onClick:()=>P(t),className:`py-1.5 px-4 rounded-lg text-xs font-semibold border cursor-pointer transition-colors
                ${p===t?"bg-accent-blue/20 border-accent-blue text-accent-blue":"bg-bg-secondary border-border text-text-secondary hover:border-accent-blue/50"}`,children:t==="all"?"Todos":t},t))}),e.jsxs("select",{value:g,onChange:t=>q(t.target.value),className:"py-1.5 px-3 bg-bg-secondary border border-border rounded-lg text-xs text-text-primary outline-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"Todos los tipos"}),h.map(t=>e.jsx("option",{value:t.nombre,children:t.nombre},t.id))]}),e.jsxs("div",{className:"relative w-[220px]",children:[e.jsx(K,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted"}),e.jsx("input",{placeholder:"Buscar...",value:u,onChange:t=>z(t.target.value),className:"w-full pl-9 py-2 bg-bg-secondary border border-border rounded-lg text-xs text-text-primary outline-none focus:border-accent-blue placeholder:text-text-muted"})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[v.length===0&&e.jsx("div",{className:"bg-bg-card rounded-xl p-8 border border-border text-center",children:e.jsx("p",{className:"text-text-muted text-sm",children:"No se encontraron requerimientos"})}),v.map(t=>{const s=n[t.estado]||n.Pendiente;return e.jsxs("div",{onClick:()=>i(t),className:"bg-bg-card rounded-xl p-4 border border-border cursor-pointer transition-all hover:border-accent-blue/40 hover:bg-bg-card-hover",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center bg-accent-blue/15 text-accent-blue",children:e.jsx(y,{size:14})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-xs text-text-muted",children:t.id}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] font-bold ${s.bg} ${s.text}`,children:t.estado}),e.jsx("span",{className:`text-[11px] ${C[t.prioridad]||""}`,children:t.prioridad})]}),e.jsx("p",{className:"text-sm font-semibold mt-0.5",children:t.titulo})]})]}),e.jsx("span",{className:"text-[11px] text-text-muted",children:t.fecha})]}),e.jsxs("div",{className:"flex items-center gap-5 text-[11px] text-text-muted",children:[e.jsxs("span",{children:["Tipo: ",e.jsx("span",{className:"text-text-secondary font-medium",children:t.tipo})]}),t.solicitante&&e.jsxs("span",{children:["Solicitante: ",e.jsx("span",{className:"text-text-secondary",children:t.solicitante})]}),t.montoEstimado>0&&e.jsxs("span",{children:["Monto: ",e.jsxs("span",{className:"text-accent-green font-bold",children:["S/ ",t.montoEstimado.toFixed(2)]})]}),t.fechaLimite&&e.jsxs("span",{children:["Límite: ",e.jsx("span",{className:"text-text-secondary",children:t.fechaLimite})]})]})]},t.id)})]}),L&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>c(!1),children:e.jsxs("div",{className:"bg-bg-card rounded-2xl p-6 w-full max-w-[520px] border border-border max-h-[90vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-5",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Nuevo Requerimiento"}),e.jsx("button",{onClick:()=>c(!1),className:"w-8 h-8 rounded-lg flex items-center justify-center bg-bg-secondary border border-border text-text-muted cursor-pointer hover:text-text-primary transition-colors",children:e.jsx(N,{size:16})})]}),e.jsxs("form",{onSubmit:F,className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block font-medium",children:"Título"}),e.jsx("input",{name:"titulo",required:!0,placeholder:"Descripción breve del requerimiento",className:"w-full py-2.5 px-3 bg-bg-secondary border border-border rounded-lg text-sm text-text-primary outline-none focus:border-accent-blue placeholder:text-text-muted"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block font-medium",children:"Tipo"}),e.jsx("select",{name:"tipo",required:!0,className:"w-full py-2.5 px-3 bg-bg-secondary border border-border rounded-lg text-sm text-text-primary outline-none focus:border-accent-blue cursor-pointer",children:h.map(t=>e.jsx("option",{value:t.nombre,children:t.nombre},t.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block font-medium",children:"Prioridad"}),e.jsxs("select",{name:"prioridad",required:!0,className:"w-full py-2.5 px-3 bg-bg-secondary border border-border rounded-lg text-sm text-text-primary outline-none focus:border-accent-blue cursor-pointer",children:[e.jsx("option",{value:"Baja",children:"Baja"}),e.jsx("option",{value:"Media",children:"Media"}),e.jsx("option",{value:"Alta",children:"Alta"}),e.jsx("option",{value:"Urgente",children:"Urgente"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block font-medium",children:"Solicitante"}),e.jsx("input",{name:"solicitante",placeholder:"Nombre del solicitante",className:"w-full py-2.5 px-3 bg-bg-secondary border border-border rounded-lg text-sm text-text-primary outline-none focus:border-accent-blue placeholder:text-text-muted"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block font-medium",children:"Monto Estimado (S/)"}),e.jsx("input",{name:"montoEstimado",type:"number",step:"0.01",min:"0",placeholder:"0.00",className:"w-full py-2.5 px-3 bg-bg-secondary border border-border rounded-lg text-sm text-text-primary outline-none focus:border-accent-blue placeholder:text-text-muted"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block font-medium",children:"Fecha Límite"}),e.jsx("input",{name:"fechaLimite",type:"date",className:"w-full py-2.5 px-3 bg-bg-secondary border border-border rounded-lg text-sm text-text-primary outline-none focus:border-accent-blue"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block font-medium",children:"Descripción"}),e.jsx("textarea",{name:"descripcion",placeholder:"Detalle del requerimiento...",required:!0,className:"w-full bg-bg-secondary border border-border text-text-primary p-3 rounded-lg text-sm min-h-[80px] resize-y outline-none focus:border-accent-blue placeholder:text-text-muted"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"flex-1 py-2.5 rounded-lg bg-accent-blue border-none text-white text-sm font-semibold cursor-pointer hover:opacity-90 transition-opacity",children:"Crear Requerimiento"}),e.jsx("button",{type:"button",onClick:()=>c(!1),className:"py-2.5 px-4 rounded-lg bg-bg-secondary border border-border text-text-secondary text-sm cursor-pointer hover:bg-bg-secondary/80",children:"Cancelar"})]})]})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>i(null),children:e.jsxs("div",{className:"bg-bg-card rounded-2xl p-6 w-full max-w-[580px] border border-border max-h-[90vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-start mb-5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-sm text-text-muted",children:r.id}),e.jsx("h3",{className:"text-lg font-bold mt-1",children:r.titulo})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-lg text-xs font-bold ${n[r.estado]?.bg} ${n[r.estado]?.text}`,children:r.estado}),e.jsx("button",{onClick:()=>i(null),className:"w-8 h-8 rounded-lg flex items-center justify-center bg-bg-secondary border border-border text-text-muted cursor-pointer hover:text-text-primary transition-colors",children:e.jsx(N,{size:16})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Tipo"}),e.jsx("p",{className:"text-sm font-medium",children:r.tipo})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Prioridad"}),e.jsx("p",{className:`text-sm font-medium ${C[r.prioridad]||""}`,children:r.prioridad})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Solicitante"}),e.jsx("p",{className:"text-sm font-medium",children:r.solicitante||"No especificado"})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Fecha"}),e.jsx("p",{className:"text-sm font-medium",children:r.fecha})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Monto Estimado"}),e.jsx("p",{className:"text-sm font-bold text-accent-green",children:r.montoEstimado>0?`S/ ${r.montoEstimado.toFixed(2)}`:"---"})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Fecha Límite"}),e.jsx("p",{className:"text-sm font-medium",children:r.fechaLimite||"---"})]})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 mb-4",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-1",children:"Descripción"}),e.jsx("p",{className:"text-sm text-text-primary",children:r.descripcion||"Sin descripción"})]}),r.historial&&r.historial.length>0&&e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 mb-4",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-2 font-medium uppercase tracking-wide",children:"Historial"}),e.jsx("div",{className:"flex flex-col gap-2",children:r.historial.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[e.jsx("span",{className:"text-text-muted",children:new Date(t.fecha).toLocaleDateString()}),e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold ${n[t.estadoAnterior]?.bg||"bg-bg-card"} ${n[t.estadoAnterior]?.text||"text-text-muted"}`,children:t.estadoAnterior}),e.jsx(Q,{size:10,className:"text-text-muted"}),e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold ${n[t.estadoNuevo]?.bg||"bg-bg-card"} ${n[t.estadoNuevo]?.text||"text-text-muted"}`,children:t.estadoNuevo}),t.motivo&&e.jsxs("span",{className:"text-text-muted",children:["— ",t.motivo]})]},s))})]}),e.jsxs("div",{className:"flex gap-2",children:[G(r.estado).map(t=>{const s=n[t]||{};return e.jsx("button",{onClick:()=>D(r.id,t),className:`flex-1 py-2.5 rounded-lg border-none text-xs font-semibold cursor-pointer transition-opacity hover:opacity-80 ${s.bg||"bg-bg-secondary"} ${s.text||"text-text-secondary"}`,children:t==="Rechazado"?"Rechazar":`Pasar a ${t}`},t)}),(r.estado==="Completado"||r.estado==="Rechazado")&&e.jsx("button",{onClick:()=>{T(r.id),i(null)},className:"py-2.5 px-4 rounded-lg bg-accent-red/15 text-accent-red border-none text-xs font-semibold cursor-pointer hover:bg-accent-red/25 transition-colors",children:"Eliminar"}),e.jsx("button",{onClick:()=>i(null),className:"flex-1 py-2.5 rounded-lg bg-bg-secondary border border-border text-text-secondary text-xs cursor-pointer hover:bg-bg-secondary/80 transition-colors",children:"Cerrar"})]})]})}),$&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>f(!1),children:e.jsxs("div",{className:"bg-bg-card rounded-2xl p-6 w-full max-w-[550px] border border-border max-h-[90vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-5",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold",children:"Tipos de Requerimiento"}),e.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:"Gestiona los tipos disponibles para clasificar requerimientos"})]}),e.jsx("button",{onClick:()=>f(!1),className:"w-8 h-8 rounded-lg flex items-center justify-center bg-bg-secondary border border-border text-text-muted cursor-pointer hover:text-text-primary transition-colors",children:e.jsx(N,{size:16})})]}),e.jsx("div",{className:"flex flex-col gap-2 mb-5",children:h.map(t=>e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-[11px] text-text-muted",children:t.id}),e.jsx("span",{className:"text-sm font-semibold",children:t.nombre}),e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded font-bold bg-accent-blue/15 text-accent-blue",children:t.categoria||"General"})]})}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>I(t),className:"w-7 h-7 rounded flex items-center justify-center bg-accent-blue/15 text-accent-blue border-none cursor-pointer hover:bg-accent-blue/25 transition-colors",children:e.jsx(V,{size:12})}),e.jsx("button",{onClick:()=>E(t.id),className:"w-7 h-7 rounded flex items-center justify-center bg-accent-red/15 text-accent-red border-none cursor-pointer hover:bg-accent-red/25 transition-colors",children:e.jsx(Y,{size:12})})]})]},t.id))}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 border border-border",children:[e.jsx("p",{className:"text-xs font-semibold text-text-secondary mb-3",children:m?"Editar Tipo":"Agregar Tipo"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-text-muted block mb-1",children:"Nombre"}),e.jsx("input",{value:d.nombre,onChange:t=>x(s=>({...s,nombre:t.target.value})),placeholder:"Nombre del tipo",className:"w-full py-2 px-3 bg-bg-card border border-border rounded-lg text-xs text-text-primary outline-none focus:border-accent-blue placeholder:text-text-muted"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-text-muted block mb-1",children:"Categoría"}),e.jsx("select",{value:d.categoria,onChange:t=>x(s=>({...s,categoria:t.target.value})),className:"w-full py-2 px-3 bg-bg-card border border-border rounded-lg text-xs text-text-primary outline-none focus:border-accent-blue cursor-pointer",children:W.map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:M,disabled:!d.nombre.trim(),className:"flex-1 py-2 rounded-lg bg-accent-blue/20 text-accent-blue border-none text-xs font-semibold cursor-pointer hover:bg-accent-blue/30 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",children:m?"Guardar Cambios":"Agregar Tipo"}),m&&e.jsx("button",{onClick:()=>{x({nombre:"",categoria:"General"}),j(null)},className:"py-2 px-4 rounded-lg bg-bg-card border border-border text-text-muted text-xs cursor-pointer hover:text-text-primary",children:"Cancelar"})]})]})]})})]})}export{le as default};
