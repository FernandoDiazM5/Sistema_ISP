import{c as ke,a as d,r as o,j as e,h as Pe,S as g,X as f,W as se}from"./index-me4rMZUI.js";import{P as Re}from"./plus-CVOr2pzG.js";import{S as re}from"./search-K4IrGess.js";import{P as Te}from"./pencil--m7YkGTJ.js";import{T as Me}from"./trash-2-YFTQyT79.js";import{D as ze}from"./dollar-sign-BSq-0ptu.js";import{A as Fe}from"./arrow-up-down-CTDFBnqE.js";import{M as Ae}from"./map-pin-CvzHop5b.js";const Oe=[["path",{d:"m17 2-5 5-5-5",key:"16satq"}],["rect",{width:"20",height:"15",x:"2",y:"7",rx:"2",key:"1e6viu"}]],oe=ke("tv",Oe),k={Pendiente:{bg:"bg-accent-yellow/20",text:"text-accent-yellow",dot:"bg-accent-yellow"},Aprobada:{bg:"bg-accent-blue/20",text:"text-accent-blue",dot:"bg-accent-blue"},"En Ejecución":{bg:"bg-accent-purple/20",text:"text-accent-purple",dot:"bg-accent-purple"},Reprogramada:{bg:"bg-cyan-500/20",text:"text-cyan-400",dot:"bg-cyan-400"},Ejecutada:{bg:"bg-accent-green/20",text:"text-accent-green",dot:"bg-accent-green"},Rechazada:{bg:"bg-accent-red/20",text:"text-accent-red",dot:"bg-accent-red"}},De={"Punto Adicional CATV":e.jsx(oe,{size:14}),"Punto Adicional Red":e.jsx(se,{size:14}),"Traslado de Servicio":e.jsx(Ae,{size:14}),"Configuración IPTV":e.jsx(oe,{size:14}),"Repetidor WiFi":e.jsx(se,{size:14}),"Cambio de Plan":e.jsx(Fe,{size:14}),Reconexión:e.jsx(g,{size:14})},ae=[{key:"Todas",label:"Todas"},{key:"Punto CATV",label:"Punto CATV",match:"Punto Adicional CATV"},{key:"Config IPTV",label:"Config IPTV",match:"Configuración IPTV"},{key:"Repetidor WiFi",label:"Repetidor WiFi",match:"Repetidor WiFi"},{key:"Cambio Plan",label:"Cambio Plan",match:"Cambio de Plan"},{key:"Reubicación",label:"Reubicación",match:"Traslado de Servicio"}];function Be(){const m=d(t=>t.postVenta),ce=d(t=>t.addPostVenta),ne=d(t=>t.updatePostVenta),$=d(t=>t.clients),P=d(t=>t.tecnicos),h=d(t=>t.catalogoServicios),le=d(t=>t.addServicioCatalogo),ie=d(t=>t.updateServicioCatalogo),de=d(t=>t.deleteServicioCatalogo),[N,xe]=o.useState(""),[v,me]=o.useState("Todas"),[pe,L]=o.useState(!1),[s,R]=o.useState(null),[p,y]=o.useState(""),[l,C]=o.useState(null),[be,S]=o.useState(!1),[b,_]=o.useState(""),[T,G]=o.useState(""),[U,q]=o.useState(""),[W,B]=o.useState(""),[X,M]=o.useState(""),[z,Ie]=o.useState([]),[ue,F]=o.useState(!1),[a,n]=o.useState({nombre:"",tipo:"Presencial",precio:"",descripcion:"",costoManoObra:"",materiales:[]}),[j,A]=o.useState(null),[O,H]=o.useState(""),[J,K]=o.useState("unidad"),[D,Q]=o.useState(""),w=o.useMemo(()=>({total:m.length,pendientes:m.filter(t=>t.estado==="Pendiente").length,enEjecucion:m.filter(t=>t.estado==="En Ejecución").length,ejecutadas:m.filter(t=>t.estado==="Ejecutada").length}),[m]),Y=o.useMemo(()=>m.filter(t=>{const r=N.toLowerCase(),c=!N||t.clienteNombre.toLowerCase().includes(r)||t.id.toLowerCase().includes(r),x=ae.find(Ee=>Ee.key===v),u=v==="Todas"||t.tipoServicio===x?.match;return c&&u}),[m,N,v]),Z=o.useMemo(()=>{if(!p||p.length<2)return[];const t=p.toLowerCase();return $.filter(r=>r.nombre.toLowerCase().includes(t)||r.id.includes(t)).slice(0,8)},[$,p]),i=o.useMemo(()=>h.find(t=>t.id===b),[h,b]),ge=o.useMemo(()=>P.filter(t=>t.estado==="Activo"),[P]),ee=()=>{y(""),C(null),S(!1),_(""),G(""),q(""),B("")},he=()=>{ee(),L(!0)},E=()=>{L(!1),ee()},je=t=>{C(t),y(t.nombre),S(!1)},fe=t=>{if(t.preventDefault(),!l||!b)return;const r=h.find(x=>x.id===b);if(!r)return;const c=T?P.find(x=>x.id===T):null;ce({clienteId:l.id,clienteNombre:l.nombre,tipoServicio:r.nombre,estado:"Pendiente",tecnicoId:c?.id||null,tecnicoNombre:c?.nombre||null,descripcion:U,costoEstimado:r.precio,costoReal:null,fechaEjecucion:null,observaciones:W}),E()},Ne=t=>{R(t),M(t.costoReal!=null?String(t.costoReal):"")},I=()=>{R(null),M("")},V=t=>{if(!s)return;const r={estado:t,_historyComment:`Cambio de estado a ${t}`};if(t==="Ejecutada"){r.fechaEjecucion=new Date().toISOString().split("T")[0];const c=parseFloat(X);isNaN(c)?r.costoReal=s.costoEstimado:r.costoReal=c,z.length>0&&(r.materialesUsados=z,r.costoMateriales=z.reduce((x,u)=>x+u.cantidad*u.precioUnitario,0)),r._historyComment="Servicio ejecutado con registro de costos"}ne(s.id,r),R({...s,...r})},te=t=>({Pendiente:"Aprobada",Aprobada:"En Ejecución","En Ejecución":"Ejecutada",Reprogramada:"En Ejecución"})[t]||null,ve=t=>({Pendiente:"Aprobar Solicitud",Aprobada:"Iniciar Ejecución","En Ejecución":"Marcar Ejecutada",Reprogramada:"Retomar Ejecución"})[t]||null,ye=t=>({Pendiente:"bg-accent-blue/20 text-accent-blue",Aprobada:"bg-accent-purple/20 text-accent-purple","En Ejecución":"bg-accent-green/20 text-accent-green",Reprogramada:"bg-accent-purple/20 text-accent-purple"})[t]||"",Ce=()=>{!O||!D||(n(t=>({...t,materiales:[...t.materiales,{nombre:O,unidad:J,precioUnitario:parseFloat(D)||0}]})),H(""),K("unidad"),Q(""))},Se=()=>{const t={nombre:a.nombre,tipo:a.tipo,precio:parseFloat(a.precio)||0,descripcion:a.descripcion,costoManoObra:parseFloat(a.costoManoObra)||0,materiales:a.materiales};j?ie(j,t):le(t),n({nombre:"",tipo:"Presencial",precio:"",descripcion:"",costoManoObra:"",materiales:[]}),A(null)},we=t=>{n({nombre:t.nombre,tipo:t.tipo,precio:String(t.precio||0),descripcion:t.descripcion||"",costoManoObra:String(t.costoManoObra||0),materiales:t.materiales||[]}),A(t.id)};return e.jsxs("div",{className:"animate-fade p-6 px-8 h-full overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-[26px] font-bold tracking-tight",children:"Post-Venta"}),e.jsx("p",{className:"text-text-secondary text-sm mt-1",children:"Servicios adicionales para clientes existentes"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>F(!0),className:"py-2.5 px-4 rounded-xl bg-bg-secondary border border-border text-text-secondary text-sm font-semibold cursor-pointer flex items-center gap-2 hover:border-accent-purple/50 transition-colors",children:[e.jsx(Pe,{size:16})," Catálogo"]}),e.jsxs("button",{onClick:he,className:"py-2.5 px-4 rounded-xl bg-accent-purple border-none text-white text-sm font-semibold cursor-pointer flex items-center gap-2 hover:opacity-90 transition-opacity",children:[e.jsx(Re,{size:16})," Nueva Solicitud"]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3 mb-6",children:[e.jsxs("div",{className:"bg-bg-card rounded-xl p-4 border border-border flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-accent-blue/15 text-accent-blue",children:e.jsx(g,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold font-mono",children:w.total}),e.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide",children:"Total Solicitudes"})]})]}),e.jsxs("div",{className:"bg-bg-card rounded-xl p-4 border border-border flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-accent-yellow/15 text-accent-yellow",children:e.jsx(g,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold font-mono",children:w.pendientes}),e.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide",children:"Pendientes"})]})]}),e.jsxs("div",{className:"bg-bg-card rounded-xl p-4 border border-border flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-accent-purple/15 text-accent-purple",children:e.jsx(g,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold font-mono",children:w.enEjecucion}),e.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide",children:"En Ejecucion"})]})]}),e.jsxs("div",{className:"bg-bg-card rounded-xl p-4 border border-border flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-accent-green/15 text-accent-green",children:e.jsx(g,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold font-mono",children:w.ejecutadas}),e.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide",children:"Ejecutadas"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"flex gap-2 flex-1",children:ae.map(t=>e.jsx("button",{onClick:()=>me(t.key),className:`py-1.5 px-4 rounded-lg text-xs font-semibold border cursor-pointer transition-colors
                ${v===t.key?"bg-accent-purple/20 border-accent-purple text-accent-purple":"bg-bg-secondary border-border text-text-secondary hover:border-accent-purple/50"}`,children:t.label},t.key))}),e.jsxs("div",{className:"relative w-[260px]",children:[e.jsx(re,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted"}),e.jsx("input",{placeholder:"Buscar por cliente...",value:N,onChange:t=>xe(t.target.value),className:"w-full pl-9 py-2 bg-bg-secondary border border-border rounded-lg text-sm text-text-primary outline-none focus:border-accent-purple placeholder:text-text-muted"})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[Y.length===0&&e.jsx("div",{className:"bg-bg-card rounded-xl p-8 border border-border text-center",children:e.jsx("p",{className:"text-text-muted text-sm",children:"No se encontraron solicitudes"})}),Y.map(t=>{const r=k[t.estado]||k.Pendiente,c=De[t.tipoServicio]||e.jsx(g,{size:14});return e.jsxs("div",{onClick:()=>Ne(t),className:"bg-bg-card rounded-xl p-4 border border-border cursor-pointer transition-all hover:border-accent-purple/40 hover:bg-bg-card-hover",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center bg-accent-purple/15 text-accent-purple",children:c}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-xs text-text-muted",children:t.id}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] font-bold ${r.bg} ${r.text}`,children:t.estado})]}),e.jsx("p",{className:"text-sm font-semibold mt-0.5",children:t.clienteNombre})]})]}),e.jsx("span",{className:"text-[11px] text-text-muted",children:t.fecha})]}),e.jsx("p",{className:"text-xs text-text-secondary mb-2 line-clamp-1",children:t.descripcion}),e.jsxs("div",{className:"flex items-center gap-5 text-[11px] text-text-muted",children:[e.jsxs("span",{children:["Servicio: ",e.jsx("span",{className:"text-text-secondary font-medium",children:t.tipoServicio})]}),e.jsxs("span",{children:["Costo: ",e.jsx("span",{className:"text-accent-green font-bold",children:t.costoEstimado>0?`S/ ${t.costoEstimado.toFixed(2)}`:"Gratis"})]}),t.tecnicoNombre&&e.jsxs("span",{children:["Tecnico: ",e.jsx("span",{className:"text-text-secondary",children:t.tecnicoNombre})]})]})]},t.id)})]}),pe&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:E,children:e.jsxs("div",{className:"bg-bg-card rounded-2xl p-6 w-[540px] border border-border max-h-[90vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-5",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Nueva Solicitud Post-Venta"}),e.jsx("button",{onClick:E,className:"w-8 h-8 rounded-lg flex items-center justify-center bg-bg-secondary border border-border text-text-muted cursor-pointer hover:text-text-primary transition-colors",children:e.jsx(f,{size:16})})]}),e.jsxs("form",{onSubmit:fe,className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block font-medium",children:"Cliente"}),e.jsxs("div",{className:"relative",children:[e.jsx(re,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted"}),e.jsx("input",{type:"text",placeholder:"Buscar cliente por nombre o ID...",value:p,onChange:t=>{y(t.target.value),S(!0),t.target.value||C(null)},onFocus:()=>{p.length>=2&&S(!0)},className:"w-full pl-9 py-2.5 bg-bg-secondary border border-border rounded-lg text-sm text-text-primary outline-none focus:border-accent-purple placeholder:text-text-muted"}),l&&e.jsx("button",{type:"button",onClick:()=>{C(null),y("")},className:"absolute right-2 top-1/2 -translate-y-1/2 w-5 h-5 rounded flex items-center justify-center bg-bg-secondary text-text-muted cursor-pointer border-none hover:text-text-primary",children:e.jsx(f,{size:12})}),be&&Z.length>0&&!l&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-bg-card border border-border rounded-lg shadow-xl z-10 max-h-[200px] overflow-y-auto",children:Z.map(t=>e.jsxs("button",{type:"button",onClick:()=>je(t),className:"w-full text-left px-3 py-2.5 text-sm hover:bg-bg-secondary cursor-pointer border-none bg-transparent text-text-primary transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-[11px] text-text-muted",children:t.id}),e.jsx("span",{className:"truncate",children:t.nombre})]},t.id))})]}),l&&e.jsxs("p",{className:"text-[11px] text-accent-green mt-1",children:["Seleccionado: ",l.id," - ",l.nombre]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block font-medium",children:"Tipo de Servicio"}),e.jsxs("select",{value:b,onChange:t=>_(t.target.value),required:!0,className:"w-full py-2.5 px-3 bg-bg-secondary border border-border rounded-lg text-sm text-text-primary outline-none focus:border-accent-purple cursor-pointer",children:[e.jsx("option",{value:"",children:"Seleccionar servicio..."}),h.map(t=>e.jsxs("option",{value:t.id,children:[t.nombre," ",t.precio>0?`- S/ ${t.precio.toFixed(2)}`:"- Gratis"," (",t.tipo,")"]},t.id))]})]}),i&&e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-text-muted",children:"Precio del servicio"}),e.jsx("p",{className:"text-sm font-bold text-accent-green mt-0.5",children:i.precio>0?`S/ ${i.precio.toFixed(2)}`:"Gratis"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-text-muted",children:"Tipo de atencion"}),e.jsx("p",{className:`text-xs font-semibold mt-0.5 ${i.tipo==="Presencial"?"text-accent-purple":"text-accent-blue"}`,children:i.tipo})]})]}),e.jsx("p",{className:"text-[11px] text-text-muted mt-2",children:i.descripcion})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-text-muted mb-1.5 block font-medium",children:["Tecnico Asignado",i?.tipo==="Presencial"&&e.jsx("span",{className:"text-accent-red ml-1",children:"*"}),i?.tipo==="Remoto"&&e.jsx("span",{className:"text-text-muted ml-1",children:"(opcional)"})]}),e.jsxs("select",{value:T,onChange:t=>G(t.target.value),required:i?.tipo==="Presencial",className:"w-full py-2.5 px-3 bg-bg-secondary border border-border rounded-lg text-sm text-text-primary outline-none focus:border-accent-purple cursor-pointer",children:[e.jsx("option",{value:"",children:"Seleccionar tecnico..."}),ge.map(t=>e.jsxs("option",{value:t.id,children:[t.nombre," - ",t.especialidad," (",t.zona,")"]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block font-medium",children:"Descripcion"}),e.jsx("textarea",{value:U,onChange:t=>q(t.target.value),placeholder:"Describa el servicio solicitado...",required:!0,className:"w-full bg-bg-secondary border border-border text-text-primary p-3 rounded-lg text-sm min-h-[80px] resize-y outline-none focus:border-accent-purple placeholder:text-text-muted"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block font-medium",children:"Observaciones"}),e.jsx("textarea",{value:W,onChange:t=>B(t.target.value),placeholder:"Observaciones adicionales (opcional)...",className:"w-full bg-bg-secondary border border-border text-text-primary p-3 rounded-lg text-sm min-h-[60px] resize-y outline-none focus:border-accent-purple placeholder:text-text-muted"})]}),e.jsxs("div",{className:"flex gap-3 mt-1",children:[e.jsx("button",{type:"button",onClick:E,className:"flex-1 py-2.5 rounded-lg bg-bg-secondary border border-border text-text-secondary cursor-pointer text-sm hover:bg-bg-secondary/80 transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:!l||!b,className:"flex-1 py-2.5 rounded-lg bg-accent-purple border-none text-white cursor-pointer text-sm font-semibold hover:opacity-90 transition-opacity disabled:opacity-40 disabled:cursor-not-allowed",children:"Crear Solicitud"})]})]})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:I,children:e.jsxs("div",{className:"bg-bg-card rounded-2xl p-6 w-[580px] border border-border max-h-[90vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-start mb-5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-sm text-text-muted",children:s.id}),e.jsx("h3",{className:"text-lg font-bold mt-1",children:s.clienteNombre})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-lg text-xs font-bold ${k[s.estado]?.bg} ${k[s.estado]?.text}`,children:s.estado}),e.jsx("button",{onClick:I,className:"w-8 h-8 rounded-lg flex items-center justify-center bg-bg-secondary border border-border text-text-muted cursor-pointer hover:text-text-primary transition-colors",children:e.jsx(f,{size:16})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Tipo de Servicio"}),e.jsx("p",{className:"text-sm font-medium",children:s.tipoServicio})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Cliente ID"}),e.jsx("p",{className:"text-sm font-medium font-mono",children:s.clienteId})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Fecha Solicitud"}),e.jsx("p",{className:"text-sm font-medium",children:s.fecha})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Fecha Ejecucion"}),e.jsx("p",{className:"text-sm font-medium",children:s.fechaEjecucion||"---"})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Tecnico Asignado"}),e.jsx("p",{className:"text-sm font-medium",children:s.tecnicoNombre||"Sin asignar"})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Tecnico ID"}),e.jsx("p",{className:"text-sm font-medium font-mono",children:s.tecnicoId||"---"})]})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 mb-4",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-1",children:"Descripcion"}),e.jsx("p",{className:"text-sm text-text-primary",children:s.descripcion||"Sin descripcion"})]}),s.observaciones&&e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 mb-4",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-1",children:"Observaciones"}),e.jsx("p",{className:"text-sm text-text-primary",children:s.observaciones})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 mb-5 border border-border",children:[e.jsx("p",{className:"text-xs text-text-muted mb-3 font-medium uppercase tracking-wide",children:"Comparacion de Costos"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Costo Estimado"}),e.jsx("p",{className:"text-xl font-bold font-mono text-accent-blue",children:s.costoEstimado>0?`S/ ${s.costoEstimado.toFixed(2)}`:"Gratis"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-0.5",children:"Costo Real"}),s.costoReal!=null?e.jsxs("p",{className:`text-xl font-bold font-mono ${s.costoReal>s.costoEstimado?"text-accent-red":"text-accent-green"}`,children:["S/ ",s.costoReal.toFixed(2)]}):e.jsx("p",{className:"text-xl font-bold font-mono text-text-muted",children:"---"})]})]}),s.costoReal!=null&&s.costoEstimado>0&&e.jsx("div",{className:"mt-2 pt-2 border-t border-border",children:e.jsxs("p",{className:"text-[11px] text-text-muted",children:["Diferencia:"," ",e.jsxs("span",{className:`font-bold ${s.costoReal-s.costoEstimado>0?"text-accent-red":s.costoReal-s.costoEstimado<0?"text-accent-green":"text-text-secondary"}`,children:[s.costoReal-s.costoEstimado>0?"+":"","S/ ",(s.costoReal-s.costoEstimado).toFixed(2)]})]})})]}),s.estado==="En Ejecución"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block font-medium",children:"Costo Real (S/) - se registra al marcar Ejecutada"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:X,onChange:t=>M(t.target.value),placeholder:`Estimado: ${s.costoEstimado}`,className:"w-full py-2.5 px-3 bg-bg-secondary border border-border rounded-lg text-sm text-text-primary outline-none focus:border-accent-purple placeholder:text-text-muted"})]}),e.jsxs("div",{className:"flex gap-2",children:[te(s.estado)&&e.jsx("button",{onClick:()=>V(te(s.estado)),className:`flex-1 py-2.5 rounded-lg border-none text-xs font-semibold cursor-pointer transition-opacity hover:opacity-80 ${ye(s.estado)}`,children:ve(s.estado)}),s.estado==="Pendiente"&&e.jsx("button",{onClick:()=>V("Rechazada"),className:"flex-1 py-2.5 rounded-lg bg-accent-red/20 text-accent-red border-none text-xs font-semibold cursor-pointer transition-opacity hover:opacity-80",children:"Rechazar"}),s.estado==="En Ejecución"&&e.jsx("button",{onClick:()=>V("Reprogramada"),className:"py-2.5 px-4 rounded-lg bg-cyan-500/20 text-cyan-400 border-none text-xs font-semibold cursor-pointer hover:bg-cyan-500/30 transition-colors",children:"Reprogramar"}),e.jsx("button",{onClick:I,className:"flex-1 py-2.5 rounded-lg bg-bg-secondary border border-border text-text-secondary text-xs cursor-pointer hover:bg-bg-secondary/80 transition-colors",children:"Cerrar"})]})]})}),ue&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>F(!1),children:e.jsxs("div",{className:"bg-bg-card rounded-2xl p-6 w-[700px] border border-border max-h-[90vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-5",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold",children:"Catálogo de Servicios"}),e.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:"Gestiona los servicios post-venta disponibles"})]}),e.jsx("button",{onClick:()=>F(!1),className:"w-8 h-8 rounded-lg flex items-center justify-center bg-bg-secondary border border-border text-text-muted cursor-pointer hover:text-text-primary transition-colors",children:e.jsx(f,{size:16})})]}),e.jsx("div",{className:"flex flex-col gap-2 mb-5",children:h.map(t=>e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-[11px] text-text-muted",children:t.id}),e.jsx("span",{className:"text-sm font-semibold",children:t.nombre}),e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded font-bold ${t.tipo==="Presencial"?"bg-accent-purple/20 text-accent-purple":"bg-accent-blue/20 text-accent-blue"}`,children:t.tipo})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("span",{className:"text-xs text-accent-green font-bold",children:t.precio>0?`S/ ${t.precio.toFixed(2)}`:"Gratis"}),t.costoManoObra>0&&e.jsxs("span",{className:"text-[10px] text-text-muted",children:["Mano de obra: S/ ",t.costoManoObra.toFixed(2)]}),t.materiales&&t.materiales.length>0&&e.jsxs("span",{className:"text-[10px] text-text-muted",children:[t.materiales.length," material(es)"]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>we(t),className:"w-7 h-7 rounded flex items-center justify-center bg-accent-blue/15 text-accent-blue border-none cursor-pointer hover:bg-accent-blue/25 transition-colors",children:e.jsx(Te,{size:12})}),e.jsx("button",{onClick:()=>de(t.id),className:"w-7 h-7 rounded flex items-center justify-center bg-accent-red/15 text-accent-red border-none cursor-pointer hover:bg-accent-red/25 transition-colors",children:e.jsx(Me,{size:12})})]})]},t.id))}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 border border-border",children:[e.jsx("p",{className:"text-xs font-semibold text-text-secondary mb-3",children:j?"Editar Servicio":"Agregar Servicio"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-text-muted block mb-1",children:"Nombre"}),e.jsx("input",{value:a.nombre,onChange:t=>n(r=>({...r,nombre:t.target.value})),placeholder:"Nombre del servicio",className:"w-full py-2 px-3 bg-bg-card border border-border rounded-lg text-xs text-text-primary outline-none focus:border-accent-purple placeholder:text-text-muted"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-text-muted block mb-1",children:"Tipo"}),e.jsxs("select",{value:a.tipo,onChange:t=>n(r=>({...r,tipo:t.target.value})),className:"w-full py-2 px-3 bg-bg-card border border-border rounded-lg text-xs text-text-primary outline-none focus:border-accent-purple cursor-pointer",children:[e.jsx("option",{value:"Presencial",children:"Presencial"}),e.jsx("option",{value:"Remoto",children:"Remoto"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-text-muted block mb-1",children:"Precio Total (S/)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:a.precio,onChange:t=>n(r=>({...r,precio:t.target.value})),placeholder:"0.00",className:"w-full py-2 px-3 bg-bg-card border border-border rounded-lg text-xs text-text-primary outline-none focus:border-accent-purple placeholder:text-text-muted"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-text-muted block mb-1",children:"Costo Mano de Obra (S/)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:a.costoManoObra,onChange:t=>n(r=>({...r,costoManoObra:t.target.value})),placeholder:"0.00",className:"w-full py-2 px-3 bg-bg-card border border-border rounded-lg text-xs text-text-primary outline-none focus:border-accent-purple placeholder:text-text-muted"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"text-[10px] text-text-muted block mb-1",children:"Descripción"}),e.jsx("input",{value:a.descripcion,onChange:t=>n(r=>({...r,descripcion:t.target.value})),placeholder:"Descripción del servicio",className:"w-full py-2 px-3 bg-bg-card border border-border rounded-lg text-xs text-text-primary outline-none focus:border-accent-purple placeholder:text-text-muted"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-[10px] text-text-muted mb-1.5 flex items-center gap-1",children:[e.jsx(ze,{size:10})," Materiales del servicio"]}),a.materiales.length>0&&e.jsx("div",{className:"flex flex-col gap-1 mb-2",children:a.materiales.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between bg-bg-card rounded px-2 py-1.5 text-[11px]",children:[e.jsxs("span",{children:[t.nombre," (",t.unidad,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-accent-green font-bold",children:["S/ ",t.precioUnitario.toFixed(2)]}),e.jsx("button",{onClick:()=>n(c=>({...c,materiales:c.materiales.filter((x,u)=>u!==r)})),className:"text-accent-red cursor-pointer border-none bg-transparent hover:opacity-70",children:e.jsx(f,{size:10})})]})]},r))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:O,onChange:t=>H(t.target.value),placeholder:"Material",className:"flex-1 py-1.5 px-2 bg-bg-card border border-border rounded text-[11px] text-text-primary outline-none focus:border-accent-purple placeholder:text-text-muted"}),e.jsxs("select",{value:J,onChange:t=>K(t.target.value),className:"py-1.5 px-2 bg-bg-card border border-border rounded text-[11px] text-text-primary outline-none cursor-pointer",children:[e.jsx("option",{value:"unidad",children:"unidad"}),e.jsx("option",{value:"metro",children:"metro"}),e.jsx("option",{value:"rollo",children:"rollo"}),e.jsx("option",{value:"pieza",children:"pieza"})]}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:D,onChange:t=>Q(t.target.value),placeholder:"S/",className:"w-20 py-1.5 px-2 bg-bg-card border border-border rounded text-[11px] text-text-primary outline-none focus:border-accent-purple placeholder:text-text-muted"}),e.jsx("button",{type:"button",onClick:Ce,className:"py-1.5 px-3 rounded bg-accent-green/20 text-accent-green border-none text-[11px] font-semibold cursor-pointer hover:bg-accent-green/30 transition-colors",children:"+"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Se,disabled:!a.nombre,className:"flex-1 py-2 rounded-lg bg-accent-purple/20 text-accent-purple border-none text-xs font-semibold cursor-pointer hover:bg-accent-purple/30 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",children:j?"Guardar Cambios":"Agregar Servicio"}),j&&e.jsx("button",{onClick:()=>{n({nombre:"",tipo:"Presencial",precio:"",descripcion:"",costoManoObra:"",materiales:[]}),A(null)},className:"py-2 px-4 rounded-lg bg-bg-card border border-border text-text-muted text-xs cursor-pointer hover:text-text-primary",children:"Cancelar"})]})]})]})})]})}export{Be as default};
