import{c as k,a as m,r as o,j as e,M as U,X as Y,U as Ne}from"./index-Bp4pvzRI.js";import{K as $}from"./KPICard-CzbHO9ou.js";import{P as ye}from"./phone-DPjwLBgO.js";import{S as Z}from"./search-Bb9dCE3k.js";import{P as Ce}from"./plus-LMF8qI6h.js";import{P as we}from"./pen-line-B1qQj0Px.js";import{T as Se}from"./trash-2-DznFGFD5.js";import{S as ke}from"./sparkles-wm13jXV8.js";import{C as _e}from"./chevron-right-BWmDYoO8.js";const Te=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Q=k("copy",Te);const ze=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Me=k("play",ze);const Pe=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],S=k("send",Pe);const Ae=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Ee=k("square",Ae);const Ie=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],R=k("star",Ie),$e={formal:{label:"Formal",emoji:"ðŸ‘”",desc:"Tono profesional y corporativo"},amigable:{label:"Amigable",emoji:"ðŸ˜Š",desc:"Tono cercano y cÃ¡lido"},urgente:{label:"Urgente",emoji:"âš¡",desc:"Tono directo y con sentido de urgencia"},persuasivo:{label:"Persuasivo",emoji:"ðŸŽ¯",desc:"Tono convincente para cobranza"}};async function Le(i,a,j=""){throw i?new Error("API Key de Gemini no configurada. Por favor configÃºrala en las variables de entorno."):new Error("No hay texto para reescribir")}function L(i,a){const j=new Date,v=j.getHours(),D=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],_=v>=19||v<5?"Buenas noches":v>=12?"Buenas tardes":"Buenos dÃ­as";let u=i.replace(/{Saludo}/g,_).replace(/{Mes}/g,D[j.getMonth()]).replace(/{Anio}/g,String(j.getFullYear()));if(!a)return u.replace(/{Nombre}/g,"").replace(/{([^{}]+)}/g,"");const b=(a.nombre||"").toLowerCase().replace(/\b\w/g,h=>h.toUpperCase());u=u.replace(/{Nombre}/g,b);const T={precio:a.precio?`S/. ${a.precio.toFixed(2)}`:"",plan:a.plan||"",deuda_monto:a.deuda_monto?`S/. ${a.deuda_monto.toFixed(2)}`:"S/. 0.00",deuda_meses:a.deuda_meses||"0",direccion:a.direccion||"",proximo_pago:a.proximo_pago||"",zona:a.zona||"",movil_1:a.movil_1||"",estado_cuenta:a.estado_cuenta||"",tecnologia:a.tecnologia||"",ip:a.ip||""};return u.replace(/{([^{}]+)}/g,(h,p)=>{const C=p.toLowerCase().replace(/\s+/g,"_");return T[C]!==void 0?T[C]:a[p]||h})}const ee=["Todas","Cobranza","General","Soporte","PromociÃ³n"],De=[{key:"{Saludo}",desc:"Buenos dÃ­as/tardes/noches"},{key:"{Nombre}",desc:"Nombre del cliente"},{key:"{precio}",desc:"Precio del plan"},{key:"{plan}",desc:"Plan contratado"},{key:"{deuda_monto}",desc:"Monto de deuda"},{key:"{deuda_meses}",desc:"Meses de deuda"},{key:"{direccion}",desc:"DirecciÃ³n del cliente"},{key:"{proximo_pago}",desc:"Fecha prÃ³ximo pago"},{key:"{zona}",desc:"Zona del cliente"},{key:"{Mes}",desc:"Mes actual"},{key:"{Anio}",desc:"AÃ±o actual"}];function qe(){const i=m(t=>t.clients),a=m(t=>t.templates),j=m(t=>t.addTemplate),v=m(t=>t.updateTemplate),D=m(t=>t.deleteTemplate),_=m(t=>t.incrementTemplateUse),u=m(t=>t.addWhatsappLog),b=m(t=>t.whatsappLogs),T=m(t=>t.campaignActive),h=m(t=>t.setCampaign),[p,C]=o.useState("plantillas"),[z,te]=o.useState(""),[M,se]=o.useState("Todas"),[ae,N]=o.useState(!1),[P,B]=o.useState(null),[d,g]=o.useState({titulo:"",categoria:"Cobranza",mensaje:"",favorito:!1}),[r,V]=o.useState(null),[y,oe]=o.useState(null),[x,A]=o.useState(""),[E,W]=o.useState(""),[F,re]=o.useState(""),[G,H]=o.useState(!1),[n,q]=o.useState([]),[f,le]=o.useState(null),[l,O]=o.useState(0),[w,ne]=o.useState("all"),K=o.useMemo(()=>{let t=[...a];if(M!=="Todas"&&(t=t.filter(s=>s.categoria===M)),z){const s=z.toLowerCase();t=t.filter(c=>c.titulo.toLowerCase().includes(s)||c.mensaje.toLowerCase().includes(s))}return t.sort((s,c)=>s.favorito!==c.favorito?s.favorito?-1:1:(c.uso||0)-(s.uso||0)),t},[a,M,z]),J=o.useMemo(()=>{if(!E)return[];const t=E.toLowerCase();return i.filter(s=>s.nombre.toLowerCase().includes(t)||s.movil_1?.includes(t)||s.id.includes(t)).slice(0,10)},[i,E]),I=o.useMemo(()=>({totalTemplates:a.length,totalSent:b.length,todaySent:b.filter(t=>new Date(t.fecha).toDateString()===new Date().toDateString()).length,favorites:a.filter(t=>t.favorito).length}),[a,b]),ce=()=>{B(null),g({titulo:"",categoria:"Cobranza",mensaje:"",favorito:!1}),N(!0)},ie=t=>{B(t),g({titulo:t.titulo,categoria:t.categoria,mensaje:t.mensaje,favorito:t.favorito}),N(!0)},de=()=>{!d.titulo||!d.mensaje||(P?v(P.id,d):j(d),N(!1))},xe=t=>{confirm("Â¿Eliminar esta plantilla?")&&D(t)},X=t=>{oe(t),A(L(t.mensaje,r))},me=t=>{V(t),W(""),y&&A(L(y.mensaje,t))},be=()=>{const t=r?.movil_1||F;if(!t)return;const s=t.replace(/\D/g,""),c=`https://wa.me/51${s}?text=${encodeURIComponent(x)}`;window.open(c,"_blank"),y&&_(y.id),u({clienteId:r?.id||"manual",clienteNombre:r?.nombre||`Manual (${s})`,plantilla:y?.titulo||"Manual",mensaje:x,telefono:s})},pe=async t=>{if(x){H(!0);try{const s=r?`Cliente: ${r.nombre}, Deuda: S/. ${r.deuda_monto||0}, Estado: ${r.estado_cuenta}`:"",c=await Le(x,t,s);A(c)}catch(s){alert("Error IA: "+s.message)}H(!1)}},ue=()=>{let t=[...i];if(w==="deudores"?t=t.filter(s=>s.deuda_monto>0):w==="cortados"?t=t.filter(s=>s.estado_servicio==="Cortado"||s.estado_cuenta==="SUSPENDIDO"):w==="activos"&&(t=t.filter(s=>s.status==="ONLINE"||s.estado_cuenta==="ACTIVO")),t=t.filter(s=>s.movil_1),t.length===0)return alert("No hay clientes con nÃºmero de telÃ©fono para esta selecciÃ³n");q(t),O(0),h({campaignActive:!0})},he=()=>{const t=n[l];if(!t||!f)return;const s=L(f.mensaje,t),c=t.movil_1.replace(/\D/g,""),ve=`https://wa.me/51${c}?text=${encodeURIComponent(s)}`;window.open(ve,"_blank"),_(f.id),u({clienteId:t.id,clienteNombre:t.nombre,plantilla:f.titulo,mensaje:s,telefono:c}),l+1<n.length?O(l+1):(h({campaignActive:!1}),alert("CampaÃ±a finalizada"))},ge=()=>{h({campaignActive:!1}),q([]),O(0)},fe=t=>{g(s=>({...s,mensaje:s.mensaje+t}))},je=[{id:"plantillas",label:"Plantillas",icon:e.jsx(U,{size:16})},{id:"enviar",label:"Enviar Mensaje",icon:e.jsx(S,{size:16})},{id:"campana",label:"CampaÃ±a",icon:e.jsx(Ne,{size:16})},{id:"historial",label:"Historial",icon:e.jsx(Q,{size:16})}];return e.jsxs("div",{className:"animate-fade p-6 px-8 h-full overflow-y-auto",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-[26px] font-bold tracking-tight",children:"WhatsApp & Plantillas"}),e.jsx("p",{className:"text-text-secondary text-sm mt-1",children:"MensajerÃ­a masiva, plantillas y campaÃ±as"})]})}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsx($,{title:"Plantillas",value:I.totalTemplates,icon:e.jsx(U,{size:20}),color:"#3b82f6"}),e.jsx($,{title:"Mensajes Enviados",value:I.totalSent,icon:e.jsx(S,{size:20}),color:"#10b981"}),e.jsx($,{title:"Enviados Hoy",value:I.todaySent,icon:e.jsx(ye,{size:20}),color:"#8b5cf6"}),e.jsx($,{title:"Favoritas",value:I.favorites,icon:e.jsx(R,{size:20}),color:"#f59e0b"})]}),e.jsx("div",{className:"flex gap-1 mb-6 bg-bg-secondary p-1 rounded-xl w-fit",children:je.map(t=>e.jsxs("button",{onClick:()=>C(t.id),className:`flex items-center gap-1.5 py-2 px-4 rounded-lg text-xs font-semibold cursor-pointer border-none transition-all
              ${p===t.id?"bg-bg-card text-text-primary shadow-sm":"bg-transparent text-text-muted hover:text-text-secondary"}`,children:[t.icon," ",t.label]},t.id))}),p==="plantillas"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Z,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted"}),e.jsx("input",{value:z,onChange:t=>te(t.target.value),placeholder:"Buscar plantillas...",className:"w-full pl-9 pr-4 py-2.5 rounded-xl bg-bg-secondary border border-border text-sm"})]}),e.jsx("div",{className:"flex gap-1",children:ee.map(t=>e.jsx("button",{onClick:()=>se(t),className:`py-1.5 px-3 rounded-lg text-[11px] font-semibold cursor-pointer border-none transition-all
                    ${M===t?"bg-accent-blue text-white":"bg-bg-secondary text-text-muted hover:text-text-secondary"}`,children:t},t))}),e.jsxs("button",{onClick:ce,className:"py-2 px-4 rounded-lg bg-accent-green border-none text-white text-xs font-semibold cursor-pointer flex items-center gap-1.5",children:[e.jsx(Ce,{size:14})," Nueva"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[K.map(t=>e.jsxs("div",{className:"bg-bg-card rounded-2xl border border-border p-4 flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-semibold truncate",children:t.titulo}),e.jsx("span",{className:"text-[10px] text-text-muted bg-bg-secondary py-0.5 px-2 rounded mt-1 inline-block",children:t.categoria})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[t.favorito&&e.jsx(R,{size:14,className:"text-accent-yellow fill-accent-yellow"}),e.jsxs("span",{className:"text-[10px] text-text-muted font-mono",children:[t.uso||0,"x"]})]})]}),e.jsx("p",{className:"text-[12px] text-text-secondary flex-1 mb-3 line-clamp-3",children:t.mensaje}),e.jsxs("div",{className:"flex gap-1 pt-2 border-t border-border",children:[e.jsxs("button",{onClick:()=>{C("enviar"),X(t)},className:"flex-1 py-1.5 rounded-lg bg-accent-green/10 text-accent-green text-[11px] font-semibold cursor-pointer border-none",children:[e.jsx(S,{size:12,className:"inline mr-1"})," Usar"]}),e.jsx("button",{onClick:()=>ie(t),className:"p-1.5 rounded-lg bg-bg-secondary text-text-muted cursor-pointer border-none hover:text-accent-blue",children:e.jsx(we,{size:12})}),e.jsx("button",{onClick:()=>v(t.id,{favorito:!t.favorito}),className:"p-1.5 rounded-lg bg-bg-secondary text-text-muted cursor-pointer border-none hover:text-accent-yellow",children:e.jsx(R,{size:12,className:t.favorito?"fill-accent-yellow text-accent-yellow":""})}),e.jsx("button",{onClick:()=>xe(t.id),className:"p-1.5 rounded-lg bg-bg-secondary text-text-muted cursor-pointer border-none hover:text-accent-red",children:e.jsx(Se,{size:12})})]})]},t.id)),K.length===0&&e.jsxs("div",{className:"col-span-3 text-center py-10 text-text-muted",children:[e.jsx(U,{size:40,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{className:"text-sm",children:"No hay plantillas"})]})]})]}),p==="enviar"&&e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"bg-bg-card rounded-2xl border border-border p-4 mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Seleccionar Cliente"}),r?e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl bg-accent-blue/5 border border-accent-blue/20",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold",children:r.nombre}),e.jsxs("p",{className:"text-[11px] text-text-muted font-mono",children:[r.movil_1," Â· ",r.id]})]}),e.jsx("button",{onClick:()=>V(null),className:"p-1 rounded-lg bg-bg-secondary border-none cursor-pointer text-text-muted hover:text-accent-red",children:e.jsx(Y,{size:14})})]}):e.jsxs("div",{className:"relative",children:[e.jsx(Z,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted"}),e.jsx("input",{value:E,onChange:t=>W(t.target.value),placeholder:"Buscar por nombre, mÃ³vil o ID...",className:"w-full pl-9 pr-4 py-2.5 rounded-xl bg-bg-secondary border border-border text-sm"}),J.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-bg-card border border-border rounded-xl shadow-lg z-10 max-h-[200px] overflow-y-auto",children:J.map(t=>e.jsxs("button",{onClick:()=>me(t),className:"w-full text-left p-3 text-sm cursor-pointer bg-transparent border-none hover:bg-bg-secondary transition-colors flex justify-between",children:[e.jsx("span",{className:"font-medium",children:t.nombre}),e.jsx("span",{className:"text-[11px] text-text-muted font-mono",children:t.movil_1})]},t.id))})]}),!r&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-1.5",children:"O envÃ­o manual:"}),e.jsx("input",{value:F,onChange:t=>re(t.target.value),placeholder:"NÃºmero de telÃ©fono (9 dÃ­gitos)",className:"w-full px-4 py-2 rounded-xl bg-bg-secondary border border-border text-sm font-mono"})]})]}),e.jsxs("div",{className:"bg-bg-card rounded-2xl border border-border p-4",children:[e.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Seleccionar Plantilla"}),e.jsx("div",{className:"flex flex-col gap-1.5 max-h-[250px] overflow-y-auto",children:a.map(t=>e.jsxs("button",{onClick:()=>X(t),className:`text-left p-3 rounded-xl text-xs cursor-pointer border transition-all
                      ${y?.id===t.id?"border-accent-blue bg-accent-blue/5":"border-border bg-bg-secondary hover:border-border"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold",children:t.titulo}),e.jsx("span",{className:"text-[10px] text-text-muted",children:t.categoria})]}),e.jsx("p",{className:"text-[11px] text-text-muted mt-1 truncate",children:t.mensaje})]},t.id))})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"bg-bg-card rounded-2xl border border-border p-4 mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Vista Previa del Mensaje"}),e.jsx("textarea",{value:x,onChange:t=>A(t.target.value),rows:8,className:"w-full p-4 rounded-xl bg-bg-secondary border border-border text-sm resize-none font-mono",placeholder:"Selecciona una plantilla o escribe un mensaje..."}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("p",{className:"text-[11px] text-text-muted mb-2 flex items-center gap-1",children:[e.jsx(ke,{size:12})," Reescribir con IA (Gemini)"]}),e.jsx("div",{className:"flex gap-1.5",children:Object.entries($e).map(([t,s])=>e.jsx("button",{onClick:()=>pe(t),disabled:G||!x,className:"py-1.5 px-3 rounded-lg bg-bg-secondary border border-border text-[11px] font-semibold cursor-pointer hover:border-accent-purple disabled:opacity-40 disabled:cursor-not-allowed transition-colors",children:G?"...":`${s.emoji} ${s.label}`},t))})]})]}),e.jsxs("button",{onClick:be,disabled:!x||!r?.movil_1&&!F,className:"w-full py-3 rounded-xl bg-accent-green border-none text-white text-sm font-bold cursor-pointer flex items-center justify-center gap-2 hover:opacity-90 disabled:opacity-40 disabled:cursor-not-allowed transition-opacity",children:[e.jsx(S,{size:18}),"Enviar por WhatsApp"]}),e.jsxs("button",{onClick:()=>{x&&navigator.clipboard.writeText(x)},disabled:!x,className:"w-full mt-2 py-2.5 rounded-xl bg-bg-secondary border border-border text-text-secondary text-xs font-semibold cursor-pointer flex items-center justify-center gap-2 hover:border-accent-blue disabled:opacity-40 disabled:cursor-not-allowed transition-colors",children:[e.jsx(Q,{size:14}),"Copiar texto al portapapeles"]})]})]}),p==="campana"&&e.jsx("div",{children:T?e.jsxs("div",{className:"bg-bg-card rounded-2xl border border-accent-blue/30 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-accent-green animate-pulse"}),"CampaÃ±a en Curso"]}),e.jsxs("span",{className:"text-xs text-text-muted font-mono",children:[l+1," / ",n.length]})]}),e.jsx("div",{className:"w-full h-2 bg-bg-secondary rounded-full mb-4 overflow-hidden",children:e.jsx("div",{className:"h-full bg-accent-blue rounded-full transition-all",style:{width:`${(l+1)/n.length*100}%`}})}),n[l]&&e.jsxs("div",{className:"bg-bg-secondary rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold",children:n[l].nombre}),e.jsxs("p",{className:"text-[11px] text-text-muted font-mono",children:[n[l].movil_1," Â· ",n[l].zona]})]}),e.jsx("span",{className:`py-1 px-2.5 rounded-lg text-[10px] font-bold
                      ${n[l].deuda_monto>0?"bg-accent-red/15 text-accent-red":"bg-accent-green/15 text-accent-green"}`,children:n[l].deuda_monto>0?`Deuda: S/. ${n[l].deuda_monto}`:"Al dÃ­a"})]}),e.jsx("div",{className:"bg-bg-card rounded-lg p-3 text-xs text-text-secondary font-mono",children:L(f.mensaje,n[l])})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:he,className:"flex-1 py-2.5 rounded-xl bg-accent-green border-none text-white text-sm font-bold cursor-pointer flex items-center justify-center gap-2",children:[e.jsx(S,{size:16})," Enviar y Siguiente",e.jsx(_e,{size:16})]}),e.jsxs("button",{onClick:ge,className:"py-2.5 px-6 rounded-xl bg-accent-red/10 border border-accent-red/30 text-accent-red text-sm font-semibold cursor-pointer flex items-center gap-2",children:[e.jsx(Ee,{size:14})," Detener"]})]})]}):e.jsxs("div",{className:"bg-bg-card rounded-2xl border border-border p-6",children:[e.jsx("h3",{className:"text-sm font-semibold mb-4",children:"Configurar CampaÃ±a Masiva"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-2 block",children:"Filtro de Clientes"}),e.jsx("div",{className:"flex flex-col gap-2",children:[{value:"all",label:"Todos los clientes",count:i.filter(t=>t.movil_1).length},{value:"deudores",label:"Clientes con deuda",count:i.filter(t=>t.deuda_monto>0&&t.movil_1).length},{value:"cortados",label:"Cortados / Suspendidos",count:i.filter(t=>(t.estado_servicio==="Cortado"||t.estado_cuenta==="SUSPENDIDO")&&t.movil_1).length},{value:"activos",label:"Clientes activos",count:i.filter(t=>(t.status==="ONLINE"||t.estado_cuenta==="ACTIVO")&&t.movil_1).length}].map(t=>e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-xl border cursor-pointer transition-all
                          ${w===t.value?"border-accent-blue bg-accent-blue/5":"border-border bg-bg-secondary"}`,children:[e.jsx("input",{type:"radio",name:"campFilter",value:t.value,checked:w===t.value,onChange:()=>ne(t.value),className:"accent-accent-blue"}),e.jsx("span",{className:"text-sm font-medium flex-1",children:t.label}),e.jsx("span",{className:"text-xs text-text-muted font-mono",children:t.count})]},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-2 block",children:"Plantilla para la campaÃ±a"}),e.jsx("div",{className:"flex flex-col gap-1.5 max-h-[200px] overflow-y-auto",children:a.map(t=>e.jsxs("button",{onClick:()=>le(t),className:`text-left p-3 rounded-xl text-xs cursor-pointer border transition-all
                          ${f?.id===t.id?"border-accent-green bg-accent-green/5":"border-border bg-bg-secondary"}`,children:[e.jsx("span",{className:"font-semibold",children:t.titulo}),e.jsx("p",{className:"text-[11px] text-text-muted truncate mt-0.5",children:t.mensaje})]},t.id))})]})]}),e.jsxs("button",{onClick:ue,disabled:!f,className:"mt-6 w-full py-3 rounded-xl bg-accent-blue border-none text-white text-sm font-bold cursor-pointer flex items-center justify-center gap-2 hover:opacity-90 disabled:opacity-40 disabled:cursor-not-allowed transition-opacity",children:[e.jsx(Me,{size:18}),"Iniciar CampaÃ±a"]})]})}),p==="historial"&&e.jsxs("div",{className:"bg-bg-card rounded-2xl border border-border overflow-hidden",children:[e.jsx("div",{className:"py-4 px-6 border-b border-border",children:e.jsxs("h3",{className:"text-sm font-semibold",children:["Historial de EnvÃ­os (",b.length,")"]})}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:e.jsxs("table",{className:"w-full text-[13px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-[11px] text-text-muted uppercase bg-bg-secondary sticky top-0",children:[e.jsx("th",{className:"py-3 px-4",children:"Fecha"}),e.jsx("th",{className:"py-3 px-4",children:"Cliente"}),e.jsx("th",{className:"py-3 px-4",children:"Plantilla"}),e.jsx("th",{className:"py-3 px-4",children:"TelÃ©fono"}),e.jsx("th",{className:"py-3 px-4",children:"Mensaje"})]})}),e.jsxs("tbody",{children:[b.map(t=>e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("td",{className:"py-3 px-4 text-text-muted text-xs",children:new Date(t.fecha).toLocaleString("es-PE",{dateStyle:"short",timeStyle:"short"})}),e.jsx("td",{className:"py-3 px-4 font-medium",children:t.clienteNombre}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"text-[11px] bg-accent-blue/10 text-accent-blue py-0.5 px-2 rounded",children:t.plantilla})}),e.jsx("td",{className:"py-3 px-4 font-mono text-xs",children:t.telefono}),e.jsx("td",{className:"py-3 px-4 text-text-secondary text-xs truncate max-w-[250px]",children:t.mensaje})]},t.id)),b.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-10 text-center text-text-muted",children:"No hay envÃ­os registrados"})})]})]})})]}),ae&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center",onClick:()=>N(!1),children:e.jsxs("div",{className:"bg-bg-card rounded-2xl border border-border w-[550px] max-h-[85vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"p-5 border-b border-border flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-bold",children:P?"Editar Plantilla":"Nueva Plantilla"}),e.jsx("button",{onClick:()=>N(!1),className:"p-1 rounded-lg bg-bg-secondary border-none cursor-pointer text-text-muted hover:text-text-primary",children:e.jsx(Y,{size:16})})]}),e.jsxs("div",{className:"p-5 flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block",children:"TÃ­tulo"}),e.jsx("input",{value:d.titulo,onChange:t=>g(s=>({...s,titulo:t.target.value})),className:"w-full px-4 py-2.5 rounded-xl bg-bg-secondary border border-border text-sm",placeholder:"Ej: Cobro Mensual"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block",children:"CategorÃ­a"}),e.jsx("select",{value:d.categoria,onChange:t=>g(s=>({...s,categoria:t.target.value})),className:"w-full px-4 py-2.5 rounded-xl bg-bg-secondary border border-border text-sm",children:ee.filter(t=>t!=="Todas").map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block",children:"Mensaje"}),e.jsx("textarea",{value:d.mensaje,onChange:t=>g(s=>({...s,mensaje:t.target.value})),rows:5,className:"w-full px-4 py-2.5 rounded-xl bg-bg-secondary border border-border text-sm resize-none font-mono",placeholder:"Escribe el mensaje con variables..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted mb-1.5 block",children:"Insertar Variable"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:De.map(t=>e.jsx("button",{onClick:()=>fe(t.key),title:t.desc,className:"py-1 px-2 rounded-lg bg-accent-blue/10 text-accent-blue text-[10px] font-mono font-semibold cursor-pointer border-none hover:bg-accent-blue/20 transition-colors",children:t.key},t.key))})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.favorito,onChange:t=>g(s=>({...s,favorito:t.target.checked})),className:"accent-accent-yellow"}),e.jsx("span",{className:"text-xs font-medium",children:"Marcar como favorita"})]})]}),e.jsxs("div",{className:"p-5 border-t border-border flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>N(!1),className:"py-2 px-5 rounded-lg bg-bg-secondary border border-border text-text-secondary text-sm cursor-pointer",children:"Cancelar"}),e.jsx("button",{onClick:de,disabled:!d.titulo||!d.mensaje,className:"py-2 px-5 rounded-lg bg-accent-blue border-none text-white text-sm font-semibold cursor-pointer disabled:opacity-40",children:P?"Guardar Cambios":"Crear Plantilla"})]})]})})]})}export{qe as default};
