import{c as we,a as m,r as a,j as t,F as ge,T as he,W as Oe,X as _}from"./index-z5gwiLCk.js";import{a as Ae,A as J}from"./Adjuntos-7F6-R9GM.js";import{R as _e}from"./ResolutionModal-DJE5kT1D.js";import{g as O,D as K}from"./DiagnosticFields-BoQTcgd6.js";import{a as fe,c as je}from"./CopyButton-DTw8g5RF.js";import{P as Ve}from"./plus-DzCobvzz.js";import{A as qe}from"./activity-DlpXVisw.js";import{C as ye}from"./circle-check-jQwUdo6Q.js";import{M as Z}from"./monitor-CnUazCMZ.js";import{S as Se}from"./search-rYpwXW4v.js";import{E as Be}from"./eye-CR91zfRI.js";import{C as We}from"./clock-Dh0pZaEI.js";import{G as Ue}from"./gauge-gfL2nUfU.js";import"./upload-CyUrlT-d.js";import"./download-DKlEkoFw.js";import"./chevron-right-BtTnb1_1.js";import"./chevron-down-J0mX8aEX.js";import"./radio-BVolyK1J.js";const Ge=[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]],Ye=we("signal",Ge);const Qe=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],ee=we("terminal",Qe),A={"En curso":{bg:"bg-accent-blue/20",text:"text-accent-blue"},Completada:{bg:"bg-accent-green/20",text:"text-accent-green"},Fallida:{bg:"bg-accent-red/20",text:"text-accent-red"},"Derivado a Visita":{bg:"bg-purple-500/20",text:"text-purple-400"},"Derivado a Planta Externa":{bg:"bg-orange-500/20",text:"text-orange-400"}},Ne={Diagnóstico:{bg:"bg-accent-cyan/15",text:"text-accent-cyan"},Configuración:{bg:"bg-accent-purple/15",text:"text-accent-purple"},Monitoreo:{bg:"bg-accent-blue/15",text:"text-accent-blue"},"Reinicio remoto":{bg:"bg-accent-orange/15",text:"text-accent-orange"}},ve=["Diagnóstico","Configuración","Monitoreo","Reinicio remoto"];function Ce({label:x,placeholder:V,items:j,value:c,onChange:y,renderItem:h,filterFn:C,disabled:z,readOnlyDisplay:F}){const[i,w]=a.useState(""),[R,S]=a.useState(!1),u=a.useRef(null);a.useEffect(()=>{const r=b=>{u.current&&!u.current.contains(b.target)&&S(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[]);const l=a.useMemo(()=>!i||i.length<2?[]:j.filter(r=>C(r,i.toLowerCase())).slice(0,15),[j,i,C]);return z&&F?t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-text-secondary font-medium mb-1.5 block",children:x}),t.jsx("div",{className:"w-full px-3 py-2.5 rounded-lg bg-bg-secondary/50 border border-border text-sm text-text-secondary cursor-not-allowed",children:F})]}):t.jsxs("div",{ref:u,className:"relative",children:[t.jsx("label",{className:"text-xs text-text-secondary font-medium mb-1.5 block",children:x}),t.jsxs("div",{className:"relative",children:[t.jsx(Se,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted"}),t.jsx("input",{type:"text",placeholder:V,value:c?h?h(c):c:i,onChange:r=>{c&&y(null),w(r.target.value),S(!0)},onFocus:()=>{i.length>=2&&S(!0)},className:"w-full pl-9 pr-8 py-2.5 rounded-lg bg-bg-secondary border border-border text-sm text-text-primary placeholder:text-text-muted focus:outline-none focus:border-accent-cyan/50"}),c&&t.jsx("button",{type:"button",onClick:()=>{y(null),w("")},className:"absolute right-2 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-secondary bg-transparent border-none cursor-pointer p-1",children:t.jsx(_,{size:14})})]}),R&&l.length>0&&t.jsx("div",{className:"absolute z-50 w-full mt-1 bg-bg-card border border-border rounded-lg shadow-xl max-h-48 overflow-y-auto",children:l.map((r,b)=>t.jsx("button",{type:"button",onClick:()=>{y(r),w(""),S(!1)},className:"w-full px-3 py-2 text-left hover:bg-bg-secondary text-sm text-text-primary border-none bg-transparent cursor-pointer border-b border-b-border/30 last:border-b-0",children:h?h(r):String(r)},b))}),R&&i.length>=2&&l.length===0&&t.jsx("div",{className:"absolute z-50 w-full mt-1 bg-bg-card border border-border rounded-lg shadow-xl p-3 text-sm text-text-muted text-center",children:"Sin resultados"})]})}function pt(){const x=m(e=>e.sesionesRemoto),V=m(e=>e.addSesionRemoto),j=m(e=>e.updateSesionRemoto),c=m(e=>e.clients),y=m(e=>e.tickets),h=m(e=>e.updateTicket),C=m(e=>e.tecnicos),z=m(e=>e.addVisita),F=m(e=>e.addDerivacion),i=m(e=>e.prefillSoporte),w=m(e=>e.clearPrefillSoporte),R=m(e=>e.deleteSesionRemoto),[S,u]=a.useState(!1),[l,r]=a.useState(null),[b,ke]=a.useState(""),[L,De]=a.useState("all"),[$,Ie]=a.useState("all"),[k,q]=a.useState(null),[n,D]=a.useState(null),[B,te]=a.useState("Diagnóstico"),[se,f]=a.useState(""),[P,ae]=a.useState(""),[W,ne]=a.useState(""),[oe,re]=a.useState(!1),[ce,U]=a.useState([]),[ie,M]=a.useState(""),[Re,G]=a.useState(!1),[N,Y]=a.useState(null),[T,le]=a.useState(O()),[Q,de]=a.useState(""),[X,xe]=a.useState(O());a.useEffect(()=>{l&&(le(l.diagnosticos?{...l.diagnosticos}:O()),de(l.tecnologia||""))},[l]),a.useEffect(()=>{M(n&&n.tecnologia||"")},[n]);const Te=a.useMemo(()=>C.filter(e=>e.estado==="Activo"),[C]);a.useMemo(()=>{if(!n)return{isRadio:!1,isFibra:!1};const e=(n.tecnologia||"").toLowerCase();return{isRadio:e.includes("radio"),isFibra:e.includes("fibra")}},[n]);const H=a.useMemo(()=>({enCurso:x.filter(e=>e.estado==="En curso").length,completadas:x.filter(e=>e.estado==="Completada").length,total:x.length}),[x]),me=a.useMemo(()=>x.filter(e=>{const s=!b||e.clienteNombre.toLowerCase().includes(b.toLowerCase())||e.id.toLowerCase().includes(b.toLowerCase())||e.ticketId&&e.ticketId.toLowerCase().includes(b.toLowerCase()),o=L==="all"||e.estado===L,d=$==="all"||e.tipo===$;return s&&o&&d}),[x,b,L,$]);a.useEffect(()=>{if(i){if(I(),i.ticketId){const e=y.find(s=>s.id===i.ticketId);if(e){q(e);const s=c.find(o=>o.id===e.clienteId);s&&(D(s),f(s.ip||""))}}else if(i.clienteId){const e=c.find(s=>s.id===i.clienteId);e&&(D(e),f(e.ip||""))}u(!0),w()}},[i,y,c,w]);const I=()=>{q(null),D(null),te("Diagnóstico"),f(""),ae(""),ne(""),re(!1),U([]),U([]),M(""),xe(O())},Ee=e=>{if(q(e),e){const s=c.find(o=>o.id===e.clienteId);s&&(D(s),f(s.ip||""))}else D(null),f("")},ze=e=>{D(e),f(e&&e.ip||"")},Fe=e=>{if(e.preventDefault(),!n)return;const s=C.find(g=>g.id===P),d=Object.values(X).some(g=>g!==""&&g!==null&&g!==void 0)?{...X}:null,p={clienteId:n.id,clienteNombre:n.nombre||"N/A",tipo:B,ip:se,estado:"En curso",tecnico:s?.nombre||"Sin asignar",tecnicoId:P,duracion:"—",resultado:W,ticketId:k?.id||null,ticketDesc:k?.descripcion||null,tecnologia:ie||n.tecnologia||"",plan:n.plan||"",direccion:n.direccion||"",nodo:n.nodo||"",diagnosticos:d,adjuntos:ce};V(p),oe&&n&&z({clienteId:n.id,clienteNombre:n.nombre,tecnicoId:P,tecnicoNombre:s?.nombre||"Sin asignar",tipo:"Diagnóstico",estado:"Programada",prioridad:"Media",direccion:n.direccion||"",descripcion:`Derivado de sesión remota (${B}). ${W}`,resultado:"",horaInicio:null,horaFin:null,ticketId:k?.id||null}),u(!1),I()},pe=(e,s)=>{if(s==="Completada")Y({sesionId:e,newEstado:s}),G(!0);else{j(e,{estado:s,_historyComment:"Cambio de estado manual"});const o=x.find(d=>d.id===e);o&&r({...o,estado:s})}},Le=e=>{j(e.id,{estado:"Derivado a Visita",_historyComment:"Derivado a Visita Técnica - requiere atención presencial"});const s=c.find(o=>o.id===e.clienteId);z({clienteId:e.clienteId,clienteNombre:e.clienteNombre||s?.nombre||"",direccion:e.direccion||s?.direccion||"",tipo:"Reparación",prioridad:"Alta",estado:"Programada",tecnicoId:e.tecnicoId||null,descripcion:`Derivado de Soporte Remoto (${e.id}). ${e.resultado||""}`,ticketId:e.ticketId||null,sesionOrigenId:e.id,tecnologia:Q,diagnosticoCompleto:T,...T}),e.ticketId&&h(e.ticketId,{estado:"Escalado",_historyEstadoLabel:"Escalado - Visita Técnica",_historyComment:`Derivado desde Soporte Remoto (${e.id}) a Visita Técnica`}),r({...e,estado:"Derivado a Visita"})},$e=e=>{j(e.id,{estado:"Derivado a Planta Externa",_historyComment:"Derivado a Planta Externa - problema de infraestructura"});const s=c.find(o=>o.id===e.clienteId);F({clienteId:e.clienteId,clienteNombre:e.clienteNombre||s?.nombre||"",zona:s?.nodo_router||e.nodo||"",tipo:s?.tecnologia||"Fibra Óptica",prioridad:"Alta",estado:"Pendiente",descripcion:`Derivado de Soporte Remoto (${e.id}). ${e.resultado||""}`,ticketId:e.ticketId||null,sesionOrigenId:e.id,tecnologia:Q,diagnosticoCompleto:T,...T}),e.ticketId&&h(e.ticketId,{estado:"Escalado",_historyEstadoLabel:"Escalado - Planta Externa",_historyComment:`Derivado desde Soporte Remoto (${e.id}) a Planta Externa`}),r({...e,estado:"Derivado a Planta Externa"})},Pe=e=>{if(!N)return;j(N.sesionId,{estado:N.newEstado,...e,_historyComment:e.solucion||"Sesión completada"});const s=x.find(o=>o.id===N.sesionId);s?.ticketId&&h(s.ticketId,{estado:"Resuelto",_historyComment:`Resuelto desde Soporte Remoto (${s.id})`}),s&&r({...s,estado:N.newEstado,...e}),G(!1),Y(null)},Me=e=>{window.confirm("¿Estás seguro de eliminar esta sesión remota? Esta acción no se puede deshacer.")&&(R&&R(e),r(null))},ue=e=>{if(!e)return{};const s={};return e.ping&&parseFloat(e.ping)>80&&(s.ping=!0),e.download&&parseFloat(e.download)<10&&(s.download=!0),e.upload&&parseFloat(e.upload)<5&&(s.upload=!0),e.packetLoss&&parseFloat(e.packetLoss)>2&&(s.packetLoss=!0),e.jitter&&parseFloat(e.jitter)>15&&(s.jitter=!0),e.senalRecibida&&parseFloat(e.senalRecibida)<-75&&(s.senalRecibida=!0),e.ccq&&parseFloat(e.ccq)<85&&(s.ccq=!0),e.potenciaRx&&parseFloat(e.potenciaRx)<-25&&(s.potenciaRx=!0),e.atenuacion&&parseFloat(e.atenuacion)>28&&(s.atenuacion=!0),e.estadoONU&&e.estadoONU!=="Online"&&(s.estadoONU=!0),s};return t.jsxs("div",{className:"animate-fade p-4 sm:p-6 sm:px-8 h-full overflow-y-auto",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl sm:text-[26px] font-bold tracking-tight",children:"Soporte Remoto"}),t.jsx("p",{className:"text-text-secondary text-sm mt-1",children:"Diagnóstico y configuración remota de equipos"})]}),t.jsxs("button",{onClick:()=>{I(),u(!0)},className:"w-full sm:w-auto justify-center py-2.5 px-4 rounded-xl bg-accent-cyan border-none text-white text-sm font-semibold cursor-pointer flex items-center gap-2 hover:opacity-90 transition-opacity",children:[t.jsx(Ve,{size:16})," Nueva Sesión"]})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6",children:[t.jsxs("div",{className:"bg-bg-card rounded-xl p-4 border border-border flex items-center gap-3",children:[t.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-accent-blue/15 text-accent-blue",children:t.jsx(qe,{size:16})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-bold font-mono",children:H.enCurso}),t.jsx("p",{className:"text-[10px] text-text-muted uppercase",children:"En curso"})]})]}),t.jsxs("div",{className:"bg-bg-card rounded-xl p-4 border border-border flex items-center gap-3",children:[t.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-accent-green/15 text-accent-green",children:t.jsx(ye,{size:16})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-bold font-mono",children:H.completadas}),t.jsx("p",{className:"text-[10px] text-text-muted uppercase",children:"Completadas"})]})]}),t.jsxs("div",{className:"bg-bg-card rounded-xl p-4 border border-border flex items-center gap-3",children:[t.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-accent-purple/15 text-accent-purple",children:t.jsx(Z,{size:16})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-bold font-mono",children:H.total}),t.jsx("p",{className:"text-[10px] text-text-muted uppercase",children:"Total sesiones"})]})]})]}),t.jsxs("div",{className:"flex gap-3 mb-5 flex-wrap",children:[t.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[t.jsx(Se,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted"}),t.jsx("input",{placeholder:"Buscar por cliente, ID, ticket...",value:b,onChange:e=>ke(e.target.value),className:"w-full pl-9 bg-bg-secondary border border-border text-text-primary rounded-lg py-2.5 px-3 text-sm outline-none focus:border-accent-cyan"})]}),t.jsxs("select",{value:L,onChange:e=>De(e.target.value),className:"min-w-[150px] bg-bg-secondary border border-border text-text-primary rounded-lg py-2.5 px-3 text-sm outline-none focus:border-accent-cyan",children:[t.jsx("option",{value:"all",children:"Todos los estados"}),t.jsx("option",{value:"En curso",children:"En curso"}),t.jsx("option",{value:"Completada",children:"Completada"}),t.jsx("option",{value:"Fallida",children:"Fallida"})]}),t.jsxs("select",{value:$,onChange:e=>Ie(e.target.value),className:"min-w-[150px] bg-bg-secondary border border-border text-text-primary rounded-lg py-2.5 px-3 text-sm outline-none focus:border-accent-cyan",children:[t.jsx("option",{value:"all",children:"Todos los tipos"}),ve.map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsxs("div",{className:"flex flex-col gap-3",children:[me.length===0&&t.jsxs("div",{className:"bg-bg-card rounded-xl p-8 border border-border text-center",children:[t.jsx(Z,{size:32,className:"mx-auto text-text-muted mb-3"}),t.jsx("p",{className:"text-text-secondary text-sm",children:"No se encontraron sesiones"})]}),me.map(e=>{const s=A[e.estado]||A.Completada,o=Ne[e.tipo]||{bg:"bg-bg-secondary",text:"text-text-secondary"},d=e.diagnosticos&&Object.values(e.diagnosticos).some(v=>v!==""&&v!==null&&v!==void 0),p=ue(e.diagnosticos),g=Object.keys(p).length>0;return t.jsxs("div",{onClick:()=>r(e),className:"bg-bg-card rounded-xl p-4 border border-border cursor-pointer transition-all hover:border-accent-cyan/40 group",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center bg-accent-cyan/15 text-accent-cyan",children:t.jsx(ee,{size:16})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsx("span",{className:"font-mono text-xs text-text-muted",children:e.id}),t.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] font-bold ${s.bg} ${s.text}`,children:e.estado}),t.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] font-bold ${o.bg} ${o.text}`,children:e.tipo}),e.ticketId&&t.jsxs("span",{className:"px-2 py-0.5 rounded text-[11px] font-bold bg-accent-orange/15 text-accent-orange flex items-center gap-1",children:[t.jsx(ge,{size:10})," ",e.ticketId]}),g&&t.jsxs("span",{className:"px-2 py-0.5 rounded text-[11px] font-bold bg-accent-orange/15 text-accent-orange flex items-center gap-1",children:[t.jsx(he,{size:10})," Alertas"]})]}),t.jsx("p",{className:"text-sm font-semibold mt-0.5",children:e.clienteNombre})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(fe,{getTextFn:()=>je(e,c.find(v=>v.id===e.clienteId))}),t.jsx("span",{className:"text-[11px] text-text-muted",children:e.fecha}),t.jsx(Be,{size:14,className:"text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})]}),t.jsxs("div",{className:"flex items-center gap-6 text-[11px] text-text-muted mt-1 flex-wrap",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(Oe,{size:10})," IP: ",t.jsx("span",{className:"text-accent-cyan font-mono",children:e.ip})]}),t.jsxs("span",{children:["Técnico: ",t.jsx("span",{className:"text-text-secondary",children:e.tecnico})]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(We,{size:10})," Duración: ",t.jsx("span",{className:"text-text-secondary",children:e.duracion})]}),t.jsx(Ae,{count:e.adjuntos?.length})]}),d&&t.jsxs("div",{className:"mt-2 p-2 bg-bg-secondary rounded-lg flex items-center gap-4 text-[11px] flex-wrap",children:[t.jsxs("span",{className:"text-text-muted font-semibold uppercase tracking-wide flex items-center gap-1",children:[t.jsx(Ue,{size:10})," Diag:"]}),e.diagnosticos.ping&&t.jsxs("span",{className:p.ping?"text-accent-orange":"text-text-secondary",children:["Ping: ",t.jsxs("span",{className:"font-mono",children:[e.diagnosticos.ping,"ms"]})]}),e.diagnosticos.download&&t.jsxs("span",{className:p.download?"text-accent-orange":"text-text-secondary",children:["DL: ",t.jsxs("span",{className:"font-mono",children:[e.diagnosticos.download,"Mbps"]})]}),e.diagnosticos.upload&&t.jsxs("span",{className:p.upload?"text-accent-orange":"text-text-secondary",children:["UL: ",t.jsxs("span",{className:"font-mono",children:[e.diagnosticos.upload,"Mbps"]})]}),e.diagnosticos.senalRecibida&&t.jsxs("span",{className:p.senalRecibida?"text-accent-orange":"text-text-secondary",children:[t.jsx(Ye,{size:10,className:"inline mr-0.5"}),t.jsxs("span",{className:"font-mono",children:[e.diagnosticos.senalRecibida,"dBm"]})]}),e.diagnosticos.potenciaRx&&t.jsxs("span",{className:p.potenciaRx?"text-accent-orange":"text-text-secondary",children:["Rx: ",t.jsxs("span",{className:"font-mono",children:[e.diagnosticos.potenciaRx,"dBm"]})]})]}),e.resultado&&!d&&t.jsx("div",{className:"mt-2 p-2 bg-bg-secondary rounded-lg text-xs text-text-secondary",children:e.resultado})]},e.id)})]}),S&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>{u(!1),I()},children:t.jsxs("div",{className:"bg-bg-card rounded-2xl p-6 w-full max-w-[640px] border border-border max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"flex items-center justify-between mb-5",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-accent-cyan/15 text-accent-cyan",children:t.jsx(ee,{size:18})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold",children:"Nueva Sesión Remota"}),t.jsx("p",{className:"text-xs text-text-muted",children:"Complete los datos del diagnóstico"})]})]}),t.jsx("button",{onClick:()=>{u(!1),I()},className:"w-8 h-8 rounded-lg flex items-center justify-center bg-bg-secondary border border-border text-text-muted hover:text-text-primary cursor-pointer transition-colors",children:t.jsx(_,{size:16})})]}),t.jsxs("form",{onSubmit:Fe,className:"flex flex-col gap-4",children:[t.jsx(Ce,{label:"Ticket vinculado (opcional)",placeholder:"Buscar ticket por ID o descripción...",items:y,value:k,onChange:Ee,renderItem:e=>`${e.id} — ${e.clienteNombre} — ${e.descripcion?.slice(0,50)}...`,filterFn:(e,s)=>e.id.toLowerCase().includes(s)||(e.clienteNombre||"").toLowerCase().includes(s)||(e.descripcion||"").toLowerCase().includes(s)}),t.jsx(Ce,{label:"Cliente",placeholder:"Buscar por nombre o ID de cliente...",items:c,value:n,onChange:ze,renderItem:e=>`${e.id} — ${e.nombre}${e.ip?` (${e.ip})`:""}`,filterFn:(e,s)=>e.id.toLowerCase().includes(s)||(e.nombre||"").toLowerCase().includes(s),disabled:!!k,readOnlyDisplay:k&&n?`${n.id} — ${n.nombre}`:null}),n&&t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50 flex items-center gap-4 flex-wrap text-[11px]",children:[t.jsxs("span",{className:"text-text-muted",children:["Tecnología: ",t.jsx("span",{className:"text-accent-cyan font-semibold",children:n.tecnologia||"—"})]}),t.jsxs("span",{className:"text-text-muted",children:["Plan: ",t.jsx("span",{className:"text-text-secondary font-semibold",children:n.plan||"—"})]}),t.jsxs("span",{className:"text-text-muted",children:["Nodo: ",t.jsx("span",{className:"text-text-secondary font-mono",children:n.nodo||"—"})]}),t.jsxs("span",{className:"text-text-muted",children:["Dirección: ",t.jsx("span",{className:"text-text-secondary",children:n.direccion||"—"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-text-secondary font-medium mb-1.5 block",children:"Tipo de sesión"}),t.jsx("select",{value:B,onChange:e=>te(e.target.value),className:"w-full px-3 py-2.5 rounded-lg bg-bg-secondary border border-border text-sm text-text-primary focus:outline-none focus:border-accent-cyan/50",children:ve.map(e=>t.jsx("option",{value:e,children:e},e))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-text-secondary font-medium mb-1.5 block",children:"IP del equipo"}),t.jsx("input",{type:"text",value:se,onChange:e=>f(e.target.value),placeholder:"Se auto-llena al elegir cliente",className:"w-full px-3 py-2.5 rounded-lg bg-bg-secondary border border-border text-sm text-text-primary font-mono placeholder:text-text-muted focus:outline-none focus:border-accent-cyan/50"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-text-secondary font-medium mb-1.5 block",children:"Técnico responsable"}),t.jsxs("select",{value:P,onChange:e=>ae(e.target.value),required:!0,className:"w-full px-3 py-2.5 rounded-lg bg-bg-secondary border border-border text-sm text-text-primary focus:outline-none focus:border-accent-cyan/50",children:[t.jsx("option",{value:"",children:"Seleccionar técnico..."}),Te.map(e=>t.jsxs("option",{value:e.id,children:[e.nombre," — ",e.especialidad," (",e.zona,")"]},e.id))]})]}),t.jsx("div",{className:"mt-4",children:t.jsx(K,{tecnologia:ie,onTecnologiaChange:M,value:X,onChange:xe})}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-text-secondary font-medium mb-1.5 block",children:"Resultado / Observaciones"}),t.jsx("textarea",{value:W,onChange:e=>ne(e.target.value),placeholder:"Describa el resultado del diagnóstico...",rows:3,className:"w-full px-3 py-2.5 rounded-lg bg-bg-secondary border border-border text-sm text-text-primary placeholder:text-text-muted focus:outline-none focus:border-accent-cyan/50 resize-none"})]}),t.jsx(J,{value:ce,onChange:U,max:5}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-bg-secondary rounded-lg p-3 border border-border/50 hover:border-accent-cyan/30 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:oe,onChange:e=>re(e.target.checked),className:"w-4 h-4 rounded accent-accent-cyan"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-text-primary font-medium",children:"Derivar a Visita Técnica"}),t.jsx("p",{className:"text-[11px] text-text-muted mt-0.5",children:"Se creará automáticamente una visita técnica al iniciar la sesión"})]})]}),t.jsxs("div",{className:"flex gap-3 mt-2",children:[t.jsx("button",{type:"button",onClick:()=>{u(!1),I()},className:"flex-1 py-2.5 rounded-lg bg-bg-secondary border border-border text-text-secondary cursor-pointer text-sm font-semibold hover:bg-bg-secondary/80 transition-colors",children:"Cancelar"}),t.jsxs("button",{type:"submit",disabled:!n,className:"flex-1 py-2.5 rounded-lg bg-accent-cyan border-none text-white cursor-pointer text-sm font-semibold hover:opacity-90 transition-opacity disabled:opacity-40 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[t.jsx(Z,{size:16})," Iniciar Sesión"]})]})]})]})}),l&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>r(null),children:t.jsx("div",{className:"bg-bg-card rounded-2xl p-6 w-full max-w-[640px] border border-border max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:(()=>{const e=l,s=A[e.estado]||A.Completada,o=Ne[e.tipo]||{bg:"bg-bg-secondary",text:"text-text-secondary"},d=e.diagnosticos,p=ue(d),g=Object.keys(p).length>0,v=d&&Object.values(d).some(E=>E!==""&&E!==null&&E!==void 0),be=(e.tecnologia||"").toLowerCase();return be.includes("radio"),be.includes("fibra"),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between mb-5",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-accent-cyan/15 text-accent-cyan",children:t.jsx(ee,{size:20})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-mono text-sm text-text-muted font-bold",children:e.id}),t.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] font-bold ${s.bg} ${s.text}`,children:e.estado})]}),t.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:e.fecha})]})]}),t.jsx(fe,{getTextFn:()=>je(l,c.find(E=>E.id===l.clienteId)),size:"md",title:"Copiar para WhatsApp"}),t.jsx("button",{onClick:()=>r(null),className:"w-8 h-8 rounded-lg flex items-center justify-center bg-bg-secondary border border-border text-text-muted hover:text-text-primary cursor-pointer transition-colors",children:t.jsx(_,{size:16})})]}),g&&t.jsxs("div",{className:"bg-accent-orange/10 border border-accent-orange/30 rounded-lg p-3 mb-4 flex items-center gap-2",children:[t.jsx(he,{size:16,className:"text-accent-orange flex-shrink-0"}),t.jsx("p",{className:"text-xs text-accent-orange font-medium",children:"Se detectaron valores fuera de rango en los parámetros de diagnóstico. Revise los indicadores marcados."})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-2",children:"Información del cliente"}),t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50",children:[t.jsx("p",{className:"text-sm font-semibold text-text-primary mb-1",children:e.clienteNombre}),t.jsxs("div",{className:"flex items-center gap-4 flex-wrap text-[11px] text-text-muted",children:[t.jsxs("span",{children:["ID: ",t.jsx("span",{className:"text-text-secondary font-mono",children:e.clienteId})]}),e.tecnologia&&t.jsxs("span",{children:["Tecnología: ",t.jsx("span",{className:"text-accent-cyan font-semibold",children:e.tecnologia})]}),e.plan&&t.jsxs("span",{children:["Plan: ",t.jsx("span",{className:"text-text-secondary",children:e.plan})]}),e.direccion&&t.jsxs("span",{children:["Dir: ",t.jsx("span",{className:"text-text-secondary",children:e.direccion})]}),e.nodo&&t.jsxs("span",{children:["Nodo: ",t.jsx("span",{className:"text-text-secondary font-mono",children:e.nodo})]})]})]})]}),e.ticketId&&t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-2",children:"Ticket vinculado"}),t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50 flex items-center gap-2",children:[t.jsx(ge,{size:14,className:"text-accent-orange"}),t.jsx("span",{className:"text-sm font-mono font-semibold text-accent-orange",children:e.ticketId}),e.ticketDesc&&t.jsx("span",{className:"text-xs text-text-secondary ml-2",children:e.ticketDesc})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-2",children:"Detalles de sesión"}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-2.5 border border-border/50",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-0.5",children:"Tipo"}),t.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-[11px] font-bold ${o.bg} ${o.text}`,children:e.tipo})]}),t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-2.5 border border-border/50",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-0.5",children:"IP"}),t.jsx("p",{className:"text-sm font-mono text-accent-cyan",children:e.ip||"—"})]}),t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-2.5 border border-border/50",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-0.5",children:"Técnico"}),t.jsx("p",{className:"text-sm text-text-primary",children:e.tecnico})]}),t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-2.5 border border-border/50",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-0.5",children:"Duración"}),t.jsx("p",{className:"text-sm text-text-primary font-mono",children:e.duracion})]})]})]}),e.resultado&&t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-2",children:"Resultado"}),t.jsx("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50 text-sm text-text-secondary leading-relaxed",children:e.resultado})]}),(e.solucion||e.accionesRealizadas)&&t.jsxs("div",{className:"bg-green-500/5 border border-green-500/20 rounded-lg p-3 mb-4",children:[t.jsxs("p",{className:"text-[10px] text-green-400 uppercase tracking-wide mb-2 font-semibold flex items-center gap-1",children:[t.jsx(ye,{size:12}),"Resolución"]}),e.solucion&&t.jsxs("div",{className:"mb-2",children:[t.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Solución:"}),t.jsx("p",{className:"text-sm text-text-secondary",children:e.solucion})]}),e.accionesRealizadas&&t.jsxs("div",{className:"mb-2",children:[t.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Acciones Realizadas:"}),t.jsx("p",{className:"text-sm text-text-secondary",children:e.accionesRealizadas})]}),e.adjuntosResolucion&&e.adjuntosResolucion.length>0&&t.jsxs("div",{className:"mt-2",children:[t.jsx("p",{className:"text-[10px] text-text-muted mb-1",children:"Evidencia:"}),t.jsx(J,{value:e.adjuntosResolucion,onChange:()=>{},readOnly:!0,max:5})]})]}),e.adjuntos&&e.adjuntos.length>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-2",children:"Adjuntos / Evidencia"}),t.jsx(J,{value:e.adjuntos,onChange:()=>{},readOnly:!0,max:5})]}),v&&t.jsx("div",{className:"border-t border-border pt-4",children:t.jsx(K,{tecnologia:e.tecnologia,value:d,onChange:()=>{},onTecnologiaChange:null,warnings:p,readOnly:!0})}),e.estado==="En curso"&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"flex gap-2 mb-2",children:[t.jsx("button",{onClick:()=>pe(e.id,"Completada"),className:"flex-1 py-2 rounded-lg bg-accent-green/20 text-accent-green border-none text-xs font-semibold cursor-pointer hover:bg-accent-green/30",children:"Marcar Completada"}),t.jsx("button",{onClick:()=>pe(e.id,"Fallida"),className:"flex-1 py-2 rounded-lg bg-accent-red/20 text-accent-red border-none text-xs font-semibold cursor-pointer hover:bg-accent-red/30",children:"Marcar Fallida"})]}),t.jsx("div",{className:"mb-3",children:t.jsx(K,{tecnologia:Q,onTecnologiaChange:de,value:T,onChange:le})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>Le(e),className:"flex-1 py-2 rounded-lg bg-purple-500/20 text-purple-400 border-none text-xs font-semibold cursor-pointer hover:bg-purple-500/30",children:"Derivar a Visita Técnica"}),t.jsx("button",{onClick:()=>$e(e),className:"flex-1 py-2 rounded-lg bg-orange-500/20 text-orange-400 border-none text-xs font-semibold cursor-pointer hover:bg-orange-500/30",children:"Derivar a Planta Externa"})]})]}),t.jsxs("div",{className:"flex gap-2 mt-4 pt-3 border-t border-border",children:[t.jsxs("button",{onClick:()=>Me(e.id),className:"py-2.5 px-4 rounded-lg border border-red-500/30 text-xs text-red-400 cursor-pointer bg-transparent hover:bg-red-500/10 transition-colors flex items-center gap-1.5",children:[t.jsx(_,{size:12})," Eliminar"]}),t.jsx("button",{onClick:()=>r(null),className:"flex-1 py-2.5 px-6 rounded-lg bg-bg-secondary border border-border text-text-secondary cursor-pointer text-sm font-semibold hover:bg-bg-secondary/80 transition-colors",children:"Cerrar"})]})]})})()})}),t.jsx(_e,{open:Re,onClose:()=>{G(!1),Y(null)},onConfirm:Pe,title:"Completar Sesion Remota",entityId:N?x.find(e=>e.id===N.sesionId)?.id:"",entityLabel:"Sesion",newStatus:"Completada",accentColor:"accent-cyan"})]})}export{pt as default};
