import{c as w,a as g,r as h,j as e,b as $,U as T,W as k,T as P,B as _}from"./index-DBbpf6L9.js";import{K as p}from"./KPICard-DcOP6hfx.js";import{C as D}from"./circle-alert-upW2d0ng.js";const E=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],S=w("trending-down",E);function C(){const n=g(s=>s.clients),t=g(s=>s.averias),i=h.useMemo(()=>{const s=[],o={},r=new Date().toISOString().split("T")[0];t.forEach(l=>{l.estado!=="Resuelta"&&l.fecha===r&&(o[l.zona]=(o[l.zona]||0)+1)}),Object.entries(o).forEach(([l,m])=>{m>=3&&s.push({id:`av-${l}`,type:"critical",icon:e.jsx($,{size:18}),title:`Posible Caída en ${l}`,desc:`${m} reportes de avería registrados hoy en esta zona.`})});const d=n.filter(l=>l.deuda_meses>=3&&l.estado_servicio!=="Cortado").length;d>0&&s.push({id:"debt-critical",type:"warning",icon:e.jsx(S,{size:18}),title:"Gestión de Corte Requerida",desc:`${d} clientes tienen 3 o más meses de deuda y siguen activos.`});const x=n.filter(l=>!l.plan||l.plan==="Sin Plan").length;return x>0&&s.push({id:"no-plan",type:"info",icon:e.jsx(D,{size:18}),title:"Datos Incompletos",desc:`${x} clientes no tienen un plan de internet asignado.`}),s},[n,t]);return i.length===0?null:e.jsx("div",{className:"mb-6 grid gap-3",children:i.map(s=>e.jsxs("div",{className:`
          flex items-start gap-3 p-4 rounded-xl border
          ${s.type==="critical"?"bg-red-500/10 border-red-500/20 text-red-200":""}
          ${s.type==="warning"?"bg-amber-500/10 border-amber-500/20 text-amber-200":""}
          ${s.type==="info"?"bg-blue-500/10 border-blue-500/20 text-blue-200":""}
        `,children:[e.jsx("div",{className:`mt-0.5 p-1.5 rounded-full 
            ${s.type==="critical"?"bg-red-500/20 text-red-400":""}
            ${s.type==="warning"?"bg-amber-500/20 text-amber-400":""}
            ${s.type==="info"?"bg-blue-500/20 text-blue-400":""}
          `,children:s.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold mb-0.5",children:s.title}),e.jsx("p",{className:"text-xs opacity-90",children:s.desc})]})]},s.id))})}function L(){const n=g(s=>s.clients),t=h.useMemo(()=>{const s=n.length,o=n.filter(a=>a.status==="ONLINE").length,r=s-o,d=n.filter(a=>a.tecnologia==="Radio Enlace").length,x=n.filter(a=>a.tecnologia==="Fibra Óptica").length,l=n.filter(a=>(a.deuda_monto||0)>0).length,m=n.reduce((a,c)=>a+(c.deuda_monto||0),0),u=n.filter(a=>a.estado_cuenta==="ACTIVO").length,j=n.filter(a=>a.estado_cuenta==="SUSPENDIDO").length,N=n.filter(a=>a.servicios_adicionales?.length>0).length,f={};n.forEach(a=>{a.nodo_router&&(f[a.nodo_router]=(f[a.nodo_router]||0)+1)});const v=Object.entries(f).sort((a,c)=>c[1]-a[1]).slice(0,8),b={};n.forEach(a=>{a.plan&&(b[a.plan]=(b[a.plan]||0)+1)});const y=Object.entries(b).sort((a,c)=>c[1]-a[1]).slice(0,6);return{total:s,online:o,offline:r,radio:d,fibra:x,conDeuda:l,totalDeuda:m,activos:u,suspendidos:j,conTV:N,topNodos:v,topPlanes:y}},[n]),i=s=>t.total?(s/t.total*100).toFixed(1):"0.0";return e.jsxs("div",{className:"p-4 sm:p-6 sm:px-8 overflow-y-auto h-full",children:[e.jsxs("div",{className:"mb-7",children:[e.jsx("h1",{className:"text-xl sm:text-[26px] font-bold tracking-tight",children:"Dashboard"}),e.jsxs("p",{className:"text-text-secondary text-sm mt-1",children:["Resumen operativo del ISP — ",t.total," clientes registrados"]})]}),e.jsx(C,{}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 mb-7",children:[e.jsx("div",{className:"animate-fade stagger-1",children:e.jsx(p,{title:"Total Clientes",value:t.total,subtitle:`${t.activos} activos · ${t.suspendidos} suspendidos`,icon:e.jsx(T,{size:20}),color:"#3b82f6"})}),e.jsx("div",{className:"animate-fade stagger-2",children:e.jsx(p,{title:"En Línea",value:t.online,subtitle:`${i(t.online)}% conectados`,icon:e.jsx(k,{size:20}),color:"#10b981"})}),e.jsx("div",{className:"animate-fade stagger-3",children:e.jsx(p,{title:"Fuera de Línea",value:t.offline,subtitle:`${i(t.offline)}% desconectados`,icon:e.jsx(P,{size:20}),color:"#ef4444"})}),e.jsx("div",{className:"animate-fade stagger-4",children:e.jsx(p,{title:"Deuda Total",value:`S/. ${t.totalDeuda.toLocaleString()}`,subtitle:`${t.conDeuda} clientes con deuda`,icon:e.jsx(_,{size:20}),color:"#f59e0b"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 mb-7",children:[e.jsxs("div",{className:"animate-fade stagger-3 bento-card p-6",children:[e.jsx("h3",{className:"text-sm font-bold mb-5 text-text-secondary uppercase tracking-wide",children:"Distribución por Tecnología"}),e.jsx("div",{className:"flex flex-col gap-4",children:[{label:"Radio Enlace",count:t.radio,color:"#3b82f6"},{label:"Fibra Óptica",count:t.fibra,color:"#8b5cf6"},{label:"No Determinado",count:t.total-t.radio-t.fibra,color:"#6b7280"}].map(s=>e.jsxs("div",{className:"group cursor-default",children:[e.jsxs("div",{className:"flex justify-between mb-1.5 text-[13px]",children:[e.jsx("span",{className:"font-semibold transition-colors",style:{color:s.color},children:s.label}),e.jsxs("span",{className:"font-mono text-xs font-bold text-text-primary group-hover:text-accent-blue transition-colors",children:[s.count," (",i(s.count),"%)"]})]}),e.jsx("div",{className:"h-1.5 bg-bg-secondary rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-1000 ease-out",style:{width:`${i(s.count)}%`,background:s.color}})})]},s.label))})]}),e.jsxs("div",{className:"animate-fade stagger-4 bento-card p-6",children:[e.jsx("h3",{className:"text-sm font-bold mb-5 text-text-secondary uppercase tracking-wide",children:"Estado de Conexiones"}),e.jsxs("div",{className:"flex items-center justify-center gap-8 h-[calc(100%-40px)]",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-[100px] h-[100px] rounded-full flex items-center justify-center relative shadow-inner",style:{background:`conic-gradient(#10b981 ${t.online/(t.total||1)*360}deg, var(--color-bg-secondary) ${t.online/(t.total||1)*360}deg)`},children:e.jsx("div",{className:"w-[76px] h-[76px] rounded-full bg-bg-card flex items-center justify-center shadow-sm",children:e.jsxs("span",{className:"font-mono text-xl font-bold text-text-primary",children:[i(t.online),"%"]})})}),e.jsx("p",{className:"text-[11px] font-bold text-text-muted mt-3 tracking-wider",children:"ONLINE RATES"})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2.5 bg-bg-secondary/50 px-3 py-1.5 rounded-lg border border-white/5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-accent-green shadow-[0_0_8px_rgba(16,185,129,0.5)] animate-pulse"}),e.jsxs("span",{className:"text-xs font-semibold text-text-primary",children:["Online: ",t.online]})]}),e.jsxs("div",{className:"flex items-center gap-2.5 bg-bg-secondary/50 px-3 py-1.5 rounded-lg border border-white/5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-bg-secondary border-2 border-text-muted"}),e.jsxs("span",{className:"text-xs font-semibold text-text-secondary",children:["Offline: ",t.offline]})]})]})]})]}),e.jsxs("div",{className:"animate-fade stagger-5 bento-card p-6 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold mb-5 text-text-secondary uppercase tracking-wide",children:"Servicios Adicionales"}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("p",{className:"text-[42px] leading-tight font-black font-mono text-transparent bg-clip-text bg-gradient-to-r from-accent-cyan to-accent-blue drop-shadow-sm",children:t.conTV}),e.jsx("p",{className:"text-[11px] font-bold text-text-muted uppercase tracking-wider mt-1",children:"Suscripciones TV/IPTV"})]})]}),e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsxs("div",{className:"flex-1 text-center py-2.5 px-2 bg-bg-secondary/60 rounded-xl border border-white/5 hover:bg-bg-secondary transition-colors",children:[e.jsx("p",{className:"text-lg font-bold text-text-primary",children:t.total-t.conTV}),e.jsx("p",{className:"text-[10px] uppercase tracking-wide font-semibold text-text-muted mt-0.5",children:"Solo Internet"})]}),e.jsxs("div",{className:"flex-1 text-center py-2.5 px-2 bg-bg-secondary/60 rounded-xl border border-white/5 hover:bg-bg-secondary transition-colors",children:[e.jsxs("p",{className:"text-lg font-bold text-text-primary",children:[i(t.conTV),"%"]}),e.jsx("p",{className:"text-[10px] uppercase tracking-wide font-semibold text-text-muted mt-0.5",children:"Penetración"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"animate-fade stagger-5 bento-card p-6",children:[e.jsx("h3",{className:"text-sm font-bold mb-4 text-text-secondary tracking-wide uppercase",children:"Top Nodos / Torres"}),e.jsx("div",{className:"flex flex-col gap-3",children:t.topNodos.map(([s,o],r)=>e.jsxs("div",{className:"flex items-center gap-3 py-1.5",children:[e.jsx("span",{className:"font-mono text-[11px] text-text-muted w-5 bg-bg-secondary w-6 h-6 flex items-center justify-center rounded-md font-bold",children:r+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between mb-1.5",children:[e.jsx("span",{className:"text-xs font-semibold text-text-primary",children:s}),e.jsx("span",{className:"font-mono text-[11px] text-text-secondary font-bold",children:o})]}),e.jsx("div",{className:"h-1.5 bg-bg-secondary rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-accent-blue rounded-full transition-all duration-1000 ease-out",style:{width:`${o/(t.topNodos[0]?.[1]||1)*100}%`}})})]})]},s))})]}),e.jsxs("div",{className:"animate-fade stagger-6 bento-card p-6",children:[e.jsx("h3",{className:"text-sm font-bold mb-4 text-text-secondary tracking-wide uppercase",children:"Top Planes Contratados"}),e.jsx("div",{className:"flex flex-col gap-3",children:t.topPlanes.map(([s,o],r)=>e.jsxs("div",{className:"flex items-center gap-3 py-1.5",children:[e.jsx("span",{className:"font-mono text-[11px] text-text-muted w-5 bg-bg-secondary w-6 h-6 flex items-center justify-center rounded-md font-bold",children:r+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between mb-1.5",children:[e.jsx("span",{className:"text-[11px] font-semibold text-text-primary max-w-[75%] overflow-hidden text-ellipsis whitespace-nowrap",children:s}),e.jsx("span",{className:"font-mono text-[11px] text-text-secondary font-bold",children:o})]}),e.jsx("div",{className:"h-1.5 bg-bg-secondary rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-accent-purple rounded-full transition-all duration-1000 ease-out",style:{width:`${o/(t.topPlanes[0]?.[1]||1)*100}%`}})})]})]},s))})]})]})]})}export{L as default};
