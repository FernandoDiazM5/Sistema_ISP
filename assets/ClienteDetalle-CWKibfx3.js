import{c as U,j as e,T as A,e as J,d as Q,a as N,r as b,f as _,g as M,S as L,F as K}from"./index-Cv24CwsR.js";import{S as I}from"./StatusBadge-DUDhnNaK.js";import{P as X,A as Y}from"./Adjuntos-DeBxeCZL.js";import{G as ee}from"./gauge-DXN6X3VU.js";import{R as se}from"./radio-xo3mFr5Q.js";import{Z as ae}from"./zap-DiaWuhWU.js";import{M as O}from"./monitor-FlZyIgOX.js";import{H}from"./history-CnQfNm5G.js";import{C as V}from"./clock-qjczqwHK.js";import{C as te}from"./chevron-down-D-tQbS2m.js";import{C as B}from"./circle-check-uQPvHq6U.js";import{M as ie}from"./map-pin-1on7Zjrb.js";import"./upload-C6Gn-Zq7.js";import"./eye-BgJBHVk7.js";import"./download-sb10k0H3.js";import"./chevron-right-DmXAAVHy.js";const le=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],oe=U("arrow-left",le);const ne=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ce=U("chevron-up",ne);function u({label:s,value:t,unit:n,warn:r}){return t==null||t===""?null:e.jsxs("div",{className:`bg-bg-secondary rounded-lg p-2 border ${r?"border-accent-orange/50":"border-border/50"}`,children:[e.jsx("p",{className:"text-[9px] text-text-muted uppercase tracking-wide font-semibold mb-0.5",children:s}),e.jsxs("p",{className:`text-[11px] font-mono font-semibold ${r?"text-accent-orange":"text-text-primary"}`,children:[t,n?` ${n}`:"",r&&e.jsx(A,{size:10,className:"inline ml-1 text-accent-orange"})]})]})}function q({data:s,type:t=""}){if(!s||!Object.values(s).some(o=>o!==""&&o!==null&&o!==void 0))return null;const n=t.toLowerCase(),r=n.includes("radio"),p=n.includes("fibra"),x=(o=>{if(!o)return{};const m={};return o.ping&&parseFloat(o.ping)>80&&(m.ping=!0),o.download&&parseFloat(o.download)<10&&(m.download=!0),o.upload&&parseFloat(o.upload)<5&&(m.upload=!0),o.packetLoss&&parseFloat(o.packetLoss)>2&&(m.packetLoss=!0),o.jitter&&parseFloat(o.jitter)>15&&(m.jitter=!0),o.senalRecibida&&parseFloat(o.senalRecibida)<-75&&(m.senalRecibida=!0),o.ccq&&parseFloat(o.ccq)<85&&(m.ccq=!0),o.potenciaRx&&parseFloat(o.potenciaRx)<-25&&(m.potenciaRx=!0),o.atenuacion&&parseFloat(o.atenuacion)>28&&(m.atenuacion=!0),o.estadoONU&&o.estadoONU!=="Online"&&(m.estadoONU=!0),m})(s);return e.jsxs("div",{className:"border-t border-border pt-3 mt-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ee,{size:14,className:"text-accent-cyan"}),e.jsx("h4",{className:"text-[11px] font-bold text-text-primary uppercase tracking-wide",children:"Diagnóstico de Red"})]}),(s.ping||s.download||s.upload||s.packetLoss||s.jitter)&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-[9px] text-text-muted uppercase tracking-wide font-semibold mb-1.5",children:"Parámetros generales"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-1.5",children:[e.jsx(u,{label:"Ping",value:s.ping,unit:"ms",warn:x.ping}),e.jsx(u,{label:"Download",value:s.download,unit:"Mbps",warn:x.download}),e.jsx(u,{label:"Upload",value:s.upload,unit:"Mbps",warn:x.upload}),e.jsx(u,{label:"Packet Loss",value:s.packetLoss,unit:"%",warn:x.packetLoss}),e.jsx(u,{label:"Jitter",value:s.jitter,unit:"ms",warn:x.jitter})]})]}),r&&(s.senalRecibida||s.noiseFloor||s.ccq||s.frecuencia)&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-[9px] text-accent-purple uppercase tracking-wide font-semibold mb-1.5 flex items-center gap-1",children:[e.jsx(se,{size:10})," Radio Enlace"]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-1.5",children:[e.jsx(u,{label:"Señal",value:s.senalRecibida,unit:"dBm",warn:x.senalRecibida}),e.jsx(u,{label:"Noise Floor",value:s.noiseFloor,unit:"dBm"}),e.jsx(u,{label:"CCQ",value:s.ccq,unit:"%",warn:x.ccq}),e.jsx(u,{label:"Frecuencia",value:s.frecuencia,unit:"GHz"}),e.jsx(u,{label:"Canal",value:s.canal}),e.jsx(u,{label:"Ancho Banda",value:s.anchoBandaEnlace})]})]}),p&&(s.potenciaRx||s.potenciaTx||s.atenuacion)&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-[9px] text-green-400 uppercase tracking-wide font-semibold mb-1.5 flex items-center gap-1",children:[e.jsx(ae,{size:10})," Fibra Óptica"]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-1.5",children:[e.jsx(u,{label:"Pot. Rx",value:s.potenciaRx,unit:"dBm",warn:x.potenciaRx}),e.jsx(u,{label:"Pot. Tx",value:s.potenciaTx,unit:"dBm"}),e.jsx(u,{label:"Atenuación",value:s.atenuacion,unit:"dB",warn:x.atenuacion}),e.jsx(u,{label:"Puerto OLT",value:s.puertoOLT}),e.jsx(u,{label:"Estado ONU",value:s.estadoONU,warn:x.estadoONU})]})]})]})}const C=s=>{const t=Number(s);return isNaN(t)?"0.00":t.toFixed(2)},$=s=>{if(!s)return"—";try{return new Date(s).toLocaleDateString("es-PE",{day:"2-digit",month:"short",year:"numeric"})}catch{return s}},v=s=>{if(!s)return"—";try{return new Date(s).toLocaleDateString("es-PE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return s}};function k({title:s,children:t}){return e.jsxs("div",{className:"bg-bg-card rounded-[14px] p-5 border border-border",children:[e.jsx("h3",{className:"text-[13px] font-semibold text-accent-blue mb-3.5 uppercase tracking-wide",children:s}),t]})}function c({label:s,value:t,mono:n}){return e.jsxs("div",{className:"mb-2.5",children:[e.jsx("span",{className:"text-[11px] text-text-muted block mb-0.5",children:s}),e.jsx("span",{className:`text-[13px] font-medium break-all ${n?"font-mono":""}`,children:t||"—"})]})}function re({active:s,icon:t,label:n,count:r,onClick:p,colorVar:h}){const x=s?{backgroundColor:`${h}22`,color:h}:{},o=s?{backgroundColor:`${h}30`}:{};return e.jsxs("button",{onClick:p,className:`flex items-center gap-2 px-4 py-2.5 rounded-xl text-[12px] font-semibold transition-all cursor-pointer border-none whitespace-nowrap
        ${s?"shadow-sm":"bg-transparent text-text-muted hover:bg-bg-card-hover hover:text-text-primary"}`,style:x,children:[e.jsx(t,{size:14}),n,r>0&&e.jsx("span",{className:`ml-1 px-1.5 py-0.5 rounded-full text-[10px] font-bold min-w-[18px] text-center
          ${s?"":"bg-bg-secondary"}`,style:o,children:r})]})}function i({label:s,value:t}){return!t&&t!==0?null:e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] text-text-muted uppercase tracking-wide",children:s}),e.jsx("span",{className:"text-[12px] text-text-primary font-medium block mt-0.5",children:t})]})}function g({label:s,value:t,color:n}){return t?e.jsxs("div",{className:`rounded-lg p-3 border ${n?`bg-${n}/5 border-${n}/20`:"bg-bg-secondary border-border/50"}`,children:[e.jsx("p",{className:`text-[10px] uppercase tracking-wide font-semibold mb-1 ${n?`text-${n}`:"text-text-muted"}`,children:s}),e.jsx("p",{className:"text-[12px] text-text-secondary leading-relaxed whitespace-pre-wrap",children:t})]}):null}function j({label:s,items:t}){return!t||t.length===0?null:e.jsxs("div",{className:"col-span-2 sm:col-span-3 mt-1",children:[e.jsxs("p",{className:"text-[10px] text-text-muted mb-1.5 flex items-center gap-1",children:[e.jsx(X,{size:10})," ",s," (",t.length,")"]}),e.jsx(Y,{value:t,readOnly:!0,max:10})]})}function R({icon:s,text:t}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-text-muted",children:[e.jsx(s,{size:32,className:"mb-3 opacity-30"}),e.jsx("span",{className:"text-sm",children:t})]})}function S({color:s,icon:t,title:n,subtitle:r,status:p,date:h,children:x}){const[o,m]=b.useState(!1);return e.jsxs("div",{className:"bg-bg-card border border-border rounded-xl overflow-hidden transition-all hover:border-opacity-60",style:{borderLeftWidth:"3px",borderLeftColor:s},children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 cursor-pointer select-none",onClick:()=>m(!o),children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center shrink-0",style:{backgroundColor:`${s}18`},children:e.jsx(t,{size:16,style:{color:s}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[13px] font-bold text-text-primary truncate",children:n}),p&&e.jsx(I,{status:p,size:"sm"})]}),e.jsx("span",{className:"text-[11px] text-text-muted truncate block",children:r})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx("span",{className:"text-[10px] text-text-muted font-mono",children:$(h)}),o?e.jsx(ce,{size:14,className:"text-text-muted"}):e.jsx(te,{size:14,className:"text-text-muted"})]})]}),o&&e.jsx("div",{className:"px-4 pb-4 pt-0 border-t border-border/50 animate-fade",children:e.jsx("div",{className:"mt-3 space-y-3",children:x})})]})}function de({t:s}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-x-4 gap-y-2",children:[e.jsx(i,{label:"ID",value:s.id}),e.jsx(i,{label:"Estado",value:s.estado}),e.jsx(i,{label:"Prioridad",value:s.prioridad}),e.jsx(i,{label:"Tipo Atención",value:s.tipoAtencion||s.tipo}),e.jsx(i,{label:"Categoría",value:s.categoriaNombre}),e.jsx(i,{label:"Subcategoría",value:s.subcategoriaNombre}),e.jsx(i,{label:"Técnico Asignado",value:s.asignado||"Sin asignar"}),e.jsx(i,{label:"Fecha Creación",value:v(s.fecha||s.createdAt)}),e.jsx(i,{label:"Fecha Resolución",value:s.fechaResolucion?v(s.fechaResolucion):null})]}),(s.slaTiempoLimite||s.slaImpacto)&&e.jsxs("div",{className:"bg-accent-yellow/10 rounded-lg p-3 border border-accent-yellow/20",children:[e.jsxs("p",{className:"text-[10px] text-accent-yellow uppercase tracking-wide mb-1.5 font-semibold flex items-center gap-1",children:[e.jsx(V,{size:12})," SLA"]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[s.slaTiempoLimite&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"Tiempo límite: "}),e.jsx("span",{className:"text-accent-yellow font-semibold",children:s.slaTiempoLimite})]}),s.slaImpacto&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"Impacto: "}),e.jsx("span",{className:"text-text-primary font-medium",children:s.slaImpacto})]})]})]}),s.descripcion&&e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50",children:[e.jsxs("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-1.5 flex items-center gap-1",children:[e.jsx(K,{size:12})," Reporte"]}),e.jsx("p",{className:"text-[12px] text-text-primary leading-relaxed whitespace-pre-wrap",children:s.descripcion})]}),e.jsx(j,{label:"Evidencia del Reporte",items:s.adjuntos}),(s.solucion||s.accionesRealizadas||s.adjuntosResolucion?.length>0)&&e.jsxs("div",{className:"bg-green-500/5 border border-green-500/20 rounded-lg p-3",children:[e.jsxs("p",{className:"text-[10px] text-green-400 uppercase tracking-wide mb-2 font-semibold flex items-center gap-1",children:[e.jsx(B,{size:12})," Resolución"]}),s.solucion&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Solución:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:s.solucion})]}),s.accionesRealizadas&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Acciones Realizadas:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:s.accionesRealizadas})]}),e.jsx(j,{label:"Evidencia de Resolución",items:s.adjuntosResolucion})]}),(s.motivoReprogramacion||s.adjuntosReprogramacion?.length>0)&&e.jsxs("div",{className:"bg-orange-500/5 border border-orange-500/20 rounded-lg p-3",children:[e.jsxs("p",{className:"text-[10px] text-orange-400 uppercase tracking-wide mb-2 font-semibold flex items-center gap-1",children:[e.jsx(V,{size:12})," Reprogramación"]}),s.motivoReprogramacion&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Motivo:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:s.motivoReprogramacion})]}),s.fechaReprogramacion&&e.jsx(i,{label:"Nueva Fecha",value:v(s.fechaReprogramacion)}),e.jsx(j,{label:"Evidencia de Reprogramación",items:s.adjuntosReprogramacion})]}),s.historial&&s.historial.length>0&&e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50",children:[e.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide mb-2 font-semibold",children:"Historial de Cambios"}),e.jsx("div",{className:"space-y-1.5",children:[...s.historial].reverse().map((t,n)=>e.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[e.jsx("span",{className:`w-2 h-2 rounded-full shrink-0 ${t.estadoNuevo==="Abierto"?"bg-red-400":t.estadoNuevo==="En Proceso"?"bg-yellow-400":t.estadoNuevo.startsWith("Escalado")?"bg-orange-400":t.estadoNuevo==="Resuelto"?"bg-green-400":"bg-gray-400"}`}),e.jsx("span",{className:"text-text-primary font-medium",children:t.estadoNuevo}),e.jsx("span",{className:"text-text-muted",children:"—"}),e.jsx("span",{className:"text-text-muted truncate",children:t.motivo||"Sin motivo"}),e.jsx("span",{className:"text-text-muted font-mono text-[9px] ml-auto shrink-0",children:$(t.fecha)})]},n))})]})]})}function xe({s,ticket:t}){const n=s.diagnosticos,r=(s.tecnologia||"").toLowerCase();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-x-4 gap-y-2",children:[e.jsx(i,{label:"ID",value:s.id}),e.jsx(i,{label:"Estado",value:s.estado}),e.jsx(i,{label:"Ticket Asociado",value:s.ticketId}),e.jsx(i,{label:"Tipo",value:s.tipo}),e.jsx(i,{label:"Técnico",value:s.tecnicoNombre||s.tecnico||t?.asignado}),e.jsx(i,{label:"Fecha",value:v(s.fecha)}),e.jsx(i,{label:"Hora Inicio",value:s.horaInicio}),e.jsx(i,{label:"Hora Fin",value:s.horaFin}),e.jsx(i,{label:"IP",value:s.ip}),e.jsx(i,{label:"Herramienta",value:s.herramienta}),e.jsx(i,{label:"Duración",value:s.duracion?`${s.duracion} min`:null}),e.jsx(i,{label:"Tecnología",value:s.tecnologia})]}),e.jsx(g,{label:"Descripción",value:s.descripcion}),e.jsx(g,{label:"Resultado / Observaciones",value:s.resultado||s.observaciones,color:"green-400"}),(s.solucion||s.accionesRealizadas||s.adjuntosResolucion?.length>0)&&e.jsxs("div",{className:"bg-green-500/5 border border-green-500/20 rounded-lg p-3",children:[e.jsxs("p",{className:"text-[10px] text-green-400 uppercase tracking-wide mb-2 font-semibold flex items-center gap-1",children:[e.jsx(B,{size:12})," Resolución"]}),s.solucion&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Solución:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:s.solucion})]}),s.accionesRealizadas&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Acciones:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:s.accionesRealizadas})]}),e.jsx(j,{label:"Evidencia de Resolución",items:s.adjuntosResolucion})]}),e.jsx(q,{data:n,type:r}),e.jsx(j,{label:"Evidencia Inicial",items:s.adjuntos})]})}function me({v:s,ticket:t,clientDir:n}){const r=s.diagnosticos,p=(s.tecnologia||"").toLowerCase();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-x-4 gap-y-2",children:[e.jsx(i,{label:"ID",value:s.id}),e.jsx(i,{label:"Estado",value:s.estado}),e.jsx(i,{label:"Ticket Asociado",value:s.ticketId}),e.jsx(i,{label:"Tipo",value:s.tipo}),e.jsx(i,{label:"Prioridad",value:s.prioridad}),e.jsx(i,{label:"Técnico",value:s.tecnicoNombre||s.tecnico||t?.asignado}),e.jsx(i,{label:"Fecha",value:v(s.fecha)}),e.jsx(i,{label:"Hora Inicio",value:s.horaInicio}),e.jsx(i,{label:"Hora Fin",value:s.horaFin})]}),(s.direccion||n)&&e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50",children:[e.jsx("p",{className:"text-[10px] text-text-muted uppercase mb-0.5",children:"Dirección"}),e.jsxs("p",{className:"text-[12px] font-medium flex items-center gap-1",children:[e.jsx(ie,{size:12,className:"text-text-muted"}),s.direccion||n]})]}),e.jsx(g,{label:"Descripción",value:s.descripcion}),e.jsx(g,{label:"Resultado / Observaciones",value:s.resultado||s.observaciones,color:"green-400"}),(s.solucion||s.accionesRealizadas||s.adjuntosResolucion?.length>0)&&e.jsxs("div",{className:"bg-green-500/5 border border-green-500/20 rounded-lg p-3",children:[e.jsxs("p",{className:"text-[10px] text-green-400 uppercase tracking-wide mb-2 font-semibold flex items-center gap-1",children:[e.jsx(B,{size:12})," Resolución"]}),s.solucion&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Solución:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:s.solucion})]}),s.accionesRealizadas&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Acciones:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:s.accionesRealizadas})]}),e.jsx(j,{label:"Evidencia de Resolución",items:s.adjuntosResolucion})]}),e.jsx(q,{data:r,type:p}),e.jsx(j,{label:"Evidencia Inicial",items:s.adjuntos})]})}function ue({p:s}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-x-4 gap-y-2",children:[e.jsx(i,{label:"ID",value:s.id}),e.jsx(i,{label:"Estado",value:s.estado}),e.jsx(i,{label:"Tipo Servicio",value:s.tipoServicio}),e.jsx(i,{label:"Técnico",value:s.tecnicoNombre||"Sin asignar"}),e.jsx(i,{label:"Fecha Creación",value:$(s.fecha)}),e.jsx(i,{label:"Fecha Ejecución",value:$(s.fechaEjecucion)}),e.jsx(i,{label:"Costo Estimado",value:s.costoEstimado?`S/. ${C(s.costoEstimado)}`:null}),e.jsx(i,{label:"Costo Real",value:s.costoReal?`S/. ${C(s.costoReal)}`:null})]}),e.jsx(g,{label:"Descripción",value:s.descripcion}),e.jsx(g,{label:"Observaciones",value:s.observaciones}),e.jsx(j,{label:"Evidencia",items:s.adjuntos})]})}function pe({a:s}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-x-4 gap-y-2",children:[e.jsx(i,{label:"ID",value:s.id}),e.jsx(i,{label:"Estado",value:s.estado}),e.jsx(i,{label:"Ticket Asociado",value:s.ticketId}),e.jsx(i,{label:"Tipo",value:s.tipo}),e.jsx(i,{label:"Zona Afectada",value:s.zona}),e.jsx(i,{label:"Técnico",value:s.tecnicoNombre||s.tecnico}),e.jsx(i,{label:"Fecha Reporte",value:v(s.fecha)}),e.jsx(i,{label:"Fecha Resolución",value:s.fechaResolucion?v(s.fechaResolucion):null}),e.jsx(i,{label:"Clientes Afectados",value:s.clientesAfectados})]}),e.jsx(g,{label:"Descripción",value:s.descripcion}),e.jsx(g,{label:"Solución",value:s.solucion,color:"green-400"}),e.jsx(g,{label:"Observaciones",value:s.observaciones}),e.jsx(j,{label:"Evidencia",items:s.adjuntos}),e.jsx(j,{label:"Evidencia de Resolución",items:s.adjuntosResolucion})]})}function be({c:s}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:[e.jsx(i,{label:"ID del Log",value:s.id}),e.jsx(i,{label:"Fecha de Modificación",value:v(s.fecha)}),e.jsx(i,{label:"Origen",value:s.origen}),e.jsx(i,{label:"Archivo",value:s.archivo})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50",children:[e.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-2",children:"Columnas Modificadas"}),e.jsx("div",{className:"flex flex-col gap-2",children:s.cambios?.map((t,n)=>e.jsxs("div",{className:"text-[12px] flex flex-wrap items-center gap-2 bg-bg-card p-2 rounded-md border border-border/50",children:[e.jsxs("span",{className:"font-semibold text-text-secondary min-w-[120px]",children:[t.field,":"]}),e.jsx("span",{className:"line-through text-text-muted bg-red-500/10 px-1.5 rounded",children:t.old}),e.jsx("span",{className:"text-text-muted",children:"→"}),e.jsx("span",{className:"text-text-primary font-medium bg-green-500/10 px-1.5 rounded",children:t.new})]},n))})]})]})}function ze(){const{id:s}=J(),t=Q(),n=N(a=>a.clients),r=N(a=>a.tickets),p=N(a=>a.visitas),h=N(a=>a.sesionesRemoto),x=N(a=>a.postVenta),o=N(a=>a.averias),m=N(a=>a.clientChanges)||[],[f,W]=b.useState("tickets"),l=n.find(a=>a.id===s);b.useEffect(()=>{!l&&n.length>0&&t("/clientes")},[l,n,t]);const w=b.useMemo(()=>r.filter(a=>a.clienteId===s).sort((a,d)=>new Date(d.fecha||d.createdAt||0)-new Date(a.fecha||a.createdAt||0)),[r,s]),y=b.useMemo(()=>new Set(w.map(a=>a.id)),[w]),D=b.useMemo(()=>p.filter(a=>y.has(a.ticketId)).sort((a,d)=>new Date(d.fecha||0)-new Date(a.fecha||0)),[p,y]),T=b.useMemo(()=>h.filter(a=>y.has(a.ticketId)).sort((a,d)=>new Date(d.fecha||0)-new Date(a.fecha||0)),[h,y]),E=b.useMemo(()=>x.filter(a=>a.clienteId===s).sort((a,d)=>new Date(d.fecha||0)-new Date(a.fecha||0)),[x,s]),F=b.useMemo(()=>o.filter(a=>y.has(a.ticketId)).sort((a,d)=>new Date(d.fecha||0)-new Date(a.fecha||0)),[o,y]),z=b.useMemo(()=>m.filter(a=>a.clientId===s).sort((a,d)=>new Date(d.fecha||0)-new Date(a.fecha||0)),[m,s]);if(!l)return e.jsx("div",{className:"p-8 text-center text-text-muted",children:"Cargando cliente o no encontrado..."});const Z=[{key:"tickets",label:"Tickets",icon:_,count:w.length,color:"#3b82f6"},{key:"soporte",label:"Soporte Remoto",icon:O,count:T.length,color:"#06b6d4"},{key:"visitas",label:"Visitas Técnicas",icon:M,count:D.length,color:"#f97316"},{key:"postventa",label:"Post-Venta",icon:L,count:E.length,color:"#a855f7"},{key:"averias",label:"Averías",icon:A,count:F.length,color:"#ef4444"},{key:"cambios",label:"Cambios",icon:H,count:z.length,color:"#8b5cf6"}],G=w.length+T.length+D.length+E.length+F.length+z.length;return e.jsxs("div",{className:"animate-fade p-4 sm:p-6 sm:px-8 h-full overflow-y-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>t("/clientes"),className:"bg-bg-card border border-border rounded-[10px] py-2 px-4 text-text-primary cursor-pointer text-[13px] font-medium hover:border-accent-blue transition-colors flex items-center justify-center sm:justify-start gap-2 w-full sm:w-auto",children:[e.jsx(oe,{size:14})," Volver"]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-[22px] font-bold truncate",children:l.nombre}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-1.5",children:[e.jsx(I,{status:l.estado_cuenta,size:"md"}),e.jsx(I,{status:l.status,size:"md"}),e.jsx(I,{status:l.tecnologia,size:"md"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsxs(k,{title:"Datos Personales",children:[e.jsx(c,{label:"ID Cliente",value:l.id,mono:!0}),e.jsx(c,{label:"Código",value:l.codigo,mono:!0}),e.jsx(c,{label:"DNI",value:l.dni,mono:!0}),e.jsx(c,{label:"Móvil 1",value:l.movil_1,mono:!0}),l.movil_2&&e.jsx(c,{label:"Móvil 2",value:l.movil_2,mono:!0}),e.jsx(c,{label:"Email",value:l.email||"No registrado"}),e.jsx(c,{label:"Zona",value:l.zona})]}),e.jsxs(k,{title:"Ubicación",children:[e.jsx(c,{label:"Dirección Principal",value:l.direccion}),e.jsx(c,{label:"Dirección Servicio",value:l.direccion_servicio}),e.jsx(c,{label:"Tipo Estrato",value:l.tipo_estrato})]}),e.jsxs(k,{title:"Servicio Contratado",children:[e.jsx(c,{label:"Plan",value:l.plan}),e.jsx(c,{label:"Precio",value:`S/. ${C(l.precio)}`,mono:!0}),e.jsx(c,{label:"Tecnología",value:l.tecnologia}),e.jsx(c,{label:"Nodo / Router",value:l.nodo_router}),e.jsx(c,{label:"Fecha Instalación",value:l.fecha_instalacion}),e.jsx(c,{label:"Estado Servicio",value:l.estado_servicio})]}),e.jsxs(k,{title:"Conexión Técnica",children:[e.jsx(c,{label:"IP Asignada",value:l.ip,mono:!0}),e.jsx(c,{label:"IP Receptor",value:l.ip_receptor,mono:!0}),e.jsx(c,{label:"MAC Address",value:l.mac,mono:!0}),e.jsx(c,{label:"User PPP",value:l.user_ppp,mono:!0})]}),e.jsxs(k,{title:"Facturación",children:[e.jsx(c,{label:"Día de Pago",value:l.dia_pago}),e.jsx(c,{label:"Próximo Pago",value:l.proximo_pago}),e.jsx(c,{label:"Último Pago",value:l.ultimo_pago}),e.jsx(c,{label:"Deuda",value:l.deuda_monto>0?`${l.deuda_meses} mes(es) — S/. ${C(l.deuda_monto)}`:"Sin deuda"}),e.jsx(c,{label:"Saldo",value:l.saldo,mono:!0})]}),e.jsxs(k,{title:"Notas Técnicas / Servicios TV",children:[e.jsx(c,{label:"Notas del Equipo",value:l.notas_tecnicas}),l.servicios_adicionales?.length>0?e.jsxs("div",{children:[e.jsx("span",{className:"text-[11px] text-text-muted block mb-1.5",children:"Servicios Adicionales"}),l.servicios_adicionales?.map((a,d)=>e.jsxs("div",{className:"flex justify-between py-1 px-2.5 bg-bg-secondary rounded-md mb-1 text-xs",children:[e.jsx("span",{children:a.tipo}),e.jsxs("span",{className:"font-mono text-accent-cyan",children:["S/. ",C(a.precio)]})]},d))]}):e.jsx(c,{label:"Servicios Adicionales",value:"Ninguno"})]})]}),e.jsxs("div",{className:"bg-bg-card rounded-2xl border border-border overflow-hidden",children:[e.jsxs("div",{className:"p-5 border-b border-border",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-[16px] font-bold text-text-primary flex items-center gap-2",children:[e.jsx(V,{size:18,className:"text-accent-blue"}),"Historial del Cliente"]}),e.jsxs("p",{className:"text-[12px] text-text-muted mt-1",children:[G," registros en total"]})]})}),e.jsx("div",{className:"flex gap-1.5 mt-4 overflow-x-auto pb-1",children:Z.map(a=>e.jsx(re,{active:f===a.key,icon:a.icon,label:a.label,count:a.count,colorVar:a.color,onClick:()=>W(a.key)},a.key))})]}),e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex flex-col gap-3 max-h-[600px] overflow-y-auto pr-1",children:[f==="tickets"&&(w.length===0?e.jsx(R,{icon:_,text:"No hay tickets registrados para este cliente"}):w.map(a=>e.jsx(S,{color:"#3b82f6",icon:_,title:`${a.id} — ${a.categoriaNombre||a.tipo||"Ticket"}`,subtitle:a.descripcion?.substring(0,100)||"Sin descripción",status:a.estado,date:a.fecha||a.createdAt,children:e.jsx(de,{t:a})},a.id))),f==="soporte"&&(T.length===0?e.jsx(R,{icon:O,text:"No hay sesiones de soporte remoto registradas"}):T.map(a=>{const d=r.find(P=>P.id===a.ticketId);return e.jsx(S,{color:"#06b6d4",icon:O,title:`${a.id} — Soporte Remoto`,subtitle:`Ticket: ${a.ticketId} • ${a.descripcion?.substring(0,80)||""}`,status:a.estado,date:a.fecha,children:e.jsx(xe,{s:a,ticket:d})},a.id)})),f==="visitas"&&(D.length===0?e.jsx(R,{icon:M,text:"No hay visitas técnicas registradas"}):D.map(a=>{const d=r.find(P=>P.id===a.ticketId);return e.jsx(S,{color:"#f97316",icon:M,title:`${a.id} — Visita Técnica`,subtitle:`Ticket: ${a.ticketId} • ${a.descripcion?.substring(0,80)||""}`,status:a.estado,date:a.fecha,children:e.jsx(me,{v:a,ticket:d,clientDir:l.direccion})},a.id)})),f==="postventa"&&(E.length===0?e.jsx(R,{icon:L,text:"No hay registros de post-venta"}):E.map(a=>e.jsx(S,{color:"#a855f7",icon:L,title:`${a.id} — ${a.tipoServicio||"Post-Venta"}`,subtitle:a.descripcion?.substring(0,100)||"Sin descripción",status:a.estado,date:a.fecha,children:e.jsx(ue,{p:a})},a.id))),f==="averias"&&(F.length===0?e.jsx(R,{icon:A,text:"No hay averías registradas"}):F.map(a=>e.jsx(S,{color:"#ef4444",icon:A,title:`${a.id} — ${a.tipo||"Avería"}`,subtitle:a.descripcion?.substring(0,100)||"Sin descripción",status:a.estado,date:a.fecha,children:e.jsx(pe,{a})},a.id))),f==="cambios"&&(z.length===0?e.jsx(R,{icon:H,text:"No hay un historial de importaciones para este cliente"}):z.map(a=>e.jsx(S,{color:"#8b5cf6",icon:H,title:`${a.origen} de Datos`,subtitle:`Archivo Analizado: "${a.archivo}" • ${a.cambios?.length||0} campos actualizados`,status:null,date:a.fecha,children:e.jsx(be,{c:a})},a.id)))]})})]})]})}export{ze as default};
