import{c as B,d as Z,b as J,a as R,r as v,j as e,e as $,f as L,S as _,T as E,F as Q}from"./index-V83AbEuR.js";import{S as A}from"./StatusBadge-C5JaseRJ.js";import{P as K,A as X}from"./Adjuntos-qr9JvWqU.js";import{M as O}from"./monitor-D8TeqI_1.js";import{C as M}from"./clock-BcrEkKiu.js";import{C as Y}from"./chevron-down-HZgiKv4u.js";import{C as U}from"./circle-check-DXlsREZ5.js";import{G as q}from"./gauge-B_OrYeBF.js";import{R as H}from"./radio-CURvrPYI.js";import{Z as V}from"./zap-BdC3W5Dd.js";import{M as ee}from"./map-pin-zndqH9Q6.js";import"./upload-9W-s6c71.js";import"./eye-Bp1lVLpy.js";import"./download-BiXjc8xp.js";import"./chevron-right-D7LOZO49.js";const ae=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],se=B("arrow-left",ae);const te=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ie=B("chevron-up",te),S=a=>{const n=Number(a);return isNaN(n)?"0.00":n.toFixed(2)},P=a=>{if(!a)return"—";try{return new Date(a).toLocaleDateString("es-PE",{day:"2-digit",month:"short",year:"numeric"})}catch{return a}},N=a=>{if(!a)return"—";try{return new Date(a).toLocaleDateString("es-PE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return a}};function y({title:a,children:n}){return e.jsxs("div",{className:"bg-bg-card rounded-[14px] p-5 border border-border",children:[e.jsx("h3",{className:"text-[13px] font-semibold text-accent-blue mb-3.5 uppercase tracking-wide",children:a}),n]})}function r({label:a,value:n,mono:i}){return e.jsxs("div",{className:"mb-2.5",children:[e.jsx("span",{className:"text-[11px] text-text-muted block mb-0.5",children:a}),e.jsx("span",{className:`text-[13px] font-medium break-all ${i?"font-mono":""}`,children:n||"—"})]})}function le({active:a,icon:n,label:i,count:c,onClick:b,colorVar:m}){const g=a?{backgroundColor:`${m}22`,color:m}:{},j=a?{backgroundColor:`${m}30`}:{};return e.jsxs("button",{onClick:b,className:`flex items-center gap-2 px-4 py-2.5 rounded-xl text-[12px] font-semibold transition-all cursor-pointer border-none whitespace-nowrap
        ${a?"shadow-sm":"bg-transparent text-text-muted hover:bg-bg-card-hover hover:text-text-primary"}`,style:g,children:[e.jsx(n,{size:14}),i,c>0&&e.jsx("span",{className:`ml-1 px-1.5 py-0.5 rounded-full text-[10px] font-bold min-w-[18px] text-center
          ${a?"":"bg-bg-secondary"}`,style:j,children:c})]})}function l({label:a,value:n}){return!n&&n!==0?null:e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] text-text-muted uppercase tracking-wide",children:a}),e.jsx("span",{className:"text-[12px] text-text-primary font-medium block mt-0.5",children:n})]})}function f({label:a,value:n,color:i}){return n?e.jsxs("div",{className:`rounded-lg p-3 border ${i?`bg-${i}/5 border-${i}/20`:"bg-bg-secondary border-border/50"}`,children:[e.jsx("p",{className:`text-[10px] uppercase tracking-wide font-semibold mb-1 ${i?`text-${i}`:"text-text-muted"}`,children:a}),e.jsx("p",{className:"text-[12px] text-text-secondary leading-relaxed whitespace-pre-wrap",children:n})]}):null}function h({label:a,items:n}){return!n||n.length===0?null:e.jsxs("div",{className:"col-span-2 mt-1",children:[e.jsxs("p",{className:"text-[10px] text-text-muted mb-1.5 flex items-center gap-1",children:[e.jsx(K,{size:10})," ",a," (",n.length,")"]}),e.jsx(X,{value:n,readOnly:!0,max:10})]})}function d({label:a,value:n,unit:i,warn:c}){return n==null||n===""?null:e.jsxs("div",{className:`bg-bg-secondary rounded-lg p-2 border ${c?"border-accent-orange/50":"border-border/50"}`,children:[e.jsx("p",{className:"text-[9px] text-text-muted uppercase tracking-wide font-semibold mb-0.5",children:a}),e.jsxs("p",{className:`text-[11px] font-mono font-semibold ${c?"text-accent-orange":"text-text-primary"}`,children:[n,i?` ${i}`:"",c&&e.jsx(E,{size:10,className:"inline ml-1 text-accent-orange"})]})]})}function k({icon:a,text:n}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-text-muted",children:[e.jsx(a,{size:32,className:"mb-3 opacity-30"}),e.jsx("span",{className:"text-sm",children:n})]})}function F({color:a,icon:n,title:i,subtitle:c,status:b,date:m,children:g}){const[j,x]=v.useState(!1);return e.jsxs("div",{className:"bg-bg-card border border-border rounded-xl overflow-hidden transition-all hover:border-opacity-60",style:{borderLeftWidth:"3px",borderLeftColor:a},children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 cursor-pointer select-none",onClick:()=>x(!j),children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center shrink-0",style:{backgroundColor:`${a}18`},children:e.jsx(n,{size:16,style:{color:a}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[13px] font-bold text-text-primary truncate",children:i}),b&&e.jsx(A,{status:b,size:"sm"})]}),e.jsx("span",{className:"text-[11px] text-text-muted truncate block",children:c})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx("span",{className:"text-[10px] text-text-muted font-mono",children:P(m)}),j?e.jsx(ie,{size:14,className:"text-text-muted"}):e.jsx(Y,{size:14,className:"text-text-muted"})]})]}),j&&e.jsx("div",{className:"px-4 pb-4 pt-0 border-t border-border/50 animate-fade",children:e.jsx("div",{className:"mt-3 space-y-3",children:g})})]})}function ne({t:a}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-x-4 gap-y-2",children:[e.jsx(l,{label:"ID",value:a.id}),e.jsx(l,{label:"Estado",value:a.estado}),e.jsx(l,{label:"Prioridad",value:a.prioridad}),e.jsx(l,{label:"Tipo Atención",value:a.tipoAtencion||a.tipo}),e.jsx(l,{label:"Categoría",value:a.categoriaNombre}),e.jsx(l,{label:"Subcategoría",value:a.subcategoriaNombre}),e.jsx(l,{label:"Técnico Asignado",value:a.asignado||"Sin asignar"}),e.jsx(l,{label:"Fecha Creación",value:N(a.fecha||a.createdAt)}),e.jsx(l,{label:"Fecha Resolución",value:a.fechaResolucion?N(a.fechaResolucion):null})]}),(a.slaTiempoLimite||a.slaImpacto)&&e.jsxs("div",{className:"bg-accent-yellow/10 rounded-lg p-3 border border-accent-yellow/20",children:[e.jsxs("p",{className:"text-[10px] text-accent-yellow uppercase tracking-wide mb-1.5 font-semibold flex items-center gap-1",children:[e.jsx(M,{size:12})," SLA"]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[a.slaTiempoLimite&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"Tiempo límite: "}),e.jsx("span",{className:"text-accent-yellow font-semibold",children:a.slaTiempoLimite})]}),a.slaImpacto&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"Impacto: "}),e.jsx("span",{className:"text-text-primary font-medium",children:a.slaImpacto})]})]})]}),a.descripcion&&e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50",children:[e.jsxs("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-1.5 flex items-center gap-1",children:[e.jsx(Q,{size:12})," Reporte"]}),e.jsx("p",{className:"text-[12px] text-text-primary leading-relaxed whitespace-pre-wrap",children:a.descripcion})]}),e.jsx(h,{label:"Evidencia del Reporte",items:a.adjuntos}),(a.solucion||a.accionesRealizadas||a.adjuntosResolucion?.length>0)&&e.jsxs("div",{className:"bg-green-500/5 border border-green-500/20 rounded-lg p-3",children:[e.jsxs("p",{className:"text-[10px] text-green-400 uppercase tracking-wide mb-2 font-semibold flex items-center gap-1",children:[e.jsx(U,{size:12})," Resolución"]}),a.solucion&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Solución:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:a.solucion})]}),a.accionesRealizadas&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Acciones Realizadas:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:a.accionesRealizadas})]}),e.jsx(h,{label:"Evidencia de Resolución",items:a.adjuntosResolucion})]}),(a.motivoReprogramacion||a.adjuntosReprogramacion?.length>0)&&e.jsxs("div",{className:"bg-orange-500/5 border border-orange-500/20 rounded-lg p-3",children:[e.jsxs("p",{className:"text-[10px] text-orange-400 uppercase tracking-wide mb-2 font-semibold flex items-center gap-1",children:[e.jsx(M,{size:12})," Reprogramación"]}),a.motivoReprogramacion&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Motivo:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:a.motivoReprogramacion})]}),a.fechaReprogramacion&&e.jsx(l,{label:"Nueva Fecha",value:N(a.fechaReprogramacion)}),e.jsx(h,{label:"Evidencia de Reprogramación",items:a.adjuntosReprogramacion})]}),a.historial&&a.historial.length>0&&e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50",children:[e.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide mb-2 font-semibold",children:"Historial de Cambios"}),e.jsx("div",{className:"space-y-1.5",children:[...a.historial].reverse().map((n,i)=>e.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[e.jsx("span",{className:`w-2 h-2 rounded-full shrink-0 ${n.estadoNuevo==="Abierto"?"bg-red-400":n.estadoNuevo==="En Proceso"?"bg-yellow-400":n.estadoNuevo.startsWith("Escalado")?"bg-orange-400":n.estadoNuevo==="Resuelto"?"bg-green-400":"bg-gray-400"}`}),e.jsx("span",{className:"text-text-primary font-medium",children:n.estadoNuevo}),e.jsx("span",{className:"text-text-muted",children:"—"}),e.jsx("span",{className:"text-text-muted truncate",children:n.motivo||"Sin motivo"}),e.jsx("span",{className:"text-text-muted font-mono text-[9px] ml-auto shrink-0",children:P(n.fecha)})]},i))})]})]})}function oe({s:a,ticket:n}){const i=a.diagnosticos,c=i&&Object.values(i).some(o=>o!==""&&o!==null&&o!==void 0),b=(a.tecnologia||"").toLowerCase(),m=b.includes("radio"),g=b.includes("fibra"),x=(o=>{if(!o)return{};const t={};return o.ping&&parseFloat(o.ping)>80&&(t.ping=!0),o.download&&parseFloat(o.download)<10&&(t.download=!0),o.upload&&parseFloat(o.upload)<5&&(t.upload=!0),o.packetLoss&&parseFloat(o.packetLoss)>2&&(t.packetLoss=!0),o.jitter&&parseFloat(o.jitter)>15&&(t.jitter=!0),o.senalRecibida&&parseFloat(o.senalRecibida)<-75&&(t.senalRecibida=!0),o.ccq&&parseFloat(o.ccq)<85&&(t.ccq=!0),o.potenciaRx&&parseFloat(o.potenciaRx)<-25&&(t.potenciaRx=!0),o.atenuacion&&parseFloat(o.atenuacion)>28&&(t.atenuacion=!0),o.estadoONU&&o.estadoONU!=="Online"&&(t.estadoONU=!0),t})(i);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-x-4 gap-y-2",children:[e.jsx(l,{label:"ID",value:a.id}),e.jsx(l,{label:"Estado",value:a.estado}),e.jsx(l,{label:"Ticket Asociado",value:a.ticketId}),e.jsx(l,{label:"Tipo",value:a.tipo}),e.jsx(l,{label:"Técnico",value:a.tecnicoNombre||a.tecnico||n?.asignado}),e.jsx(l,{label:"Fecha",value:N(a.fecha)}),e.jsx(l,{label:"Hora Inicio",value:a.horaInicio}),e.jsx(l,{label:"Hora Fin",value:a.horaFin}),e.jsx(l,{label:"IP",value:a.ip}),e.jsx(l,{label:"Herramienta",value:a.herramienta}),e.jsx(l,{label:"Duración",value:a.duracion?`${a.duracion} min`:null}),e.jsx(l,{label:"Tecnología",value:a.tecnologia})]}),e.jsx(f,{label:"Descripción",value:a.descripcion}),e.jsx(f,{label:"Resultado / Observaciones",value:a.resultado||a.observaciones,color:"green-400"}),(a.solucion||a.accionesRealizadas||a.adjuntosResolucion?.length>0)&&e.jsxs("div",{className:"bg-green-500/5 border border-green-500/20 rounded-lg p-3",children:[e.jsxs("p",{className:"text-[10px] text-green-400 uppercase tracking-wide mb-2 font-semibold flex items-center gap-1",children:[e.jsx(U,{size:12})," Resolución"]}),a.solucion&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Solución:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:a.solucion})]}),a.accionesRealizadas&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Acciones:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:a.accionesRealizadas})]}),e.jsx(h,{label:"Evidencia de Resolución",items:a.adjuntosResolucion})]}),c&&e.jsxs("div",{className:"border-t border-border pt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(q,{size:14,className:"text-accent-cyan"}),e.jsx("h4",{className:"text-[11px] font-bold text-text-primary uppercase",children:"Diagnóstico de Red"})]}),(i.ping||i.download||i.upload||i.packetLoss||i.jitter)&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-[9px] text-text-muted uppercase tracking-wide font-semibold mb-1.5",children:"Parámetros generales"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[e.jsx(d,{label:"Ping",value:i.ping,unit:"ms",warn:x.ping}),e.jsx(d,{label:"Download",value:i.download,unit:"Mbps",warn:x.download}),e.jsx(d,{label:"Upload",value:i.upload,unit:"Mbps",warn:x.upload}),e.jsx(d,{label:"Packet Loss",value:i.packetLoss,unit:"%",warn:x.packetLoss}),e.jsx(d,{label:"Jitter",value:i.jitter,unit:"ms",warn:x.jitter})]})]}),m&&(i.senalRecibida||i.noiseFloor||i.ccq||i.frecuencia)&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-[9px] text-accent-purple uppercase tracking-wide font-semibold mb-1.5 flex items-center gap-1",children:[e.jsx(H,{size:10})," Radio Enlace"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[e.jsx(d,{label:"Señal",value:i.senalRecibida,unit:"dBm",warn:x.senalRecibida}),e.jsx(d,{label:"Noise Floor",value:i.noiseFloor,unit:"dBm"}),e.jsx(d,{label:"CCQ",value:i.ccq,unit:"%",warn:x.ccq}),e.jsx(d,{label:"Frecuencia",value:i.frecuencia,unit:"GHz"}),e.jsx(d,{label:"Canal",value:i.canal}),e.jsx(d,{label:"Ancho Banda",value:i.anchoBandaEnlace})]})]}),g&&(i.potenciaRx||i.potenciaTx||i.atenuacion)&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-[9px] text-green-400 uppercase tracking-wide font-semibold mb-1.5 flex items-center gap-1",children:[e.jsx(V,{size:10})," Fibra Óptica"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[e.jsx(d,{label:"Pot. Rx",value:i.potenciaRx,unit:"dBm",warn:x.potenciaRx}),e.jsx(d,{label:"Pot. Tx",value:i.potenciaTx,unit:"dBm"}),e.jsx(d,{label:"Atenuación",value:i.atenuacion,unit:"dB",warn:x.atenuacion}),e.jsx(d,{label:"Puerto OLT",value:i.puertoOLT}),e.jsx(d,{label:"Estado ONU",value:i.estadoONU,warn:x.estadoONU})]})]})]}),e.jsx(h,{label:"Evidencia Inicial",items:a.adjuntos})]})}function ce({v:a,ticket:n,clientDir:i}){const c=a.diagnosticos,b=c&&Object.values(c).some(t=>t!==""&&t!==null&&t!==void 0),m=(a.tecnologia||"").toLowerCase(),g=m.includes("radio"),j=m.includes("fibra"),o=(t=>{if(!t)return{};const u={};return t.ping&&parseFloat(t.ping)>80&&(u.ping=!0),t.download&&parseFloat(t.download)<10&&(u.download=!0),t.upload&&parseFloat(t.upload)<5&&(u.upload=!0),t.packetLoss&&parseFloat(t.packetLoss)>2&&(u.packetLoss=!0),t.jitter&&parseFloat(t.jitter)>15&&(u.jitter=!0),t.senalRecibida&&parseFloat(t.senalRecibida)<-75&&(u.senalRecibida=!0),t.ccq&&parseFloat(t.ccq)<85&&(u.ccq=!0),t.potenciaRx&&parseFloat(t.potenciaRx)<-25&&(u.potenciaRx=!0),t.atenuacion&&parseFloat(t.atenuacion)>28&&(u.atenuacion=!0),t.estadoONU&&t.estadoONU!=="Online"&&(u.estadoONU=!0),u})(c);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-x-4 gap-y-2",children:[e.jsx(l,{label:"ID",value:a.id}),e.jsx(l,{label:"Estado",value:a.estado}),e.jsx(l,{label:"Ticket Asociado",value:a.ticketId}),e.jsx(l,{label:"Tipo",value:a.tipo}),e.jsx(l,{label:"Prioridad",value:a.prioridad}),e.jsx(l,{label:"Técnico",value:a.tecnicoNombre||a.tecnico||n?.asignado}),e.jsx(l,{label:"Fecha",value:N(a.fecha)}),e.jsx(l,{label:"Hora Inicio",value:a.horaInicio}),e.jsx(l,{label:"Hora Fin",value:a.horaFin})]}),(a.direccion||i)&&e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50",children:[e.jsx("p",{className:"text-[10px] text-text-muted uppercase mb-0.5",children:"Dirección"}),e.jsxs("p",{className:"text-[12px] font-medium flex items-center gap-1",children:[e.jsx(ee,{size:12,className:"text-text-muted"}),a.direccion||i]})]}),e.jsx(f,{label:"Descripción",value:a.descripcion}),e.jsx(f,{label:"Resultado / Observaciones",value:a.resultado||a.observaciones,color:"green-400"}),(a.solucion||a.accionesRealizadas||a.adjuntosResolucion?.length>0)&&e.jsxs("div",{className:"bg-green-500/5 border border-green-500/20 rounded-lg p-3",children:[e.jsxs("p",{className:"text-[10px] text-green-400 uppercase tracking-wide mb-2 font-semibold flex items-center gap-1",children:[e.jsx(U,{size:12})," Resolución"]}),a.solucion&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Solución:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:a.solucion})]}),a.accionesRealizadas&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Acciones:"}),e.jsx("p",{className:"text-[12px] text-text-secondary whitespace-pre-wrap",children:a.accionesRealizadas})]}),e.jsx(h,{label:"Evidencia de Resolución",items:a.adjuntosResolucion})]}),b&&e.jsxs("div",{className:"border-t border-border pt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(q,{size:14,className:"text-accent-cyan"}),e.jsx("h4",{className:"text-[11px] font-bold text-text-primary uppercase",children:"Diagnóstico de Red"})]}),(c.ping||c.download||c.upload)&&e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[e.jsx(d,{label:"Ping",value:c.ping,unit:"ms",warn:o.ping}),e.jsx(d,{label:"Download",value:c.download,unit:"Mbps",warn:o.download}),e.jsx(d,{label:"Upload",value:c.upload,unit:"Mbps",warn:o.upload}),e.jsx(d,{label:"Packet Loss",value:c.packetLoss,unit:"%",warn:o.packetLoss}),e.jsx(d,{label:"Jitter",value:c.jitter,unit:"ms",warn:o.jitter})]})}),g&&(c.senalRecibida||c.ccq)&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-[9px] text-accent-purple uppercase font-semibold mb-1.5 flex items-center gap-1",children:[e.jsx(H,{size:10})," Radio"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[e.jsx(d,{label:"Señal",value:c.senalRecibida,unit:"dBm",warn:o.senalRecibida}),e.jsx(d,{label:"CCQ",value:c.ccq,unit:"%",warn:o.ccq}),e.jsx(d,{label:"Frecuencia",value:c.frecuencia,unit:"GHz"})]})]}),j&&(c.potenciaRx||c.atenuacion)&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-[9px] text-green-400 uppercase font-semibold mb-1.5 flex items-center gap-1",children:[e.jsx(V,{size:10})," Fibra"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[e.jsx(d,{label:"Pot. Rx",value:c.potenciaRx,unit:"dBm",warn:o.potenciaRx}),e.jsx(d,{label:"Atenuación",value:c.atenuacion,unit:"dB",warn:o.atenuacion}),e.jsx(d,{label:"Estado ONU",value:c.estadoONU,warn:o.estadoONU})]})]})]}),e.jsx(h,{label:"Evidencia Inicial",items:a.adjuntos})]})}function re({p:a}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-x-4 gap-y-2",children:[e.jsx(l,{label:"ID",value:a.id}),e.jsx(l,{label:"Estado",value:a.estado}),e.jsx(l,{label:"Tipo Servicio",value:a.tipoServicio}),e.jsx(l,{label:"Técnico",value:a.tecnicoNombre||"Sin asignar"}),e.jsx(l,{label:"Fecha Creación",value:P(a.fecha)}),e.jsx(l,{label:"Fecha Ejecución",value:P(a.fechaEjecucion)}),e.jsx(l,{label:"Costo Estimado",value:a.costoEstimado?`S/. ${S(a.costoEstimado)}`:null}),e.jsx(l,{label:"Costo Real",value:a.costoReal?`S/. ${S(a.costoReal)}`:null})]}),e.jsx(f,{label:"Descripción",value:a.descripcion}),e.jsx(f,{label:"Observaciones",value:a.observaciones}),e.jsx(h,{label:"Evidencia",items:a.adjuntos})]})}function de({a}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-x-4 gap-y-2",children:[e.jsx(l,{label:"ID",value:a.id}),e.jsx(l,{label:"Estado",value:a.estado}),e.jsx(l,{label:"Ticket Asociado",value:a.ticketId}),e.jsx(l,{label:"Tipo",value:a.tipo}),e.jsx(l,{label:"Zona Afectada",value:a.zona}),e.jsx(l,{label:"Técnico",value:a.tecnicoNombre||a.tecnico}),e.jsx(l,{label:"Fecha Reporte",value:N(a.fecha)}),e.jsx(l,{label:"Fecha Resolución",value:a.fechaResolucion?N(a.fechaResolucion):null}),e.jsx(l,{label:"Clientes Afectados",value:a.clientesAfectados})]}),e.jsx(f,{label:"Descripción",value:a.descripcion}),e.jsx(f,{label:"Solución",value:a.solucion,color:"green-400"}),e.jsx(f,{label:"Observaciones",value:a.observaciones}),e.jsx(h,{label:"Evidencia",items:a.adjuntos}),e.jsx(h,{label:"Evidencia de Resolución",items:a.adjuntosResolucion})]})}function Fe(){const{id:a}=Z(),n=J(),i=R(s=>s.clients),c=R(s=>s.tickets),b=R(s=>s.visitas),m=R(s=>s.sesionesRemoto),g=R(s=>s.postVenta),j=R(s=>s.averias),[x,o]=v.useState("tickets"),t=i.find(s=>s.id===a);v.useEffect(()=>{!t&&i.length>0&&n("/clientes")},[t,i,n]);const u=v.useMemo(()=>c.filter(s=>s.clienteId===a).sort((s,p)=>new Date(p.fecha||p.createdAt||0)-new Date(s.fecha||s.createdAt||0)),[c,a]),w=v.useMemo(()=>new Set(u.map(s=>s.id)),[u]),D=v.useMemo(()=>b.filter(s=>w.has(s.ticketId)).sort((s,p)=>new Date(p.fecha||0)-new Date(s.fecha||0)),[b,w]),T=v.useMemo(()=>m.filter(s=>w.has(s.ticketId)).sort((s,p)=>new Date(p.fecha||0)-new Date(s.fecha||0)),[m,w]),C=v.useMemo(()=>g.filter(s=>s.clienteId===a).sort((s,p)=>new Date(p.fecha||0)-new Date(s.fecha||0)),[g,a]),z=v.useMemo(()=>j.filter(s=>w.has(s.ticketId)).sort((s,p)=>new Date(p.fecha||0)-new Date(s.fecha||0)),[j,w]);if(!t)return e.jsx("div",{className:"p-8 text-center text-text-muted",children:"Cargando cliente o no encontrado..."});const W=[{key:"tickets",label:"Tickets",icon:$,count:u.length,color:"#3b82f6"},{key:"soporte",label:"Soporte Remoto",icon:O,count:T.length,color:"#06b6d4"},{key:"visitas",label:"Visitas Técnicas",icon:L,count:D.length,color:"#f97316"},{key:"postventa",label:"Post-Venta",icon:_,count:C.length,color:"#a855f7"},{key:"averias",label:"Averías",icon:E,count:z.length,color:"#ef4444"}],G=u.length+T.length+D.length+C.length+z.length;return e.jsxs("div",{className:"animate-fade p-6 px-8 h-full overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>n("/clientes"),className:"bg-bg-card border border-border rounded-[10px] py-2 px-4 text-text-primary cursor-pointer text-[13px] font-medium hover:border-accent-blue transition-colors flex items-center gap-2",children:[e.jsx(se,{size:14})," Volver"]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-[22px] font-bold",children:t.nombre}),e.jsxs("div",{className:"flex gap-2 mt-1.5",children:[e.jsx(A,{status:t.estado_cuenta,size:"md"}),e.jsx(A,{status:t.status,size:"md"}),e.jsx(A,{status:t.tecnologia,size:"md"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsxs(y,{title:"Datos Personales",children:[e.jsx(r,{label:"ID Cliente",value:t.id,mono:!0}),e.jsx(r,{label:"Código",value:t.codigo,mono:!0}),e.jsx(r,{label:"DNI",value:t.dni,mono:!0}),e.jsx(r,{label:"Móvil 1",value:t.movil_1,mono:!0}),t.movil_2&&e.jsx(r,{label:"Móvil 2",value:t.movil_2,mono:!0}),e.jsx(r,{label:"Email",value:t.email||"No registrado"}),e.jsx(r,{label:"Zona",value:t.zona})]}),e.jsxs(y,{title:"Ubicación",children:[e.jsx(r,{label:"Dirección Principal",value:t.direccion}),e.jsx(r,{label:"Dirección Servicio",value:t.direccion_servicio}),e.jsx(r,{label:"Tipo Estrato",value:t.tipo_estrato})]}),e.jsxs(y,{title:"Servicio Contratado",children:[e.jsx(r,{label:"Plan",value:t.plan}),e.jsx(r,{label:"Precio",value:`S/. ${S(t.precio)}`,mono:!0}),e.jsx(r,{label:"Tecnología",value:t.tecnologia}),e.jsx(r,{label:"Nodo / Router",value:t.nodo_router}),e.jsx(r,{label:"Fecha Instalación",value:t.fecha_instalacion}),e.jsx(r,{label:"Estado Servicio",value:t.estado_servicio})]}),e.jsxs(y,{title:"Conexión Técnica",children:[e.jsx(r,{label:"IP Asignada",value:t.ip,mono:!0}),e.jsx(r,{label:"IP Receptor",value:t.ip_receptor,mono:!0}),e.jsx(r,{label:"MAC Address",value:t.mac,mono:!0}),e.jsx(r,{label:"User PPP",value:t.user_ppp,mono:!0})]}),e.jsxs(y,{title:"Facturación",children:[e.jsx(r,{label:"Día de Pago",value:t.dia_pago}),e.jsx(r,{label:"Próximo Pago",value:t.proximo_pago}),e.jsx(r,{label:"Último Pago",value:t.ultimo_pago}),e.jsx(r,{label:"Deuda",value:t.deuda_monto>0?`${t.deuda_meses} mes(es) — S/. ${S(t.deuda_monto)}`:"Sin deuda"}),e.jsx(r,{label:"Saldo",value:t.saldo,mono:!0})]}),e.jsxs(y,{title:"Notas Técnicas / Servicios TV",children:[e.jsx(r,{label:"Notas del Equipo",value:t.notas_tecnicas}),t.servicios_adicionales?.length>0?e.jsxs("div",{children:[e.jsx("span",{className:"text-[11px] text-text-muted block mb-1.5",children:"Servicios Adicionales"}),t.servicios_adicionales?.map((s,p)=>e.jsxs("div",{className:"flex justify-between py-1 px-2.5 bg-bg-secondary rounded-md mb-1 text-xs",children:[e.jsx("span",{children:s.tipo}),e.jsxs("span",{className:"font-mono text-accent-cyan",children:["S/. ",S(s.precio)]})]},p))]}):e.jsx(r,{label:"Servicios Adicionales",value:"Ninguno"})]})]}),e.jsxs("div",{className:"bg-bg-card rounded-2xl border border-border overflow-hidden",children:[e.jsxs("div",{className:"p-5 border-b border-border",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-[16px] font-bold text-text-primary flex items-center gap-2",children:[e.jsx(M,{size:18,className:"text-accent-blue"}),"Historial del Cliente"]}),e.jsxs("p",{className:"text-[12px] text-text-muted mt-1",children:[G," registros en total"]})]})}),e.jsx("div",{className:"flex gap-1.5 mt-4 overflow-x-auto pb-1",children:W.map(s=>e.jsx(le,{active:x===s.key,icon:s.icon,label:s.label,count:s.count,colorVar:s.color,onClick:()=>o(s.key)},s.key))})]}),e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex flex-col gap-3 max-h-[600px] overflow-y-auto pr-1",children:[x==="tickets"&&(u.length===0?e.jsx(k,{icon:$,text:"No hay tickets registrados para este cliente"}):u.map(s=>e.jsx(F,{color:"#3b82f6",icon:$,title:`${s.id} — ${s.categoriaNombre||s.tipo||"Ticket"}`,subtitle:s.descripcion?.substring(0,100)||"Sin descripción",status:s.estado,date:s.fecha||s.createdAt,children:e.jsx(ne,{t:s})},s.id))),x==="soporte"&&(T.length===0?e.jsx(k,{icon:O,text:"No hay sesiones de soporte remoto registradas"}):T.map(s=>{const p=c.find(I=>I.id===s.ticketId);return e.jsx(F,{color:"#06b6d4",icon:O,title:`${s.id} — Soporte Remoto`,subtitle:`Ticket: ${s.ticketId} • ${s.descripcion?.substring(0,80)||""}`,status:s.estado,date:s.fecha,children:e.jsx(oe,{s,ticket:p})},s.id)})),x==="visitas"&&(D.length===0?e.jsx(k,{icon:L,text:"No hay visitas técnicas registradas"}):D.map(s=>{const p=c.find(I=>I.id===s.ticketId);return e.jsx(F,{color:"#f97316",icon:L,title:`${s.id} — Visita Técnica`,subtitle:`Ticket: ${s.ticketId} • ${s.descripcion?.substring(0,80)||""}`,status:s.estado,date:s.fecha,children:e.jsx(ce,{v:s,ticket:p,clientDir:t.direccion})},s.id)})),x==="postventa"&&(C.length===0?e.jsx(k,{icon:_,text:"No hay registros de post-venta"}):C.map(s=>e.jsx(F,{color:"#a855f7",icon:_,title:`${s.id} — ${s.tipoServicio||"Post-Venta"}`,subtitle:s.descripcion?.substring(0,100)||"Sin descripción",status:s.estado,date:s.fecha,children:e.jsx(re,{p:s})},s.id))),x==="averias"&&(z.length===0?e.jsx(k,{icon:E,text:"No hay averías registradas"}):z.map(s=>e.jsx(F,{color:"#ef4444",icon:E,title:`${s.id} — ${s.tipo||"Avería"}`,subtitle:s.descripcion?.substring(0,100)||"Sin descripción",status:s.estado,date:s.fecha,children:e.jsx(de,{a:s})},s.id)))]})})]})]})}export{Fe as default};
