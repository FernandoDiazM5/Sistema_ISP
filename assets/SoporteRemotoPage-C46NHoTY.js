import{c as ve,a as b,r as a,j as t,F as ge,T as he,W as Oe,X as ee}from"./index-me4rMZUI.js";import{a as Le,A as H}from"./Adjuntos-C2TXHFt3.js";import{R as $e}from"./ResolutionModal-CWYf7WvS.js";import{g as P,D as J}from"./DiagnosticFields-DeZXjB6D.js";import{P as Pe}from"./plus-CVOr2pzG.js";import{A as Me}from"./activity-C_VNihTT.js";import{C as fe}from"./circle-check-BYdJYVN6.js";import{M as K}from"./monitor-BUPZoH7j.js";import{S as Ce}from"./search-K4IrGess.js";import{E as Ae}from"./eye-CL1ozEkO.js";import{C as _e}from"./clock-BXh_ZNwk.js";import{G as Ve}from"./gauge-CBSOLF2G.js";import"./upload-DDQq8R06.js";import"./download-CohkA6dt.js";import"./chevron-right-BtOXaLSJ.js";import"./chevron-down-CqS4kEgR.js";import"./radio-Dh8PxUbN.js";const Be=[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]],qe=ve("signal",Be);const We=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],Z=ve("terminal",We),M={"En curso":{bg:"bg-accent-blue/20",text:"text-accent-blue"},Completada:{bg:"bg-accent-green/20",text:"text-accent-green"},Fallida:{bg:"bg-accent-red/20",text:"text-accent-red"},"Derivado a Visita":{bg:"bg-purple-500/20",text:"text-purple-400"},"Derivado a Planta Externa":{bg:"bg-orange-500/20",text:"text-orange-400"}},je={Diagnóstico:{bg:"bg-accent-cyan/15",text:"text-accent-cyan"},Configuración:{bg:"bg-accent-purple/15",text:"text-accent-purple"},Monitoreo:{bg:"bg-accent-blue/15",text:"text-accent-blue"},"Reinicio remoto":{bg:"bg-accent-orange/15",text:"text-accent-orange"}},Ne=["Diagnóstico","Configuración","Monitoreo","Reinicio remoto"];function ye({label:d,placeholder:A,items:j,value:i,onChange:N,renderItem:h,filterFn:v,disabled:T,readOnlyDisplay:E}){const[c,C]=a.useState(""),[z,m]=a.useState(!1),p=a.useRef(null);a.useEffect(()=>{const r=I=>{p.current&&!p.current.contains(I.target)&&m(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[]);const x=a.useMemo(()=>!c||c.length<2?[]:j.filter(r=>v(r,c.toLowerCase())).slice(0,15),[j,c,v]);return T&&E?t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-text-secondary font-medium mb-1.5 block",children:d}),t.jsx("div",{className:"w-full px-3 py-2.5 rounded-lg bg-bg-secondary/50 border border-border text-sm text-text-secondary cursor-not-allowed",children:E})]}):t.jsxs("div",{ref:p,className:"relative",children:[t.jsx("label",{className:"text-xs text-text-secondary font-medium mb-1.5 block",children:d}),t.jsxs("div",{className:"relative",children:[t.jsx(Ce,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted"}),t.jsx("input",{type:"text",placeholder:A,value:i?h?h(i):i:c,onChange:r=>{i&&N(null),C(r.target.value),m(!0)},onFocus:()=>{c.length>=2&&m(!0)},className:"w-full pl-9 pr-8 py-2.5 rounded-lg bg-bg-secondary border border-border text-sm text-text-primary placeholder:text-text-muted focus:outline-none focus:border-accent-cyan/50"}),i&&t.jsx("button",{type:"button",onClick:()=>{N(null),C("")},className:"absolute right-2 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-secondary bg-transparent border-none cursor-pointer p-1",children:t.jsx(ee,{size:14})})]}),z&&x.length>0&&t.jsx("div",{className:"absolute z-50 w-full mt-1 bg-bg-card border border-border rounded-lg shadow-xl max-h-48 overflow-y-auto",children:x.map((r,I)=>t.jsx("button",{type:"button",onClick:()=>{N(r),C(""),m(!1)},className:"w-full px-3 py-2 text-left hover:bg-bg-secondary text-sm text-text-primary border-none bg-transparent cursor-pointer border-b border-b-border/30 last:border-b-0",children:h?h(r):String(r)},I))}),z&&c.length>=2&&x.length===0&&t.jsx("div",{className:"absolute z-50 w-full mt-1 bg-bg-card border border-border rounded-lg shadow-xl p-3 text-sm text-text-muted text-center",children:"Sin resultados"})]})}function it(){const d=b(e=>e.sesionesRemoto),A=b(e=>e.addSesionRemoto),j=b(e=>e.updateSesionRemoto),i=b(e=>e.clients),N=b(e=>e.tickets),h=b(e=>e.updateTicket),v=b(e=>e.tecnicos),T=b(e=>e.addVisita),E=b(e=>e.addDerivacion),c=b(e=>e.prefillSoporte),C=b(e=>e.clearPrefillSoporte),[z,m]=a.useState(!1),[p,x]=a.useState(null),[r,I]=a.useState(""),[F,we]=a.useState("all"),[O,Se]=a.useState("all"),[w,_]=a.useState(null),[n,S]=a.useState(null),[V,te]=a.useState("Diagnóstico"),[se,f]=a.useState(""),[L,ae]=a.useState(""),[B,ne]=a.useState(""),[oe,re]=a.useState(!1),[ce,q]=a.useState([]),[ie,$]=a.useState(""),[ke,W]=a.useState(!1),[y,U]=a.useState(null),[D,le]=a.useState(P()),[G,de]=a.useState(""),[Y,xe]=a.useState(P());a.useEffect(()=>{p&&(le(p.diagnosticos?{...p.diagnosticos}:P()),de(p.tecnologia||""))},[p]),a.useEffect(()=>{$(n&&n.tecnologia||"")},[n]);const Ie=a.useMemo(()=>v.filter(e=>e.estado==="Activo"),[v]);a.useMemo(()=>{if(!n)return{isRadio:!1,isFibra:!1};const e=(n.tecnologia||"").toLowerCase();return{isRadio:e.includes("radio"),isFibra:e.includes("fibra")}},[n]);const Q=a.useMemo(()=>({enCurso:d.filter(e=>e.estado==="En curso").length,completadas:d.filter(e=>e.estado==="Completada").length,total:d.length}),[d]),me=a.useMemo(()=>d.filter(e=>{const s=!r||e.clienteNombre.toLowerCase().includes(r.toLowerCase())||e.id.toLowerCase().includes(r.toLowerCase())||e.ticketId&&e.ticketId.toLowerCase().includes(r.toLowerCase()),o=F==="all"||e.estado===F,l=O==="all"||e.tipo===O;return s&&o&&l}),[d,r,F,O]);a.useEffect(()=>{if(c){if(k(),c.ticketId){const e=N.find(s=>s.id===c.ticketId);if(e){_(e);const s=i.find(o=>o.id===e.clienteId);s&&(S(s),f(s.ip||""))}}else if(c.clienteId){const e=i.find(s=>s.id===c.clienteId);e&&(S(e),f(e.ip||""))}m(!0),C()}},[c,N,i,C]);const k=()=>{_(null),S(null),te("Diagnóstico"),f(""),ae(""),ne(""),re(!1),q([]),q([]),$(""),xe(P())},De=e=>{if(_(e),e){const s=i.find(o=>o.id===e.clienteId);s&&(S(s),f(s.ip||""))}else S(null),f("")},Re=e=>{S(e),f(e&&e.ip||"")},Te=e=>{if(e.preventDefault(),!n)return;const s=v.find(g=>g.id===L),l=Object.values(Y).some(g=>g!==""&&g!==null&&g!==void 0)?{...Y}:null,u={clienteId:n.id,clienteNombre:n.nombre||"N/A",tipo:V,ip:se,estado:"En curso",tecnico:s?.nombre||"Sin asignar",tecnicoId:L,duracion:"—",resultado:B,ticketId:w?.id||null,ticketDesc:w?.descripcion||null,tecnologia:ie||n.tecnologia||"",plan:n.plan||"",direccion:n.direccion||"",nodo:n.nodo||"",diagnosticos:l,adjuntos:ce};A(u),oe&&n&&T({clienteId:n.id,clienteNombre:n.nombre,tecnicoId:L,tecnicoNombre:s?.nombre||"Sin asignar",tipo:"Diagnóstico",estado:"Programada",prioridad:"Media",direccion:n.direccion||"",descripcion:`Derivado de sesión remota (${V}). ${B}`,resultado:"",horaInicio:null,horaFin:null,ticketId:w?.id||null}),m(!1),k()},pe=(e,s)=>{if(s==="Completada")U({sesionId:e,newEstado:s}),W(!0);else{j(e,{estado:s,_historyComment:"Cambio de estado manual"});const o=d.find(l=>l.id===e);o&&x({...o,estado:s})}},Ee=e=>{j(e.id,{estado:"Derivado a Visita",_historyComment:"Derivado a Visita Técnica - requiere atención presencial"});const s=i.find(o=>o.id===e.clienteId);T({clienteId:e.clienteId,clienteNombre:e.clienteNombre||s?.NOMBRE||"",direccion:e.direccion||s?.DIRECCION_INSTALACION||"",tipo:"Reparación",prioridad:"Alta",estado:"Programada",tecnicoId:e.tecnicoId||null,descripcion:`Derivado de Soporte Remoto (${e.id}). ${e.resultado||""}`,ticketId:e.ticketId||null,sesionOrigenId:e.id,sesionOrigenId:e.id,tecnologia:G,diagnosticoCompleto:D,...D}),e.ticketId&&h(e.ticketId,{estado:"Escalado",_historyEstadoLabel:"Escalado - Visita Técnica",_historyComment:`Derivado desde Soporte Remoto (${e.id}) a Visita Técnica`}),x({...e,estado:"Derivado a Visita"})},ze=e=>{j(e.id,{estado:"Derivado a Planta Externa",_historyComment:"Derivado a Planta Externa - problema de infraestructura"});const s=i.find(o=>o.id===e.clienteId);E({clienteId:e.clienteId,clienteNombre:e.clienteNombre||s?.NOMBRE||"",zona:s?.NODO||e.nodo||"",tipo:"Fibra Óptica",prioridad:"Alta",estado:"Pendiente",descripcion:`Derivado de Soporte Remoto (${e.id}). ${e.resultado||""}`,ticketId:e.ticketId||null,sesionOrigenId:e.id,sesionOrigenId:e.id,tecnologia:G,diagnosticoCompleto:D,...D}),e.ticketId&&h(e.ticketId,{estado:"Escalado",_historyEstadoLabel:"Escalado - Planta Externa",_historyComment:`Derivado desde Soporte Remoto (${e.id}) a Planta Externa`}),x({...e,estado:"Derivado a Planta Externa"})},Fe=e=>{if(!y)return;j(y.sesionId,{estado:y.newEstado,...e,_historyComment:e.solucion||"Sesión completada"});const s=d.find(o=>o.id===y.sesionId);s?.ticketId&&h(s.ticketId,{estado:"Resuelto",_historyComment:`Resuelto desde Soporte Remoto (${s.id})`}),s&&x({...s,estado:y.newEstado,...e}),W(!1),U(null)},ue=e=>{if(!e)return{};const s={};return e.ping&&parseFloat(e.ping)>80&&(s.ping=!0),e.download&&parseFloat(e.download)<10&&(s.download=!0),e.upload&&parseFloat(e.upload)<5&&(s.upload=!0),e.packetLoss&&parseFloat(e.packetLoss)>2&&(s.packetLoss=!0),e.jitter&&parseFloat(e.jitter)>15&&(s.jitter=!0),e.senalRecibida&&parseFloat(e.senalRecibida)<-75&&(s.senalRecibida=!0),e.ccq&&parseFloat(e.ccq)<85&&(s.ccq=!0),e.potenciaRx&&parseFloat(e.potenciaRx)<-25&&(s.potenciaRx=!0),e.atenuacion&&parseFloat(e.atenuacion)>28&&(s.atenuacion=!0),e.estadoONU&&e.estadoONU!=="Online"&&(s.estadoONU=!0),s};return t.jsxs("div",{className:"animate-fade p-6 px-8 h-full overflow-y-auto",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-[26px] font-bold tracking-tight",children:"Soporte Remoto"}),t.jsx("p",{className:"text-text-secondary text-sm mt-1",children:"Diagnóstico y configuración remota de equipos"})]}),t.jsxs("button",{onClick:()=>{k(),m(!0)},className:"py-2.5 px-4 rounded-xl bg-accent-cyan border-none text-white text-sm font-semibold cursor-pointer flex items-center gap-2 hover:opacity-90 transition-opacity",children:[t.jsx(Pe,{size:16})," Nueva Sesión"]})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6",children:[t.jsxs("div",{className:"bg-bg-card rounded-xl p-4 border border-border flex items-center gap-3",children:[t.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-accent-blue/15 text-accent-blue",children:t.jsx(Me,{size:16})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-bold font-mono",children:Q.enCurso}),t.jsx("p",{className:"text-[10px] text-text-muted uppercase",children:"En curso"})]})]}),t.jsxs("div",{className:"bg-bg-card rounded-xl p-4 border border-border flex items-center gap-3",children:[t.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-accent-green/15 text-accent-green",children:t.jsx(fe,{size:16})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-bold font-mono",children:Q.completadas}),t.jsx("p",{className:"text-[10px] text-text-muted uppercase",children:"Completadas"})]})]}),t.jsxs("div",{className:"bg-bg-card rounded-xl p-4 border border-border flex items-center gap-3",children:[t.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-accent-purple/15 text-accent-purple",children:t.jsx(K,{size:16})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-bold font-mono",children:Q.total}),t.jsx("p",{className:"text-[10px] text-text-muted uppercase",children:"Total sesiones"})]})]})]}),t.jsxs("div",{className:"flex gap-3 mb-5 flex-wrap",children:[t.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[t.jsx(Ce,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted"}),t.jsx("input",{placeholder:"Buscar por cliente, ID, ticket...",value:r,onChange:e=>I(e.target.value),className:"w-full pl-9 bg-bg-secondary border border-border text-text-primary rounded-lg py-2.5 px-3 text-sm outline-none focus:border-accent-cyan"})]}),t.jsxs("select",{value:F,onChange:e=>we(e.target.value),className:"min-w-[150px] bg-bg-secondary border border-border text-text-primary rounded-lg py-2.5 px-3 text-sm outline-none focus:border-accent-cyan",children:[t.jsx("option",{value:"all",children:"Todos los estados"}),t.jsx("option",{value:"En curso",children:"En curso"}),t.jsx("option",{value:"Completada",children:"Completada"}),t.jsx("option",{value:"Fallida",children:"Fallida"})]}),t.jsxs("select",{value:O,onChange:e=>Se(e.target.value),className:"min-w-[150px] bg-bg-secondary border border-border text-text-primary rounded-lg py-2.5 px-3 text-sm outline-none focus:border-accent-cyan",children:[t.jsx("option",{value:"all",children:"Todos los tipos"}),Ne.map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsxs("div",{className:"flex flex-col gap-3",children:[me.length===0&&t.jsxs("div",{className:"bg-bg-card rounded-xl p-8 border border-border text-center",children:[t.jsx(K,{size:32,className:"mx-auto text-text-muted mb-3"}),t.jsx("p",{className:"text-text-secondary text-sm",children:"No se encontraron sesiones"})]}),me.map(e=>{const s=M[e.estado]||M.Completada,o=je[e.tipo]||{bg:"bg-bg-secondary",text:"text-text-secondary"},l=e.diagnosticos&&Object.values(e.diagnosticos).some(R=>R!==""&&R!==null&&R!==void 0),u=ue(e.diagnosticos),g=Object.keys(u).length>0;return t.jsxs("div",{onClick:()=>x(e),className:"bg-bg-card rounded-xl p-4 border border-border cursor-pointer transition-all hover:border-accent-cyan/40 group",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center bg-accent-cyan/15 text-accent-cyan",children:t.jsx(Z,{size:16})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsx("span",{className:"font-mono text-xs text-text-muted",children:e.id}),t.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] font-bold ${s.bg} ${s.text}`,children:e.estado}),t.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] font-bold ${o.bg} ${o.text}`,children:e.tipo}),e.ticketId&&t.jsxs("span",{className:"px-2 py-0.5 rounded text-[11px] font-bold bg-accent-orange/15 text-accent-orange flex items-center gap-1",children:[t.jsx(ge,{size:10})," ",e.ticketId]}),g&&t.jsxs("span",{className:"px-2 py-0.5 rounded text-[11px] font-bold bg-accent-orange/15 text-accent-orange flex items-center gap-1",children:[t.jsx(he,{size:10})," Alertas"]})]}),t.jsx("p",{className:"text-sm font-semibold mt-0.5",children:e.clienteNombre})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-[11px] text-text-muted",children:e.fecha}),t.jsx(Ae,{size:14,className:"text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})]}),t.jsxs("div",{className:"flex items-center gap-6 text-[11px] text-text-muted mt-1 flex-wrap",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(Oe,{size:10})," IP: ",t.jsx("span",{className:"text-accent-cyan font-mono",children:e.ip})]}),t.jsxs("span",{children:["Técnico: ",t.jsx("span",{className:"text-text-secondary",children:e.tecnico})]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(_e,{size:10})," Duración: ",t.jsx("span",{className:"text-text-secondary",children:e.duracion})]}),t.jsx(Le,{count:e.adjuntos?.length})]}),l&&t.jsxs("div",{className:"mt-2 p-2 bg-bg-secondary rounded-lg flex items-center gap-4 text-[11px] flex-wrap",children:[t.jsxs("span",{className:"text-text-muted font-semibold uppercase tracking-wide flex items-center gap-1",children:[t.jsx(Ve,{size:10})," Diag:"]}),e.diagnosticos.ping&&t.jsxs("span",{className:u.ping?"text-accent-orange":"text-text-secondary",children:["Ping: ",t.jsxs("span",{className:"font-mono",children:[e.diagnosticos.ping,"ms"]})]}),e.diagnosticos.download&&t.jsxs("span",{className:u.download?"text-accent-orange":"text-text-secondary",children:["DL: ",t.jsxs("span",{className:"font-mono",children:[e.diagnosticos.download,"Mbps"]})]}),e.diagnosticos.upload&&t.jsxs("span",{className:u.upload?"text-accent-orange":"text-text-secondary",children:["UL: ",t.jsxs("span",{className:"font-mono",children:[e.diagnosticos.upload,"Mbps"]})]}),e.diagnosticos.senalRecibida&&t.jsxs("span",{className:u.senalRecibida?"text-accent-orange":"text-text-secondary",children:[t.jsx(qe,{size:10,className:"inline mr-0.5"}),t.jsxs("span",{className:"font-mono",children:[e.diagnosticos.senalRecibida,"dBm"]})]}),e.diagnosticos.potenciaRx&&t.jsxs("span",{className:u.potenciaRx?"text-accent-orange":"text-text-secondary",children:["Rx: ",t.jsxs("span",{className:"font-mono",children:[e.diagnosticos.potenciaRx,"dBm"]})]})]}),e.resultado&&!l&&t.jsx("div",{className:"mt-2 p-2 bg-bg-secondary rounded-lg text-xs text-text-secondary",children:e.resultado})]},e.id)})]}),z&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>{m(!1),k()},children:t.jsxs("div",{className:"bg-bg-card rounded-2xl p-6 w-[640px] border border-border max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"flex items-center justify-between mb-5",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-accent-cyan/15 text-accent-cyan",children:t.jsx(Z,{size:18})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold",children:"Nueva Sesión Remota"}),t.jsx("p",{className:"text-xs text-text-muted",children:"Complete los datos del diagnóstico"})]})]}),t.jsx("button",{onClick:()=>{m(!1),k()},className:"w-8 h-8 rounded-lg flex items-center justify-center bg-bg-secondary border border-border text-text-muted hover:text-text-primary cursor-pointer transition-colors",children:t.jsx(ee,{size:16})})]}),t.jsxs("form",{onSubmit:Te,className:"flex flex-col gap-4",children:[t.jsx(ye,{label:"Ticket vinculado (opcional)",placeholder:"Buscar ticket por ID o descripción...",items:N,value:w,onChange:De,renderItem:e=>`${e.id} — ${e.clienteNombre} — ${e.descripcion?.slice(0,50)}...`,filterFn:(e,s)=>e.id.toLowerCase().includes(s)||(e.clienteNombre||"").toLowerCase().includes(s)||(e.descripcion||"").toLowerCase().includes(s)}),t.jsx(ye,{label:"Cliente",placeholder:"Buscar por nombre o ID de cliente...",items:i,value:n,onChange:Re,renderItem:e=>`${e.id} — ${e.nombre}${e.ip?` (${e.ip})`:""}`,filterFn:(e,s)=>e.id.toLowerCase().includes(s)||(e.nombre||"").toLowerCase().includes(s),disabled:!!w,readOnlyDisplay:w&&n?`${n.id} — ${n.nombre}`:null}),n&&t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50 flex items-center gap-4 flex-wrap text-[11px]",children:[t.jsxs("span",{className:"text-text-muted",children:["Tecnología: ",t.jsx("span",{className:"text-accent-cyan font-semibold",children:n.tecnologia||"—"})]}),t.jsxs("span",{className:"text-text-muted",children:["Plan: ",t.jsx("span",{className:"text-text-secondary font-semibold",children:n.plan||"—"})]}),t.jsxs("span",{className:"text-text-muted",children:["Nodo: ",t.jsx("span",{className:"text-text-secondary font-mono",children:n.nodo||"—"})]}),t.jsxs("span",{className:"text-text-muted",children:["Dirección: ",t.jsx("span",{className:"text-text-secondary",children:n.direccion||"—"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-text-secondary font-medium mb-1.5 block",children:"Tipo de sesión"}),t.jsx("select",{value:V,onChange:e=>te(e.target.value),className:"w-full px-3 py-2.5 rounded-lg bg-bg-secondary border border-border text-sm text-text-primary focus:outline-none focus:border-accent-cyan/50",children:Ne.map(e=>t.jsx("option",{value:e,children:e},e))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-text-secondary font-medium mb-1.5 block",children:"IP del equipo"}),t.jsx("input",{type:"text",value:se,onChange:e=>f(e.target.value),placeholder:"Se auto-llena al elegir cliente",className:"w-full px-3 py-2.5 rounded-lg bg-bg-secondary border border-border text-sm text-text-primary font-mono placeholder:text-text-muted focus:outline-none focus:border-accent-cyan/50"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-text-secondary font-medium mb-1.5 block",children:"Técnico responsable"}),t.jsxs("select",{value:L,onChange:e=>ae(e.target.value),required:!0,className:"w-full px-3 py-2.5 rounded-lg bg-bg-secondary border border-border text-sm text-text-primary focus:outline-none focus:border-accent-cyan/50",children:[t.jsx("option",{value:"",children:"Seleccionar técnico..."}),Ie.map(e=>t.jsxs("option",{value:e.id,children:[e.nombre," — ",e.especialidad," (",e.zona,")"]},e.id))]})]}),t.jsx("div",{className:"mt-4",children:t.jsx(J,{tecnologia:ie,onTecnologiaChange:$,value:Y,onChange:xe})}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-text-secondary font-medium mb-1.5 block",children:"Resultado / Observaciones"}),t.jsx("textarea",{value:B,onChange:e=>ne(e.target.value),placeholder:"Describa el resultado del diagnóstico...",rows:3,className:"w-full px-3 py-2.5 rounded-lg bg-bg-secondary border border-border text-sm text-text-primary placeholder:text-text-muted focus:outline-none focus:border-accent-cyan/50 resize-none"})]}),t.jsx(H,{value:ce,onChange:q,max:5}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-bg-secondary rounded-lg p-3 border border-border/50 hover:border-accent-cyan/30 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:oe,onChange:e=>re(e.target.checked),className:"w-4 h-4 rounded accent-accent-cyan"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-text-primary font-medium",children:"Derivar a Visita Técnica"}),t.jsx("p",{className:"text-[11px] text-text-muted mt-0.5",children:"Se creará automáticamente una visita técnica al iniciar la sesión"})]})]}),t.jsxs("div",{className:"flex gap-3 mt-2",children:[t.jsx("button",{type:"button",onClick:()=>{m(!1),k()},className:"flex-1 py-2.5 rounded-lg bg-bg-secondary border border-border text-text-secondary cursor-pointer text-sm font-semibold hover:bg-bg-secondary/80 transition-colors",children:"Cancelar"}),t.jsxs("button",{type:"submit",disabled:!n,className:"flex-1 py-2.5 rounded-lg bg-accent-cyan border-none text-white cursor-pointer text-sm font-semibold hover:opacity-90 transition-opacity disabled:opacity-40 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[t.jsx(K,{size:16})," Iniciar Sesión"]})]})]})]})}),p&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>x(null),children:t.jsx("div",{className:"bg-bg-card rounded-2xl p-6 w-[640px] border border-border max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:(()=>{const e=p,s=M[e.estado]||M.Completada,o=je[e.tipo]||{bg:"bg-bg-secondary",text:"text-text-secondary"},l=e.diagnosticos,u=ue(l),g=Object.keys(u).length>0,R=l&&Object.values(l).some(X=>X!==""&&X!==null&&X!==void 0),be=(e.tecnologia||"").toLowerCase();return be.includes("radio"),be.includes("fibra"),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between mb-5",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-accent-cyan/15 text-accent-cyan",children:t.jsx(Z,{size:20})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-mono text-sm text-text-muted font-bold",children:e.id}),t.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] font-bold ${s.bg} ${s.text}`,children:e.estado})]}),t.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:e.fecha})]})]}),t.jsx("button",{onClick:()=>x(null),className:"w-8 h-8 rounded-lg flex items-center justify-center bg-bg-secondary border border-border text-text-muted hover:text-text-primary cursor-pointer transition-colors",children:t.jsx(ee,{size:16})})]}),g&&t.jsxs("div",{className:"bg-accent-orange/10 border border-accent-orange/30 rounded-lg p-3 mb-4 flex items-center gap-2",children:[t.jsx(he,{size:16,className:"text-accent-orange flex-shrink-0"}),t.jsx("p",{className:"text-xs text-accent-orange font-medium",children:"Se detectaron valores fuera de rango en los parámetros de diagnóstico. Revise los indicadores marcados."})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-2",children:"Información del cliente"}),t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50",children:[t.jsx("p",{className:"text-sm font-semibold text-text-primary mb-1",children:e.clienteNombre}),t.jsxs("div",{className:"flex items-center gap-4 flex-wrap text-[11px] text-text-muted",children:[t.jsxs("span",{children:["ID: ",t.jsx("span",{className:"text-text-secondary font-mono",children:e.clienteId})]}),e.tecnologia&&t.jsxs("span",{children:["Tecnología: ",t.jsx("span",{className:"text-accent-cyan font-semibold",children:e.tecnologia})]}),e.plan&&t.jsxs("span",{children:["Plan: ",t.jsx("span",{className:"text-text-secondary",children:e.plan})]}),e.direccion&&t.jsxs("span",{children:["Dir: ",t.jsx("span",{className:"text-text-secondary",children:e.direccion})]}),e.nodo&&t.jsxs("span",{children:["Nodo: ",t.jsx("span",{className:"text-text-secondary font-mono",children:e.nodo})]})]})]})]}),e.ticketId&&t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-2",children:"Ticket vinculado"}),t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50 flex items-center gap-2",children:[t.jsx(ge,{size:14,className:"text-accent-orange"}),t.jsx("span",{className:"text-sm font-mono font-semibold text-accent-orange",children:e.ticketId}),e.ticketDesc&&t.jsx("span",{className:"text-xs text-text-secondary ml-2",children:e.ticketDesc})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-2",children:"Detalles de sesión"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-2.5 border border-border/50",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-0.5",children:"Tipo"}),t.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-[11px] font-bold ${o.bg} ${o.text}`,children:e.tipo})]}),t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-2.5 border border-border/50",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-0.5",children:"IP"}),t.jsx("p",{className:"text-sm font-mono text-accent-cyan",children:e.ip||"—"})]}),t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-2.5 border border-border/50",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-0.5",children:"Técnico"}),t.jsx("p",{className:"text-sm text-text-primary",children:e.tecnico})]}),t.jsxs("div",{className:"bg-bg-secondary rounded-lg p-2.5 border border-border/50",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-0.5",children:"Duración"}),t.jsx("p",{className:"text-sm text-text-primary font-mono",children:e.duracion})]})]})]}),e.resultado&&t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-2",children:"Resultado"}),t.jsx("div",{className:"bg-bg-secondary rounded-lg p-3 border border-border/50 text-sm text-text-secondary leading-relaxed",children:e.resultado})]}),(e.solucion||e.accionesRealizadas)&&t.jsxs("div",{className:"bg-green-500/5 border border-green-500/20 rounded-lg p-3 mb-4",children:[t.jsxs("p",{className:"text-[10px] text-green-400 uppercase tracking-wide mb-2 font-semibold flex items-center gap-1",children:[t.jsx(fe,{size:12}),"Resolución"]}),e.solucion&&t.jsxs("div",{className:"mb-2",children:[t.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Solución:"}),t.jsx("p",{className:"text-sm text-text-secondary",children:e.solucion})]}),e.accionesRealizadas&&t.jsxs("div",{className:"mb-2",children:[t.jsx("p",{className:"text-[10px] text-text-muted mb-0.5",children:"Acciones Realizadas:"}),t.jsx("p",{className:"text-sm text-text-secondary",children:e.accionesRealizadas})]}),e.adjuntosResolucion&&e.adjuntosResolucion.length>0&&t.jsxs("div",{className:"mt-2",children:[t.jsx("p",{className:"text-[10px] text-text-muted mb-1",children:"Evidencia:"}),t.jsx(H,{value:e.adjuntosResolucion,onChange:()=>{},readOnly:!0,max:5})]})]}),e.adjuntos&&e.adjuntos.length>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide font-semibold mb-2",children:"Adjuntos / Evidencia"}),t.jsx(H,{value:e.adjuntos,onChange:()=>{},readOnly:!0,max:5})]}),R&&t.jsx("div",{className:"border-t border-border pt-4",children:t.jsx(J,{tecnologia:e.tecnologia,value:l,onChange:()=>{},onTecnologiaChange:null,warnings:u,readOnly:!0})}),e.estado==="En curso"&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"flex gap-2 mb-2",children:[t.jsx("button",{onClick:()=>pe(e.id,"Completada"),className:"flex-1 py-2 rounded-lg bg-accent-green/20 text-accent-green border-none text-xs font-semibold cursor-pointer hover:bg-accent-green/30",children:"Marcar Completada"}),t.jsx("button",{onClick:()=>pe(e.id,"Fallida"),className:"flex-1 py-2 rounded-lg bg-accent-red/20 text-accent-red border-none text-xs font-semibold cursor-pointer hover:bg-accent-red/30",children:"Marcar Fallida"})]}),t.jsx("div",{className:"mb-3",children:t.jsx(J,{tecnologia:G,onTecnologiaChange:de,value:D,onChange:le})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>Ee(e),className:"flex-1 py-2 rounded-lg bg-purple-500/20 text-purple-400 border-none text-xs font-semibold cursor-pointer hover:bg-purple-500/30",children:"Derivar a Visita Técnica"}),t.jsx("button",{onClick:()=>ze(e),className:"flex-1 py-2 rounded-lg bg-orange-500/20 text-orange-400 border-none text-xs font-semibold cursor-pointer hover:bg-orange-500/30",children:"Derivar a Planta Externa"})]})]}),t.jsx("div",{className:"flex justify-end mt-4 pt-3 border-t border-border",children:t.jsx("button",{onClick:()=>x(null),className:"py-2.5 px-6 rounded-lg bg-bg-secondary border border-border text-text-secondary cursor-pointer text-sm font-semibold hover:bg-bg-secondary/80 transition-colors",children:"Cerrar"})})]})})()})}),t.jsx($e,{open:ke,onClose:()=>{W(!1),U(null)},onConfirm:Fe,title:"Completar Sesion Remota",entityId:y?d.find(e=>e.id===y.sesionId)?.id:"",entityLabel:"Sesion",newStatus:"Completada",accentColor:"accent-cyan"})]})}export{it as default};
